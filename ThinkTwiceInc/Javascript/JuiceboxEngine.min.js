Bridge.assembly("JuiceboxEngine",function($asm,globals){"use strict";Bridge.define("Humper.Base.Constants",{statics:{fields:{Threshold:0},ctors:{init:function(){this.Threshold=1e-5}}}});Bridge.define("Humper.Base.Maths",{statics:{fields:{E:0,Log10E:0,Log2E:0,Pi:0,PiOver2:0,PiOver4:0,TwoPi:0},ctors:{init:function(){this.E=2.71828175;this.Log10E=.4342945;this.Log2E=1.442695;this.Pi=3.14159274;this.PiOver2=1.57079637;this.PiOver4=.7853982;this.TwoPi=6.28318548}},methods:{Barycentric:function(value1,value2,value3,amount1,amount2){return value1+(value2-value1)*amount1+(value3-value1)*amount2},CatmullRom:function(value1,value2,value3,value4,amount){var amountSquared=amount*amount,amountCubed=amountSquared*amount;return.5*(2*value2+(value3-value1)*amount+(2*value1-5*value2+4*value3-value4)*amountSquared+(3*value2-value1-3*value3+value4)*amountCubed)},Clamp$1:function(value,min,max){return value=value>max?max:value,value<min?min:value},Clamp:function(value,min,max){return value=value>max?max:value,value<min?min:value},Distance:function(value1,value2){return Math.abs(value1-value2)},Hermite:function(value1,tangent1,value2,tangent2,amount){var v1=value1,v2=value2,t1=tangent1,t2=tangent2,s=amount,sCubed=s*s*s,sSquared=s*s;return amount===0?value1:amount===1?value2:(2*v1-2*v2+t2+t1)*sCubed+(3*v2-3*v1-2*t1-t2)*sSquared+t1*s+v1},Lerp:function(value1,value2,amount){return value1+(value2-value1)*amount},LerpPrecise:function(value1,value2,amount){return(1-amount)*value1+value2*amount},Max$1:function(value1,value2){return value1>value2?value1:value2},Max:function(value1,value2){return value1>value2?value1:value2},Min$1:function(value1,value2){return value1<value2?value1:value2},Min:function(value1,value2){return value1<value2?value1:value2},SmoothStep:function(value1,value2,amount){var result=Humper.Base.Maths.Clamp$1(amount,0,1);return Humper.Base.Maths.Hermite(value1,0,value2,0,result)},ToDegrees:function(radians){return radians*57.295779513082323},ToRadians:function(degrees){return degrees*.017453292519943295},WrapAngle:function(angle){return angle=Bridge.Math.IEEERemainder(angle,6.2831854820251465),angle<=-3.14159274?angle+=6.28318548:angle>3.14159274&&(angle-=6.28318548),angle},IsPowerOfTwo:function(value){return value>0&&(value&(value-1|0))==0}}}});Bridge.define("Humper.Base.RectangleF",{inherits:function(){return[System.IEquatable$1(Humper.Base.RectangleF)]},$kind:"struct",statics:{fields:{Empty:null},ctors:{init:function(){this.Empty=new Humper.Base.RectangleF}},methods:{Intersect:function(value1,value2){value1={v:value1};value2={v:value2};var rectangle={v:new Humper.Base.RectangleF};return Humper.Base.RectangleF.Intersect$1(value1,value2,rectangle),rectangle.v.$clone()},Intersect$1:function(value1,value2,result){if(value1.v.Intersects(value2.v.$clone())){var rightSide=Math.min(value1.v.X+value1.v.Width,value2.v.X+value2.v.Width),leftSide=Math.max(value1.v.X,value2.v.X),topSide=Math.max(value1.v.Y,value2.v.Y),bottomSide=Math.min(value1.v.Y+value1.v.Height,value2.v.Y+value2.v.Height);result.v=new Humper.Base.RectangleF.$ctor3(leftSide,topSide,rightSide-leftSide,bottomSide-topSide)}else result.v=new Humper.Base.RectangleF.$ctor3(0,0,0,0)},Union:function(value1,value2){var x=Math.min(value1.X,value2.X),y=Math.min(value1.Y,value2.Y);return new Humper.Base.RectangleF.$ctor3(x,y,Math.max(value1.Right,value2.Right)-x,Math.max(value1.Bottom,value2.Bottom)-y)},Union$1:function(value1,value2,result){result.v.X=Math.min(value1.v.X,value2.v.X);result.v.Y=Math.min(value1.v.Y,value2.v.Y);result.v.Width=Math.max(value1.v.Right,value2.v.Right)-result.v.X;result.v.Height=Math.max(value1.v.Bottom,value2.v.Bottom)-result.v.Y},FromPoints:function(point0,point1){var x=Math.min(point0.X,point1.X),y=Math.min(point0.Y,point1.Y),width=Math.abs(point0.X-point1.X),height=Math.abs(point0.Y-point1.Y),rectangle=new Humper.Base.RectangleF.$ctor3(x,y,width,height);return rectangle.$clone()},op_Equality:function(a,b){var epsilon=1e-5;return Math.abs(a.X-b.X)<epsilon&&Math.abs(a.Y-b.Y)<epsilon&&Math.abs(a.Width-b.Width)<epsilon&&Math.abs(a.Height-b.Height)<epsilon},op_Inequality:function(a,b){return!Humper.Base.RectangleF.op_Equality(a.$clone(),b.$clone())},getDefaultValue:function(){return new Humper.Base.RectangleF}}},fields:{X:0,Y:0,Width:0,Height:0},props:{Left:{get:function(){return this.X}},Right:{get:function(){return this.X+this.Width}},Top:{get:function(){return this.Y}},Bottom:{get:function(){return this.Y+this.Height}},IsEmpty:{get:function(){return this.Width===0&&this.Height===0&&this.X===0&&this.Y===0}},Location:{get:function(){return new Humper.Base.Vector2.$ctor2(this.X,this.Y)},set:function(value){this.X=value.X;this.Y=value.Y}},Size:{get:function(){return new Humper.Base.Vector2.$ctor2(this.Width,this.Height)},set:function(value){this.Width=value.X;this.Height=value.Y}},Center:{get:function(){return new Humper.Base.Vector2.$ctor2(this.X+this.Width/2,this.Y+this.Height/2)}},DebugDisplayString:{get:function(){return System.String.concat(this.X,"  ",this.Y,"  ",this.Width,"  ",this.Height)}}},alias:["equalsT","System$IEquatable$1$Humper$Base$RectangleF$equalsT"],ctors:{$ctor3:function(x,y,width,height){this.$initialize();this.X=x;this.Y=y;this.Width=width;this.Height=height},$ctor1:function(one,two){this.$initialize();var left=Math.min(one.Left,two.Left),right=Math.max(one.Right,two.Right),top=Math.min(one.Top,two.Top),bottom=Math.max(one.Bottom,two.Bottom);this.X=left;this.Y=top;this.Width=right-left;this.Height=bottom-top},$ctor2:function(location,size){this.$initialize();this.X=location.X;this.Y=location.Y;this.Width=size.X;this.Height=size.Y},ctor:function(){this.$initialize()}},methods:{Contains$2:function(x,y){return this.X<=x&&x<this.X+this.Width&&this.Y<=y&&y<this.Y+this.Height},Contains$3:function(x,y){return this.X<=x&&x<this.X+this.Width&&this.Y<=y&&y<this.Y+this.Height},Contains$1:function(value){return this.X<=value.X&&value.X<this.X+this.Width&&this.Y<=value.Y&&value.Y<this.Y+this.Height},Contains$5:function(value,result){result.v=this.X<=value.v.X&&value.v.X<this.X+this.Width&&this.Y<=value.v.Y&&value.v.Y<this.Y+this.Height},Contains:function(value){return this.X<=value.X&&value.X+value.Width<=this.X+this.Width&&this.Y<=value.Y&&value.Y+value.Height<=this.Y+this.Height},Contains$4:function(value,result){result.v=this.X<=value.v.X&&value.v.X+value.v.Width<=this.X+this.Width&&this.Y<=value.v.Y&&value.v.Y+value.v.Height<=this.Y+this.Height},GetBoundingRectangle:function(){return this},equals:function(obj){return Bridge.is(obj,Humper.Base.RectangleF)&&Humper.Base.RectangleF.op_Equality(this,Bridge.cast(obj,Humper.Base.RectangleF))},equalsT:function(other){return Humper.Base.RectangleF.op_Equality(this,other.$clone())},getHashCode:function(){return System.Single.getHashCode(this.X)^System.Single.getHashCode(this.Y)^System.Single.getHashCode(this.Width)^System.Single.getHashCode(this.Height)},Inflate:function(horizontalAmount,verticalAmount){this.X-=horizontalAmount;this.Y-=verticalAmount;this.Width+=Bridge.Int.mul(horizontalAmount,2);this.Height+=Bridge.Int.mul(verticalAmount,2)},Inflate$1:function(horizontalAmount,verticalAmount){this.X-=horizontalAmount;this.Y-=verticalAmount;this.Width+=horizontalAmount*2;this.Height+=verticalAmount*2},Intersects:function(value){return value.Left<this.Right&&this.Left<value.Right&&value.Top<this.Bottom&&this.Top<value.Bottom},Intersects$1:function(value,result){result.v=value.v.Left<this.Right&&this.Left<value.v.Right&&value.v.Top<this.Bottom&&this.Top<value.v.Bottom},Offset$1:function(offsetX,offsetY){this.X+=offsetX;this.Y+=offsetY},Offset$2:function(offsetX,offsetY){this.X+=offsetX;this.Y+=offsetY},Offset:function(amount){this.X+=amount.X;this.Y+=amount.Y},toString:function(){return"{X:"+System.Single.format(this.X)+" Y:"+System.Single.format(this.Y)+" Width:"+System.Single.format(this.Width)+" Height:"+System.Single.format(this.Height)+"}"},IntersectionDepth:function(other){var thisHalfWidth=this.Width/2,thisHalfHeight=this.Height/2,otherHalfWidth=other.Width/2,otherHalfHeight=other.Height/2,centerA=new Humper.Base.Vector2.$ctor2(this.Left+thisHalfWidth,this.Top+thisHalfHeight),centerB=new Humper.Base.Vector2.$ctor2(other.Left+otherHalfWidth,other.Top+otherHalfHeight),distanceX=centerA.X-centerB.X,distanceY=centerA.Y-centerB.Y,minDistanceX=thisHalfWidth+otherHalfWidth,minDistanceY=thisHalfHeight+otherHalfHeight,depthX,depthY;return Math.abs(distanceX)>=minDistanceX||Math.abs(distanceY)>=minDistanceY?Humper.Base.Vector2.Zero.$clone():(depthX=distanceX>0?minDistanceX-distanceX:-minDistanceX-distanceX,depthY=distanceY>0?minDistanceY-distanceY:-minDistanceY-distanceY,new Humper.Base.Vector2.$ctor2(depthX,depthY))},$clone:function(to){var s=to||new Humper.Base.RectangleF;return s.X=this.X,s.Y=this.Y,s.Width=this.Width,s.Height=this.Height,s}}});Bridge.define("Humper.Base.Vector2",{inherits:function(){return[System.IEquatable$1(Humper.Base.Vector2)]},$kind:"struct",statics:{fields:{zeroVector:null,unitVector:null,unitXVector:null,unitYVector:null},props:{Zero:{get:function(){return Humper.Base.Vector2.zeroVector.$clone()}},One:{get:function(){return Humper.Base.Vector2.unitVector.$clone()}},UnitX:{get:function(){return Humper.Base.Vector2.unitXVector.$clone()}},UnitY:{get:function(){return Humper.Base.Vector2.unitYVector.$clone()}}},ctors:{init:function(){this.zeroVector=new Humper.Base.Vector2;this.unitVector=new Humper.Base.Vector2;this.unitXVector=new Humper.Base.Vector2;this.unitYVector=new Humper.Base.Vector2;this.zeroVector=new Humper.Base.Vector2.$ctor2(0,0);this.unitVector=new Humper.Base.Vector2.$ctor2(1,1);this.unitXVector=new Humper.Base.Vector2.$ctor2(1,0);this.unitYVector=new Humper.Base.Vector2.$ctor2(0,1)}},methods:{Add:function(value1,value2){return value1.X+=value2.X,value1.Y+=value2.Y,value1.$clone()},Add$1:function(value1,value2,result){result.v.X=value1.v.X+value2.v.X;result.v.Y=value1.v.Y+value2.v.Y},Barycentric:function(value1,value2,value3,amount1,amount2){return new Humper.Base.Vector2.$ctor2(Humper.Base.Maths.Barycentric(value1.X,value2.X,value3.X,amount1,amount2),Humper.Base.Maths.Barycentric(value1.Y,value2.Y,value3.Y,amount1,amount2))},Barycentric$1:function(value1,value2,value3,amount1,amount2,result){result.v.X=Humper.Base.Maths.Barycentric(value1.v.X,value2.v.X,value3.v.X,amount1,amount2);result.v.Y=Humper.Base.Maths.Barycentric(value1.v.Y,value2.v.Y,value3.v.Y,amount1,amount2)},CatmullRom:function(value1,value2,value3,value4,amount){return new Humper.Base.Vector2.$ctor2(Humper.Base.Maths.CatmullRom(value1.X,value2.X,value3.X,value4.X,amount),Humper.Base.Maths.CatmullRom(value1.Y,value2.Y,value3.Y,value4.Y,amount))},CatmullRom$1:function(value1,value2,value3,value4,amount,result){result.v.X=Humper.Base.Maths.CatmullRom(value1.v.X,value2.v.X,value3.v.X,value4.v.X,amount);result.v.Y=Humper.Base.Maths.CatmullRom(value1.v.Y,value2.v.Y,value3.v.Y,value4.v.Y,amount)},Clamp:function(value1,min,max){return new Humper.Base.Vector2.$ctor2(Humper.Base.Maths.Clamp$1(value1.X,min.X,max.X),Humper.Base.Maths.Clamp$1(value1.Y,min.Y,max.Y))},Clamp$1:function(value1,min,max,result){result.v.X=Humper.Base.Maths.Clamp$1(value1.v.X,min.v.X,max.v.X);result.v.Y=Humper.Base.Maths.Clamp$1(value1.v.Y,min.v.Y,max.v.Y)},Distance:function(value1,value2){var v1=value1.X-value2.X,v2=value1.Y-value2.Y;return Math.sqrt(v1*v1+v2*v2)},Distance$1:function(value1,value2,result){var v1=value1.v.X-value2.v.X,v2=value1.v.Y-value2.v.Y;result.v=Math.sqrt(v1*v1+v2*v2)},DistanceSquared:function(value1,value2){var v1=value1.X-value2.X,v2=value1.Y-value2.Y;return v1*v1+v2*v2},DistanceSquared$1:function(value1,value2,result){var v1=value1.v.X-value2.v.X,v2=value1.v.Y-value2.v.Y;result.v=v1*v1+v2*v2},Divide:function(value1,value2){return value1.X/=value2.X,value1.Y/=value2.Y,value1.$clone()},Divide$2:function(value1,value2,result){result.v.X=value1.v.X/value2.v.X;result.v.Y=value1.v.Y/value2.v.Y},Divide$1:function(value1,divider){var factor=1/divider;return value1.X*=factor,value1.Y*=factor,value1.$clone()},Divide$3:function(value1,divider,result){var factor=1/divider;result.v.X=value1.v.X*factor;result.v.Y=value1.v.Y*factor},Dot:function(value1,value2){return value1.X*value2.X+value1.Y*value2.Y},Dot$1:function(value1,value2,result){result.v=value1.v.X*value2.v.X+value1.v.Y*value2.v.Y},Hermite:function(value1,tangent1,value2,tangent2,amount){return new Humper.Base.Vector2.$ctor2(Humper.Base.Maths.Hermite(value1.X,tangent1.X,value2.X,tangent2.X,amount),Humper.Base.Maths.Hermite(value1.Y,tangent1.Y,value2.Y,tangent2.Y,amount))},Hermite$1:function(value1,tangent1,value2,tangent2,amount,result){result.v.X=Humper.Base.Maths.Hermite(value1.v.X,tangent1.v.X,value2.v.X,tangent2.v.X,amount);result.v.Y=Humper.Base.Maths.Hermite(value1.v.Y,tangent1.v.Y,value2.v.Y,tangent2.v.Y,amount)},Lerp:function(value1,value2,amount){return new Humper.Base.Vector2.$ctor2(Humper.Base.Maths.Lerp(value1.X,value2.X,amount),Humper.Base.Maths.Lerp(value1.Y,value2.Y,amount))},Lerp$1:function(value1,value2,amount,result){result.v.X=Humper.Base.Maths.Lerp(value1.v.X,value2.v.X,amount);result.v.Y=Humper.Base.Maths.Lerp(value1.v.Y,value2.v.Y,amount)},LerpPrecise:function(value1,value2,amount){return new Humper.Base.Vector2.$ctor2(Humper.Base.Maths.LerpPrecise(value1.X,value2.X,amount),Humper.Base.Maths.LerpPrecise(value1.Y,value2.Y,amount))},LerpPrecise$1:function(value1,value2,amount,result){result.v.X=Humper.Base.Maths.LerpPrecise(value1.v.X,value2.v.X,amount);result.v.Y=Humper.Base.Maths.LerpPrecise(value1.v.Y,value2.v.Y,amount)},Max:function(value1,value2){return new Humper.Base.Vector2.$ctor2(value1.X>value2.X?value1.X:value2.X,value1.Y>value2.Y?value1.Y:value2.Y)},Max$1:function(value1,value2,result){result.v.X=value1.v.X>value2.v.X?value1.v.X:value2.v.X;result.v.Y=value1.v.Y>value2.v.Y?value1.v.Y:value2.v.Y},Min:function(value1,value2){return new Humper.Base.Vector2.$ctor2(value1.X<value2.X?value1.X:value2.X,value1.Y<value2.Y?value1.Y:value2.Y)},Min$1:function(value1,value2,result){result.v.X=value1.v.X<value2.v.X?value1.v.X:value2.v.X;result.v.Y=value1.v.Y<value2.v.Y?value1.v.Y:value2.v.Y},Multiply:function(value1,value2){return value1.X*=value2.X,value1.Y*=value2.Y,value1.$clone()},Multiply$2:function(value1,value2,result){result.v.X=value1.v.X*value2.v.X;result.v.Y=value1.v.Y*value2.v.Y},Multiply$1:function(value1,scaleFactor){return value1.X*=scaleFactor,value1.Y*=scaleFactor,value1.$clone()},Multiply$3:function(value1,scaleFactor,result){result.v.X=value1.v.X*scaleFactor;result.v.Y=value1.v.Y*scaleFactor},Negate:function(value){return value.X=-value.X,value.Y=-value.Y,value.$clone()},Negate$1:function(value,result){result.v.X=-value.v.X;result.v.Y=-value.v.Y},Normalize:function(value){var val=1/Math.sqrt(value.X*value.X+value.Y*value.Y);return value.X*=val,value.Y*=val,value.$clone()},Normalize$1:function(value,result){var val=1/Math.sqrt(value.v.X*value.v.X+value.v.Y*value.v.Y);result.v.X=value.v.X*val;result.v.Y=value.v.Y*val},Reflect:function(vector,normal){var result=new Humper.Base.Vector2,val=2*(vector.X*normal.X+vector.Y*normal.Y);return result.X=vector.X-normal.X*val,result.Y=vector.Y-normal.Y*val,result.$clone()},Reflect$1:function(vector,normal,result){var val=2*(vector.v.X*normal.v.X+vector.v.Y*normal.v.Y);result.v.X=vector.v.X-normal.v.X*val;result.v.Y=vector.v.Y-normal.v.Y*val},SmoothStep:function(value1,value2,amount){return new Humper.Base.Vector2.$ctor2(Humper.Base.Maths.SmoothStep(value1.X,value2.X,amount),Humper.Base.Maths.SmoothStep(value1.Y,value2.Y,amount))},SmoothStep$1:function(value1,value2,amount,result){result.v.X=Humper.Base.Maths.SmoothStep(value1.v.X,value2.v.X,amount);result.v.Y=Humper.Base.Maths.SmoothStep(value1.v.Y,value2.v.Y,amount)},Subtract:function(value1,value2){return value1.X-=value2.X,value1.Y-=value2.Y,value1.$clone()},Subtract$1:function(value1,value2,result){result.v.X=value1.v.X-value2.v.X;result.v.Y=value1.v.Y-value2.v.Y},op_UnaryNegation:function(value){return value.X=-value.X,value.Y=-value.Y,value.$clone()},op_Addition:function(value1,value2){return value1.X+=value2.X,value1.Y+=value2.Y,value1.$clone()},op_Subtraction:function(value1,value2){return value1.X-=value2.X,value1.Y-=value2.Y,value1.$clone()},op_Multiply:function(value1,value2){return value1.X*=value2.X,value1.Y*=value2.Y,value1.$clone()},op_Multiply$1:function(value,scaleFactor){return value.X*=scaleFactor,value.Y*=scaleFactor,value.$clone()},op_Multiply$2:function(scaleFactor,value){return value.X*=scaleFactor,value.Y*=scaleFactor,value.$clone()},op_Division:function(value1,value2){return value1.X/=value2.X,value1.Y/=value2.Y,value1.$clone()},op_Division$1:function(value1,divider){var factor=1/divider;return value1.X*=factor,value1.Y*=factor,value1.$clone()},op_Equality:function(value1,value2){return value1.X===value2.X&&value1.Y===value2.Y},op_Inequality:function(value1,value2){return value1.X!==value2.X||value1.Y!==value2.Y},getDefaultValue:function(){return new Humper.Base.Vector2}}},fields:{X:0,Y:0},props:{DebugDisplayString:{get:function(){return System.String.concat(System.Single.format(this.X),"  ",System.Single.format(this.Y))}}},alias:["equalsT","System$IEquatable$1$Humper$Base$Vector2$equalsT"],ctors:{$ctor2:function(x,y){this.$initialize();this.X=x;this.Y=y},$ctor1:function(value){this.$initialize();this.X=value;this.Y=value},ctor:function(){this.$initialize()}},methods:{equals:function(obj){return Bridge.is(obj,Humper.Base.Vector2)?this.equalsT(Bridge.cast(obj,Humper.Base.Vector2)):!1},equalsT:function(other){return this.X===other.X&&this.Y===other.Y},getHashCode:function(){return System.Single.getHashCode(this.X)+System.Single.getHashCode(this.Y)|0},Length:function(){return Math.sqrt(this.X*this.X+this.Y*this.Y)},LengthSquared:function(){return this.X*this.X+this.Y*this.Y},Normalize:function(){var val=1/Math.sqrt(this.X*this.X+this.Y*this.Y);this.X*=val;this.Y*=val},toString:function(){return"{X:"+System.Single.format(this.X)+" Y:"+System.Single.format(this.Y)+"}"},$clone:function(to){var s=to||new Humper.Base.Vector2;return s.X=this.X,s.Y=this.Y,s}}});Bridge.define("Humper.IBox",{$kind:"interface"});Bridge.define("Humper.ICollision",{$kind:"interface"});Bridge.define("Humper.Grid",{fields:{CellSize:0,Cells:null},props:{Width:{get:function(){return this.Columns*this.CellSize}},Height:{get:function(){return this.Rows*this.CellSize}},Columns:{get:function(){return System.Array.getLength(this.Cells,0)}},Rows:{get:function(){return System.Array.getLength(this.Cells,1)}}},ctors:{ctor:function(width,height,cellSize){this.$initialize();this.Cells=System.Array.create(null,null,Humper.Grid.Cell,width,height);this.CellSize=cellSize}},methods:{QueryCells:function(x,y,w,h){var minX=Bridge.Int.clip32(x/this.CellSize),minY=Bridge.Int.clip32(y/this.CellSize),maxX=Bridge.Int.clip32((x+w-1)/this.CellSize)+1|0,maxY=Bridge.Int.clip32((y+h-1)/this.CellSize)+1|0,result,ix,iy,cell;for(minX=Math.max(0,minX),minY=Math.max(0,minY),maxX=Math.min(this.Columns-1|0,maxX),maxY=Math.min(this.Rows-1|0,maxY),result=new(System.Collections.Generic.List$1(Humper.Grid.Cell).ctor),ix=minX;ix<=maxX;ix=ix+1|0)for(iy=minY;iy<=maxY;iy=iy+1|0)cell=this.Cells.get([ix,iy]),cell==null&&(cell=new Humper.Grid.Cell(ix,iy,this.CellSize),this.Cells.set([ix,iy],cell)),result.add(cell);return result},QueryBoxes:function(x,y,w,h){var cells=this.QueryCells(x,y,w,h);return System.Linq.Enumerable.from(cells,Humper.Grid.Cell).selectMany(function(cell){return cell.Children}).distinct()},Add:function(box){var $t,cells=this.QueryCells(box.Humper$IBox$X,box.Humper$IBox$Y,box.Humper$IBox$Width,box.Humper$IBox$Height),cell;$t=Bridge.getEnumerator(cells,Humper.Grid.Cell);try{while($t.moveNext())cell=$t.Current,cell.Contains(box)||cell.Add(box)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}},Update:function(box,from){var $t,fromCells=this.QueryCells(from.X,from.Y,from.Width,from.Height),removed=!1,cell;$t=Bridge.getEnumerator(fromCells,Humper.Grid.Cell);try{while($t.moveNext())cell=$t.Current,removed=!!(removed|cell.Remove(box))}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}removed&&this.Add(box)},Remove:function(box){var $t,cells=this.QueryCells(box.Humper$IBox$X,box.Humper$IBox$Y,box.Humper$IBox$Width,box.Humper$IBox$Height),removed=!1,cell;$t=Bridge.getEnumerator(cells,Humper.Grid.Cell);try{while($t.moveNext())cell=$t.Current,removed=!!(removed|cell.Remove(box))}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return removed},toString:function(){return System.String.format("[Grid: Width={0}, Height={1}, Columns={2}, Rows={3}]",this.Width,this.Height,this.Columns,this.Rows)}}});Bridge.define("Humper.Grid.Cell",{$kind:"nested class",fields:{Bounds:null,children:null},props:{Children:{get:function(){return this.children}}},ctors:{init:function(){this.Bounds=new Humper.Base.RectangleF;this.children=new(System.Collections.Generic.List$1(Humper.IBox).ctor)},ctor:function(x,y,cellSize){this.$initialize();this.Bounds=new Humper.Base.RectangleF.$ctor3(x*cellSize,y*cellSize,cellSize,cellSize)}},methods:{Add:function(box){this.children.add(box)},Contains:function(box){return this.children.contains(box)},Remove:function(box){return this.children.remove(box)},Count:function(){return this.children.Count}}});Bridge.define("Humper.IHit",{$kind:"interface"});Bridge.define("Humper.IMovement",{$kind:"interface"});Bridge.define("Humper.IWorld",{$kind:"interface"});Bridge.define("Humper.Responses.ICollisionResponse",{$kind:"interface"});Bridge.define("Humper.Responses.CollisionResponses",{$kind:"enum",statics:{fields:{None:0,Touch:1,Cross:2,Slide:3,Bounce:4}}});Bridge.define("JuiceboxEngine.Resources.IResource",{$kind:"interface"});Bridge.define("JuiceboxEngine.Animations.AnimationFrame",{fields:{Duration:0,SourceRectangle:null},ctors:{init:function(){this.SourceRectangle=new JuiceboxEngine.Math.Rectangle}}});Bridge.define("JuiceboxEngine.Animations.Animator",{fields:{Animations:null,PlayingAnimation:null,SourceRectangle:null,Speed:0,_progress:0,_curFrame:0},props:{CurrentFrame:{get:function(){return this._curFrame}}},ctors:{init:function(){this.SourceRectangle=new JuiceboxEngine.Math.Rectangle},ctor:function(){this.$initialize();this.Animations=new(System.Collections.Generic.List$1(JuiceboxEngine.Animations.Animation).ctor);this.Speed=1}},methods:{GetAnimations:function(){return System.Linq.Enumerable.from(this.Animations,JuiceboxEngine.Animations.Animation).select(function(x){return x.Name}).ToArray(System.String)},SetAnimation$1:function(animation){this.PlayingAnimation!=null&&System.String.equals(this.PlayingAnimation.Name,animation)||(this.PlayingAnimation=System.Linq.Enumerable.from(this.Animations,JuiceboxEngine.Animations.Animation).where(function(x){return System.String.equals(x.Name,animation)}).firstOrDefault(null,null),this._progress=0,this._curFrame=0,this.PlayingAnimation==null?JuiceboxEngine.Logger.Error("Unable to find animation with name "+(animation||"")):this.SourceRectangle=this.PlayingAnimation.Frames.getItem(this._curFrame).SourceRectangle.$clone())},SetAnimation:function(animation){animation!=null&&(this.PlayingAnimation=animation,this._progress=0,this._curFrame=0,this.PlayingAnimation==null?JuiceboxEngine.Logger.Error(System.String.concat("Unable to find animation with name ",animation)):this.SourceRectangle=this.PlayingAnimation.Frames.getItem(this._curFrame).SourceRectangle.$clone())},Update:function(){this.PlayingAnimation==null&&this.SetAnimation(System.Linq.Enumerable.from(this.Animations,JuiceboxEngine.Animations.Animation).firstOrDefault(null,null));this._progress+=JuiceboxEngine.Util.Time.DeltaTime*this.Speed;this.PlayingAnimation!=null&&this._progress>=this.PlayingAnimation.Frames.getItem(this._curFrame).Duration&&(this.SourceRectangle=this.PlayingAnimation.Frames.getItem(this._curFrame).SourceRectangle.$clone(),this._curFrame=(this._curFrame+1|0)%this.PlayingAnimation.Frames.Count,this._progress=0)}}});Bridge.define("JuiceboxEngine.Resources.ResourceLoader",{fields:{Extension:null,Name:null},ctors:{ctor:function(name,extension){this.$initialize();this.Extension=extension;this.Name=name}}});Bridge.define("JuiceboxEngine.Component",{fields:{Name:null,Enabled:!1,Parent:null}});Bridge.define("JuiceboxEngine.Audio.AudioManager",{statics:{fields:{Muted:!1},ctors:{ctor:function(){Howler.noAudio&&JuiceboxEngine.Logger.Warn("Audio not available on this platform!");Howler.usingWebAudio||JuiceboxEngine.Logger.Warn("Web Audio API not available.");Howler.mobileAutoEnable=!0;Howler.autoSuspend=!1}},methods:{GlobalVolume:function(volume){Howler.volume(volume)},Mute:function(mute){Howler.mute(mute);JuiceboxEngine.Audio.AudioManager.Muted=mute}}}});Bridge.define("JuiceboxEngine.Coroutines.Coroutine",{fields:{Enumerator:null,YieldInstruction:null,MoveNextResult:!1,_stopped:!1},ctors:{ctor:function(routine){this.$initialize();this.Enumerator=routine;this._stopped=!1}},methods:{StopCoroutine:function(){this._stopped=!0;this.YieldInstruction!=null&&this.YieldInstruction.Stop()},Move:function(){return this._stopped?(this.MoveNextResult=!1,!1):(this.MoveNextResult=this.Enumerator.System$Collections$IEnumerator$moveNext(),this.YieldInstruction=Bridge.cast(this.Enumerator.System$Collections$IEnumerator$Current,JuiceboxEngine.Coroutines.YieldInstruction),this.MoveNextResult)}}});Bridge.define("JuiceboxEngine.Coroutines.CoroutineManager",{statics:{fields:{_coroutines:null,_toAdd:null,_toRemove:null},ctors:{ctor:function(){JuiceboxEngine.Coroutines.CoroutineManager._coroutines=new(System.Collections.Generic.List$1(JuiceboxEngine.Coroutines.Coroutine).ctor);JuiceboxEngine.Coroutines.CoroutineManager._toAdd=new(System.Collections.Generic.List$1(JuiceboxEngine.Coroutines.Coroutine).ctor);JuiceboxEngine.Coroutines.CoroutineManager._toRemove=new(System.Collections.Generic.List$1(JuiceboxEngine.Coroutines.Coroutine).ctor)}},methods:{StartCoroutine:function(coroutine){var routine=new JuiceboxEngine.Coroutines.Coroutine(coroutine);return JuiceboxEngine.Coroutines.CoroutineManager._toAdd.insert(0,routine),routine.Move(),routine},StopCoroutine:function(coroutine){coroutine.StopCoroutine()},Update:function(){for(var cr,i1,coroutine,i2,cr1,i=0;i<JuiceboxEngine.Coroutines.CoroutineManager._toAdd.Count;i=i+1|0)cr=JuiceboxEngine.Coroutines.CoroutineManager._toAdd.getItem(i),JuiceboxEngine.Coroutines.CoroutineManager._coroutines.add(cr);for(JuiceboxEngine.Coroutines.CoroutineManager._toAdd.clear(),i1=0;i1<JuiceboxEngine.Coroutines.CoroutineManager._coroutines.Count;i1=i1+1|0)coroutine=JuiceboxEngine.Coroutines.CoroutineManager._coroutines.getItem(i1),(coroutine.YieldInstruction==null||coroutine.YieldInstruction.CanContinue())&&(coroutine.Move()||JuiceboxEngine.Coroutines.CoroutineManager._toRemove.add(coroutine));for(i2=0;i2<JuiceboxEngine.Coroutines.CoroutineManager._toRemove.Count;i2=i2+1|0)cr1=JuiceboxEngine.Coroutines.CoroutineManager._toRemove.getItem(i2),JuiceboxEngine.Coroutines.CoroutineManager._coroutines.remove(cr1);JuiceboxEngine.Coroutines.CoroutineManager._toRemove.clear()}}}});Bridge.define("JuiceboxEngine.Coroutines.DefaultRoutines",{statics:{methods:{Linear:function(duration,action,realTime){var $step=0,$jumpFromFinally,$returnValue,progress,$async_e,$enumerator=new Bridge.GeneratorEnumerator(Bridge.fn.bind(this,function(){try{for(;;)switch($step){case 0:realTime===void 0&&(realTime=!1);progress=0;$step=1;continue;case 1:if(1){$step=2;continue}$step=4;continue;case 2:if(progress+=realTime?JuiceboxEngine.Util.Time.DeltaTimeRealTime:JuiceboxEngine.Util.Time.DeltaTime,progress>=duration){action(1);$step=4;continue}return action(progress/duration),$enumerator.current=null,$step=3,!0;case 3:$step=1;continue;case 4:default:return!1}}catch($async_e1){$async_e=System.Exception.create($async_e1);throw $async_e;}}));return $enumerator},LinearRepeat:function(duration,action,realTime){var $step=0,$jumpFromFinally,$returnValue,progress,$async_e,$enumerator=new Bridge.GeneratorEnumerator(Bridge.fn.bind(this,function(){try{for(;;)switch($step){case 0:realTime===void 0&&(realTime=!1);progress=0;$step=1;continue;case 1:if(1){$step=2;continue}$step=4;continue;case 2:return progress+=realTime?JuiceboxEngine.Util.Time.DeltaTimeRealTime:JuiceboxEngine.Util.Time.DeltaTime,progress=progress%duration,action(progress/duration),$enumerator.current=null,$step=3,!0;case 3:$step=1;continue;case 4:default:return!1}}catch($async_e1){$async_e=System.Exception.create($async_e1);throw $async_e;}}));return $enumerator}}}});Bridge.define("JuiceboxEngine.Coroutines.YieldInstruction",{methods:{Stop:function(){return}}});Bridge.define("JuiceboxEngine.Debugging.DebugRenderer",{statics:{fields:{_instance:null,_instanceGUI:null},props:{Instance:{get:function(){return JuiceboxEngine.Debugging.DebugRenderer._instance==null&&(JuiceboxEngine.Debugging.DebugRenderer._instance=new JuiceboxEngine.Debugging.DebugRenderer),JuiceboxEngine.Debugging.DebugRenderer._instance}},InstanceGUI:{get:function(){return JuiceboxEngine.Debugging.DebugRenderer._instanceGUI==null&&(JuiceboxEngine.Debugging.DebugRenderer._instanceGUI=new JuiceboxEngine.Debugging.DebugRenderer),JuiceboxEngine.Debugging.DebugRenderer._instanceGUI}}}},fields:{_manager:null,_debugSpriteBatch:null,_defaultTexture:null,_lines:null},ctors:{ctor:function(){this.$initialize();this._manager=new JuiceboxEngine.Resources.ResourceManager;this._manager.RegisterResourceManager(new JuiceboxEngine.Graphics.ShaderResourceLoader);this._manager.RegisterResourceManager(new JuiceboxEngine.Graphics.TextureResourceLoader);this._debugSpriteBatch=new JuiceboxEngine.Graphics.Spritebatch(this._manager);this._defaultTexture=new JuiceboxEngine.Graphics.Texture2D.ctor;this._lines=new(System.Collections.Generic.List$1(JuiceboxEngine.Debugging.DebugRenderer.Line).ctor)}},methods:{DrawRect:function(rect,color,width){this.DrawLine(new JuiceboxEngine.Math.Vector2.$ctor3(rect.X,rect.Y),new JuiceboxEngine.Math.Vector2.$ctor3(rect.X+rect.Width,rect.Y),color.$clone(),width);this.DrawLine(new JuiceboxEngine.Math.Vector2.$ctor3(rect.X,rect.Y),new JuiceboxEngine.Math.Vector2.$ctor3(rect.X,rect.Y+rect.Height),color.$clone(),width);this.DrawLine(new JuiceboxEngine.Math.Vector2.$ctor3(rect.X,rect.Y+rect.Height),new JuiceboxEngine.Math.Vector2.$ctor3(rect.X+rect.Width,rect.Y+rect.Height),color.$clone(),width);this.DrawLine(new JuiceboxEngine.Math.Vector2.$ctor3(rect.X+rect.Width,rect.Y),new JuiceboxEngine.Math.Vector2.$ctor3(rect.X+rect.Width,rect.Y+rect.Height),color.$clone(),width)},DrawLine:function(start,end,color,width){width===void 0&&(width=1);var line=new JuiceboxEngine.Debugging.DebugRenderer.Line.$ctor1(start.$clone(),end.$clone(),color.$clone(),width);this._lines.add(line)},DrawRectFilled:function(rect,color){var start=new JuiceboxEngine.Math.Vector2.$ctor3(rect.X+JuiceboxEngine.Math.JMath.Ceiling(rect.Width/2),rect.Y),end=new JuiceboxEngine.Math.Vector2.$ctor3(rect.X+JuiceboxEngine.Math.JMath.Ceiling(rect.Width/2),rect.Y+rect.Height),line=new JuiceboxEngine.Debugging.DebugRenderer.Line.$ctor1(start.$clone(),end.$clone(),color.$clone(),rect.Width);this._lines.add(line)},RenderDebugLines:function(){var $t,useDepth=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.UsingDepth,context,line,dist;JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.UseDepth(!1);context=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context;this._debugSpriteBatch.Begin();$t=Bridge.getEnumerator(this._lines);try{while($t.moveNext())line=$t.Current,dist=JuiceboxEngine.Math.Vector2.Distance(line.p0.$clone(),line.p1.$clone()),this._debugSpriteBatch.Draw$1(this._defaultTexture,new JuiceboxEngine.Math.RectangleF.$ctor2(line.p0.$clone().X,line.p0.$clone().Y,dist,line.width),new JuiceboxEngine.Math.Rectangle.$ctor2(0,0,1,1),line.color.$clone(),JuiceboxEngine.Math.JMath.ATan2(line.p1.$clone().Y-line.p0.$clone().Y,line.p1.$clone().X-line.p0.$clone().X),new JuiceboxEngine.Math.Vector2.$ctor3(0,-line.width/2),0,JuiceboxEngine.Sprite.SpriteFlip.None)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}this._debugSpriteBatch.End();this._lines.clear();JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.UseDepth(useDepth)}}});Bridge.define("JuiceboxEngine.Debugging.DebugRenderer.Line",{$kind:"nested struct",statics:{methods:{getDefaultValue:function(){return new JuiceboxEngine.Debugging.DebugRenderer.Line}}},fields:{p0:null,p1:null,color:null,width:0},ctors:{init:function(){this.p0=new JuiceboxEngine.Math.Vector2;this.p1=new JuiceboxEngine.Math.Vector2;this.color=new JuiceboxEngine.Math.Color},$ctor1:function(p0,p1,color,width){this.$initialize();this.p0=p0.$clone();this.p1=p1.$clone();this.color=color.$clone();this.width=width},ctor:function(){this.$initialize()}},methods:{getHashCode:function(){return Bridge.addHash([1701734732,this.p0,this.p1,this.color,this.width])},equals:function(o){return Bridge.is(o,JuiceboxEngine.Debugging.DebugRenderer.Line)?Bridge.equals(this.p0,o.p0)&&Bridge.equals(this.p1,o.p1)&&Bridge.equals(this.color,o.color)&&Bridge.equals(this.width,o.width):!1},$clone:function(to){var s=to||new JuiceboxEngine.Debugging.DebugRenderer.Line;return s.p0=this.p0.$clone(),s.p1=this.p1.$clone(),s.color=this.color.$clone(),s.width=this.width,s}}});Bridge.define("JuiceboxEngine.GameObject",{fields:{Name:null,Enabled:!1,Transform:null,UserData:null,_components:null,_graphicsComponents:null,_currentScene:null},ctors:{ctor:function(parent){this.$initialize();this._currentScene=parent;this.Name="Gameobject";this._components=new(System.Collections.Generic.List$1(JuiceboxEngine.Component).ctor);this._graphicsComponents=new(System.Collections.Generic.List$1(JuiceboxEngine.GraphicsComponent).ctor);this.Transform=this.AddComponent(JuiceboxEngine.Transform);this.Enabled=!0},$ctor1:function(parent,name){JuiceboxEngine.GameObject.ctor.call(this,parent);this.Name=name}},methods:{Destroy:function(){var $t,comp;$t=Bridge.getEnumerator(this._components);try{while($t.moveNext())comp=$t.Current,comp.Destroy()}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}},Update:function(){for(var comp=null,i=0;i<this._components.Count;i=i+1|0)comp=this._components.getItem(i),comp.Enabled&&comp.Update()},Render:function(){for(var comp=null,i=0;i<this._graphicsComponents.Count;i=i+1|0)comp=this._graphicsComponents.getItem(i),comp.Enabled&&comp.Render()},AddComponent:function(T){var val=this.GetComponent(T),newComp;return val==null||!val.Unique()?(newComp=Bridge.createInstance(T),this._components.add(newComp),newComp.Parent=this,newComp.Enabled=!0,Bridge.is(newComp,JuiceboxEngine.GraphicsComponent)&&this._graphicsComponents.add(Bridge.as(newComp,JuiceboxEngine.GraphicsComponent)),Bridge.is(newComp,JuiceboxEngine.Camera)&&this._currentScene.AddCamera(Bridge.as(newComp,JuiceboxEngine.Camera)),newComp.Initialize(this._currentScene.ResourceManager),newComp):null},RemoveComponent:function(T){var component=this.GetComponent(T);component!=null&&(this._components.remove(component),Bridge.is(component,JuiceboxEngine.GraphicsComponent)&&this._graphicsComponents.remove(Bridge.as(component,JuiceboxEngine.GraphicsComponent)),component.Destroy())},GetComponent:function(T){for(var comp=null,i=0;i<this._components.Count;i=i+1|0)if(comp=this._components.getItem(i),Bridge.is(this._components.getItem(i),T))return Bridge.cast(comp,T);return null},GetComponents:function(T){return Bridge.cast(System.Linq.Enumerable.from(this._components,JuiceboxEngine.Component).where(function(x){return Bridge.is(x,T)}).ToArray(JuiceboxEngine.Component),System.Array.type(T))}}});Bridge.define("JuiceboxEngine.Graphics.DefaultShaderValues",{$kind:"enum",statics:{fields:{TIME:0,DELTATIME:1,MOUSEPOS:2,WORLD:3,VIEW:4,PROJ:5,WORLDVIEWPROJ:6,CANVASSIZE:7,VIEWPORTSIZE:8,CAMERAPOSITION:9,ZOOM:10}}});Bridge.define("JuiceboxEngine.Graphics.GraphicsCommand",{fields:{Program:null,VertexBuffer:null,Data:null,_data:null},ctors:{ctor:function(){this.$initialize();this.Data=new(System.Collections.Generic.List$1(JuiceboxEngine.Graphics.Uniform).ctor);this._data=new(System.Collections.Generic.Dictionary$2(System.String,JuiceboxEngine.Graphics.Uniform).ctor);this.VertexBuffer=null;this.Program=null}},methods:{SetShaderValue:function(key,value,type){type===void 0&&(type=0);var uniform={};this._data.tryGetValue(key,uniform);uniform.v==null&&(uniform.v=type===JuiceboxEngine.Graphics.Uniform.UniformType.NONE?new JuiceboxEngine.Graphics.Uniform.ctor(key,value):new JuiceboxEngine.Graphics.Uniform.$ctor1(key,value,type),this._data.add(key,uniform.v),this.Data.add(uniform.v));uniform.v.value=value}}});Bridge.define("JuiceboxEngine.Graphics.GraphicsContext",{fields:{_gl:null,_canvas:null,_shaderValues:null,_defaultNamesCache:null,_textureCount:0,_curActiveTexture:0,_curProgram:null,_setAttributes:0,DefaultTexture:null,UsingDepth:!1},ctors:{ctor:function(canvas){this.$initialize();this._canvas=canvas;this._gl=this.GetContext(canvas);this._gl==null?JuiceboxEngine.Logger.Error("Unable to initialize WebGL context!"):JuiceboxEngine.Logger.Log("Initialized WebGL!");this._defaultNamesCache=System.Enum.getNames(JuiceboxEngine.Graphics.DefaultShaderValues);this._shaderValues=System.Array.init(this._defaultNamesCache.length,null,JuiceboxEngine.Graphics.Uniform);for(var i=0;i<this._defaultNamesCache.length;i=i+1|0)this._shaderValues[i]=new JuiceboxEngine.Graphics.Uniform.$ctor1(this._defaultNamesCache[i],null,JuiceboxEngine.Graphics.Uniform.UniformType.NONE);this._curProgram=null;this._setAttributes=0;this.DefaultTexture=this.CreateTexture$1(1,1,System.Array.init([255,255,255,255],System.Byte));this._gl.enable(this._gl.BLEND);this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA);this._gl.enable(this._gl.DEPTH_TEST)}},methods:{GetContext:function(canvas){var $t,context=null,names=System.Array.init(["webgl","experimental-webgl","webkit-3d","moz-webgl"],System.String),name;$t=Bridge.getEnumerator(names);try{while($t.moveNext()){name=$t.Current;try{context=canvas.getContext(name)}catch(ex){ex=System.Exception.create(ex);JuiceboxEngine.Logger.Error(Bridge.toString(ex))}if(context!=null)break}}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return context},Clear:function(color){this._gl.clearColor(color.R,color.G,color.B,color.A);this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT)},SetPixels:function(texture,rect,data){for(var rawData=new Uint8Array(Bridge.Int.mul(data.length,4)),i=0;i<data.length;i=i+1|0)rawData[Bridge.Int.mul(i,4)+0|0]=Bridge.Int.clipu8(data[i].R*255),rawData[Bridge.Int.mul(i,4)+1|0]=Bridge.Int.clipu8(data[i].G*255),rawData[Bridge.Int.mul(i,4)+2|0]=Bridge.Int.clipu8(data[i].B*255),rawData[Bridge.Int.mul(i,4)+3|0]=Bridge.Int.clipu8(data[i].A*255);this._gl.bindTexture(this._gl.TEXTURE_2D,texture.Texture);this._gl.texSubImage2D(this._gl.TEXTURE_2D,0,rect.X,rect.Y,rect.Width,rect.Height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,rawData);this._gl.bindTexture(this._gl.TEXTURE_2D,null)},GetPixels:function(texture,rect){var colors,frameBuffer,data,i;if(this._gl.bindTexture(this._gl.TEXTURE_2D,texture.Texture),colors=null,frameBuffer=this._gl.createFramebuffer(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,frameBuffer),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,texture.Texture,0),this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER)===this._gl.FRAMEBUFFER_COMPLETE)for(data=new Uint8Array(Bridge.Int.mul(Bridge.Int.mul(rect.Width,rect.Height),4)),this._gl.readPixels(rect.X,rect.Y,rect.Width,rect.Height,this._gl.RGBA,this._gl.UNSIGNED_BYTE,data),colors=System.Array.init(data.length,0,System.Byte),i=0;i<colors.length;i=i+1|0)colors[i]=data[i];return this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.deleteFramebuffer(frameBuffer),colors},SetGlobalShaderValue:function(key,value){this._shaderValues[key].value=value},GetDefaultShaderParamString:function(dsv){return this._defaultNamesCache[dsv]},Command:function(command){var attribs,maxAttribs,i,attrib,loc,i1,defaultValuesArray,i2,defaultShaderValue;if(command.VertexBuffer.VertCount!==0){for(Bridge.referenceEquals(this._curProgram,command.Program)||(this._curProgram=command.Program,this._gl.useProgram(command.Program.Program)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,command.VertexBuffer.Buffer),attribs=command.VertexBuffer.Attributes,maxAttribs=JuiceboxEngine.Math.JMath.Max(this._setAttributes,attribs.Count),i=0;i<maxAttribs;i=i+1|0)i<attribs.Count?(attrib=attribs.getItem(i),loc=this._gl.getAttribLocation(command.Program.Program,attrib.Name),this._gl.vertexAttribPointer(loc,attrib.Components,this._gl.FLOAT,attrib.Normalize,attrib.Stride,attrib.Offset),this._gl.enableVertexAttribArray(i)):this._gl.disableVertexAttribArray(i);for(this._setAttributes=attribs.Count,this._textureCount=0,i1=0;i1<command.Data.Count;i1=i1+1|0)this.SetUniform(command.Program,command.Data.getItem(i1));for(defaultValuesArray=command.Program.DefaultShaderValues,i2=0;i2<defaultValuesArray.length;i2=i2+1|0){if(defaultShaderValue=defaultValuesArray[i2],defaultValuesArray[i2]===JuiceboxEngine.Graphics.DefaultShaderValues.WORLDVIEWPROJ){var world=Bridge.cast(this._shaderValues[JuiceboxEngine.Graphics.DefaultShaderValues.WORLD].value,JuiceboxEngine.Math.Matrix4),view=Bridge.cast(this._shaderValues[JuiceboxEngine.Graphics.DefaultShaderValues.VIEW].value,JuiceboxEngine.Math.Matrix4),proj=Bridge.cast(this._shaderValues[JuiceboxEngine.Graphics.DefaultShaderValues.PROJ].value,JuiceboxEngine.Math.Matrix4);this.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.WORLDVIEWPROJ,JuiceboxEngine.Math.Matrix4.Multiply(JuiceboxEngine.Math.Matrix4.Multiply(world.$clone(),view.$clone()),proj.$clone()))}this.SetUniform(command.Program,this._shaderValues[defaultShaderValue])}this._gl.drawArrays(this._gl.TRIANGLES,command.VertexBuffer.StartIndex,command.VertexBuffer.VertexRange===0?command.VertexBuffer.VertCount:command.VertexBuffer.VertexRange)}},SetUniform:function(program,uniform){var $t,val,location,loc,vec2,vec3,vec4,col,mat,dat,j;if(uniform.value!=null&&(val=uniform.value,uniform.type===JuiceboxEngine.Graphics.Uniform.UniformType.NONE&&(uniform.type=JuiceboxEngine.Graphics.Uniform.GetType(val)),location={},program.UniformLocations.tryGetValue(uniform.name,location)||(loc=this._gl.getUniformLocation(program.Program,uniform.name),loc!=null&&(location.v=($t=new JuiceboxEngine.Graphics.ShaderProgram.UniformLocation,$t.location=loc,$t)),program.UniformLocations.add(uniform.name,location.v)),location.v!=null))switch(uniform.type){case JuiceboxEngine.Graphics.Uniform.UniformType.FLOAT:this._gl.uniform1f(location.v.location,Bridge.cast(val,System.Single));break;case JuiceboxEngine.Graphics.Uniform.UniformType.DOUBLE:this._gl.uniform1f(location.v.location,Bridge.cast(val,System.Single));break;case JuiceboxEngine.Graphics.Uniform.UniformType.INT:this._gl.uniform1f(location.v.location,Bridge.cast(val,System.Single));break;case JuiceboxEngine.Graphics.Uniform.UniformType.VECTOR2:vec2=Bridge.cast(val,JuiceboxEngine.Math.Vector2);this._gl.uniform2f(location.v.location,vec2.X,vec2.Y);break;case JuiceboxEngine.Graphics.Uniform.UniformType.VECTOR3:vec3=Bridge.cast(val,JuiceboxEngine.Math.Vector3);this._gl.uniform3f(location.v.location,vec3.X,vec3.Y,vec3.Z);break;case JuiceboxEngine.Graphics.Uniform.UniformType.VECTOR4:vec4=Bridge.cast(val,JuiceboxEngine.Math.Vector4);this._gl.uniform4f(location.v.location,vec4.X,vec4.Y,vec4.Z,vec4.W);break;case JuiceboxEngine.Graphics.Uniform.UniformType.COLOR:col=Bridge.cast(val,JuiceboxEngine.Math.Color);this._gl.uniform4f(location.v.location,col.R,col.G,col.B,col.A);break;case JuiceboxEngine.Graphics.Uniform.UniformType.MATRIX4:for(mat=Bridge.cast(val,JuiceboxEngine.Math.Matrix4),dat=System.Array.init(16,0,System.Single),j=0;j<dat.length;j=j+1|0)dat[j]=mat.getItem(j);this._gl.uniformMatrix4fv(location.v.location,!1,dat);break;case JuiceboxEngine.Graphics.Uniform.UniformType.TEXTURE2D:this.SetTextureUniform(location.v.location,Bridge.as(val,JuiceboxEngine.Graphics.Texture2D));break;case JuiceboxEngine.Graphics.Uniform.UniformType.RENDERTARGET:this.SetTextureUniform(location.v.location,Bridge.as(val,JuiceboxEngine.Graphics.Texture2D));break;default:break}},SetTextureUniform:function(location,val){this._curActiveTexture!==this._textureCount&&this._gl.activeTexture(this._gl.TEXTURE0+this._textureCount|0);this._gl.bindTexture(this._gl.TEXTURE_2D,val.Texture);this._gl.uniform1i(location,this._textureCount);this._curActiveTexture=this._textureCount;this._textureCount=this._textureCount+1|0},UpdateTexture:function(texture){this._gl.bindTexture(this._gl.TEXTURE_2D,texture.Texture);var sample=texture.Sample===JuiceboxEngine.Graphics.Texture2D.SampleMode.Point?this._gl.NEAREST:this._gl.LINEAR,wrap=this._gl.CLAMP_TO_EDGE;switch(texture.Wrap){case JuiceboxEngine.Graphics.Texture2D.WrapMode.Clamp:wrap=this._gl.CLAMP_TO_EDGE;break;case JuiceboxEngine.Graphics.Texture2D.WrapMode.Repeat:wrap=this._gl.REPEAT;break;case JuiceboxEngine.Graphics.Texture2D.WrapMode.MirrorRepeat:wrap=this._gl.MIRRORED_REPEAT;break}this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,sample);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,sample);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,wrap);this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,wrap);this._gl.bindTexture(this._gl.TEXTURE_2D,null)},CreateVertexBuffer:function(data){var buffer=this._gl.createBuffer();return this._gl.bindBuffer(this._gl.ARRAY_BUFFER,buffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,data,this._gl.DYNAMIC_DRAW),buffer},UpdateVertexBufferData:function(buffer,offset,data){this._gl.bindBuffer(this._gl.ARRAY_BUFFER,buffer.Buffer);this._gl.bufferSubData(this._gl.ARRAY_BUFFER,Bridge.Int.mul(offset,Float32Array.BYTES_PER_ELEMENT),data)},DeleteBuffer:function(buffer){this._gl.deleteBuffer(buffer)},CreateRenderTarget:function(width,height,texture){var frameBuffer=this._gl.createFramebuffer(),renderBuffer,status;return this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,frameBuffer),renderBuffer=this._gl.createRenderbuffer(),this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,renderBuffer),this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,width,height),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,texture.Texture,0),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,renderBuffer),status=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER),status!==this._gl.FRAMEBUFFER_COMPLETE&&JuiceboxEngine.Logger.Error("Something went wrong creating the frame buffer!"),this._gl.bindTexture(this._gl.TEXTURE_2D,null),this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,null),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),frameBuffer},SetRenderTarget:function(target){target==null?(this._gl.viewport(0,0,this._canvas.width,this._canvas.height),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.VIEWPORTSIZE,new JuiceboxEngine.Math.Vector2.$ctor3(this._canvas.width,this._canvas.height))):(this._gl.viewport(0,0,target.Width,target.Height),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,target.Target),this.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.VIEWPORTSIZE,new JuiceboxEngine.Math.Vector2.$ctor3(target.Width,target.Height)));this.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.CANVASSIZE,new JuiceboxEngine.Math.Vector2.$ctor3(this._canvas.width,this._canvas.height))},DeleteRenderTarget:function(target){this._gl.deleteFramebuffer(target.Target);this._gl.deleteTexture(target.Texture)},DeleteTexture:function(texture){this._gl.deleteTexture(texture.Texture)},DeleteShader:function(shader){this._gl.deleteProgram(shader.Program)},CreateTexture:function(image){var texture=this._gl.createTexture();return this._gl.bindTexture(this._gl.TEXTURE_2D,texture),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,image),this._gl.bindTexture(this._gl.TEXTURE_2D,null),texture},CreateTexture$1:function(width,height,data){var texture=this._gl.createTexture(),platformData;return this._gl.bindTexture(this._gl.TEXTURE_2D,texture),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),platformData=new Uint8Array(data),data!=null?this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,width,height,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,platformData):this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,width,height,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.bindTexture(this._gl.TEXTURE_2D,null),texture},UseDepth:function($use){$use?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST);this.UsingDepth=$use},ScissorTest:function(rect,enable){enable===void 0&&(enable=!0);enable?(this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(rect.X,JuiceboxEngine.Graphics.GraphicsManager.Instance.Height-rect.Y|0,rect.Width,rect.Height)):this._gl.disable(this._gl.SCISSOR_TEST)},CompileShader:function(vertSource,fragSource){var vertexShader=this._gl.createShader(this._gl.VERTEX_SHADER),vertError,fragmentShader,fragError,program;return this._gl.shaderSource(vertexShader,vertSource),this._gl.compileShader(vertexShader),vertError=this._gl.getShaderInfoLog(vertexShader),System.String.isNullOrEmpty(vertError)||JuiceboxEngine.Logger.Error(vertError),fragmentShader=this._gl.createShader(this._gl.FRAGMENT_SHADER),this._gl.shaderSource(fragmentShader,fragSource),this._gl.compileShader(fragmentShader),fragError=this._gl.getShaderInfoLog(fragmentShader),System.String.isNullOrEmpty(fragError)||JuiceboxEngine.Logger.Error(fragError),program=this._gl.createProgram(),this._gl.attachShader(program,vertexShader),this._gl.attachShader(program,fragmentShader),this._gl.linkProgram(program),this._gl.deleteShader(vertexShader),this._gl.deleteShader(fragmentShader),program},CacheLocations:function(program){var $t,values=new(System.Collections.Generic.List$1(JuiceboxEngine.Graphics.DefaultShaderValues).ctor),dsv,location;$t=Bridge.getEnumerator(System.Enum.getValues(JuiceboxEngine.Graphics.DefaultShaderValues));try{while($t.moveNext())dsv=Bridge.cast($t.Current,JuiceboxEngine.Graphics.DefaultShaderValues),location=this._gl.getUniformLocation(program.Program,this.GetDefaultShaderParamString(dsv)),location!=null&&values.add(dsv)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}program.DefaultShaderValues=values.ToArray()}}});Bridge.define("JuiceboxEngine.Graphics.GraphicsManager",{statics:{fields:{_instance:null},props:{Instance:{get:function(){return JuiceboxEngine.Graphics.GraphicsManager._instance!=null?JuiceboxEngine.Graphics.GraphicsManager._instance:(JuiceboxEngine.Logger.Error("Graphics Manager is not initialized!"),null)}}}},fields:{Context:null,Width:0,Height:0,DPR:0,_pixelSize:0,_fullScreenQuad:null,_fullScreenQuadShader:null},events:{OnResize:null},ctors:{ctor:function(canvas){this.$initialize();this.Context=new JuiceboxEngine.Graphics.GraphicsContext(canvas);JuiceboxEngine.Graphics.GraphicsManager._instance=this;this._pixelSize=JuiceboxEngine.Util.Config.ConfigValues.PixelSize;this.Width=canvas.width;this.Height=canvas.height;this.Context.UseDepth(!1);var data=System.Array.init([-1,-1,0,0,1,1,-1,0,1,1,1,1,0,1,0,-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0],System.Single);this._fullScreenQuad=new JuiceboxEngine.Graphics.VertexBuffer.$ctor1(new Float32Array(data));this._fullScreenQuad.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_pos",3,!1,20,0));this._fullScreenQuad.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_tex",2,!1,20,12))}},methods:{RegisterLoaders:function(resourceManager){var trl=new JuiceboxEngine.Graphics.TextureResourceLoader;resourceManager.RegisterResourceManager(trl);resourceManager.RegisterResourceManager(new JuiceboxEngine.Graphics.ShaderResourceLoader);resourceManager.RegisterResourceManager(new JuiceboxEngine.Graphics.FontResourceLoader(trl));resourceManager.RegisterResourceManager(new JuiceboxEngine.Animations.AnimatorLoader);this._fullScreenQuadShader=resourceManager.Load(JuiceboxEngine.Graphics.ShaderProgram,"Shaders/FullScreen.vert")},RenderCamera:function(camera){var command=new JuiceboxEngine.Graphics.GraphicsCommand;command.VertexBuffer=this._fullScreenQuad;command.Program=this._fullScreenQuadShader;command.SetShaderValue("texture",camera.Target);command.SetShaderValue("pixelSize",this._pixelSize);command.SetShaderValue("fadeTexture",JuiceboxEngine.SceneManager.CurFadeTexture);command.SetShaderValue("fadeProgress",JuiceboxEngine.SceneManager.FadeProgress);this.Context.Command(command)},Resize:function(width,height,dpr){this.Width=width;this.Height=height;this.DPR=dpr;Bridge.staticEquals(this.OnResize,null)?null:this.OnResize(width,height)},Update:function(){this.Context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.TIME,JuiceboxEngine.Util.Time.TotalSeconds);this.Context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.DELTATIME,JuiceboxEngine.Util.Time.DeltaTime)}}});Bridge.define("JuiceboxEngine.Graphics.HorizontalAlignment",{$kind:"enum",statics:{fields:{LEFT:0,CENTER:1,RIGHT:2}}});Bridge.define("JuiceboxEngine.Graphics.ShaderProgram.UniformLocation",{$kind:"nested class",fields:{location:null}});Bridge.define("JuiceboxEngine.Graphics.Spritebatch",{fields:{Begun:!1,_batcher:null,_frustumCulling:!1,_frustum:null,_culled:0,_drawn:0},ctors:{init:function(){this._frustum=new JuiceboxEngine.Math.RectangleF},ctor:function(manager){this.$initialize();this._batcher=new JuiceboxEngine.Graphics.SpriteBatcher(manager)}},methods:{Begin:function(frustum){if(frustum===void 0&&(frustum=null),this.Begun===!0){JuiceboxEngine.Logger.Warn("Spritebatch already begun! Skipping this Begin().");return}System.Nullable.hasValue(frustum)&&(this._frustum=System.Nullable.getValue(frustum).$clone());this._frustumCulling=System.Nullable.hasValue(frustum);this._culled=0;this._drawn=0;this.Begun=!0},End:function(){this.Begun=!1;this._batcher.DrawBatch()},Draw:function(texture,destinationRectangle,sourceRectangle,color,rotation,pivot,depth,flip){var rect=new JuiceboxEngine.Math.RectangleF.$ctor2(destinationRectangle.X,destinationRectangle.Y,destinationRectangle.Width,destinationRectangle.Height);this.Draw$1(texture,rect.$clone(),sourceRectangle.$clone(),color.$clone(),rotation,pivot.$clone(),depth,flip)},Draw$1:function(texture,destinationRectangle,sourceRectangle,color,rotation,pivot,depth,flip){var item,temp,temp1;if(color={v:color},this._frustumCulling&&(this._frustum.Left>destinationRectangle.Right+pivot.X||this._frustum.Right<destinationRectangle.Left+pivot.X||this._frustum.Top<destinationRectangle.Bottom+pivot.Y||this._frustum.Bottom>destinationRectangle.Top+pivot.Y)){this._culled=this._culled+1|0;return}this._drawn=this._drawn+1|0;item=this._batcher.CreateBatchItem();item.Texture2D=texture;item.Depth=depth;var sWidth=sourceRectangle.Width,sHeight=sourceRectangle.Height,tWidth=texture.Width,tHeight=texture.Height,upperLeft={v:new JuiceboxEngine.Math.Vector2.$ctor3(sourceRectangle.X/tWidth,sourceRectangle.Y/tHeight)},lowerRight={v:new JuiceboxEngine.Math.Vector2.$ctor3(sourceRectangle.X/tWidth+sWidth/tWidth,sourceRectangle.Y/tHeight+sHeight/tHeight)},flipVal=flip;(flipVal&1)==1&&(temp=upperLeft.v.X,upperLeft.v.X=lowerRight.v.X,lowerRight.v.X=temp);(flipVal&2)==2&&(temp1=upperLeft.v.Y,upperLeft.v.Y=lowerRight.v.Y,lowerRight.v.Y=temp1);item.Set(destinationRectangle.X,destinationRectangle.Y,pivot.X,pivot.Y,destinationRectangle.Width,destinationRectangle.Height,JuiceboxEngine.Math.JMath.Sin(rotation),JuiceboxEngine.Math.JMath.Cos(rotation),color,upperLeft,lowerRight)}}});Bridge.define("JuiceboxEngine.Graphics.SpriteBatcher",{statics:{fields:{ELEMENTS_PER_TRIANGLE:0,ELEMENTS_PER_SPRITE:0},ctors:{init:function(){this.ELEMENTS_PER_TRIANGLE=27;this.ELEMENTS_PER_SPRITE=54}}},fields:{_batchItemList:null,_freeBatchItemQueue:null,_vertexArray:null,_command:null},ctors:{ctor:function(manager){this.$initialize();this._batchItemList=new(System.Collections.Generic.List$1(JuiceboxEngine.Graphics.SpriteBatchItem).$ctor2)(256);this._freeBatchItemQueue=new(System.Collections.Generic.Queue$1(JuiceboxEngine.Graphics.SpriteBatchItem).$ctor2)(256);this._vertexArray=System.Array.init(13824,0,System.Single);this._command=new JuiceboxEngine.Graphics.GraphicsCommand;this._command.VertexBuffer=new JuiceboxEngine.Graphics.VertexBuffer.ctor;this._command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_pos",3,!1,36,0));this._command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_tex",2,!1,36,12));this._command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_col",4,!1,36,20));this._command.SetShaderValue("texture",null,JuiceboxEngine.Graphics.Uniform.UniformType.TEXTURE2D);this._command.Program=manager.Load(JuiceboxEngine.Graphics.ShaderProgram,"Shaders/Sprite.vert")}},methods:{CreateBatchItem:function(){var item;return item=this._freeBatchItemQueue.Count>0?this._freeBatchItemQueue.Dequeue():new JuiceboxEngine.Graphics.SpriteBatchItem,this._batchItemList.add(item),item},CompareDepth:function(a,b){return Bridge.compare(a.Depth,b.Depth)},CompareTexture:function(a,b){return Bridge.compare(a.Texture2D.sortValue,b.Texture2D.sortValue)},DrawBatch:function(){var el,item,i;if(this._batchItemList.Sort$2(Bridge.fn.cacheBind(this,this.CompareTexture)),this._batchItemList.Count!==0){Bridge.Int.mul(this._batchItemList.Count,JuiceboxEngine.Graphics.SpriteBatcher.ELEMENTS_PER_SPRITE)>this._vertexArray.length&&this.ExpandVertexArray(this._batchItemList.Count);var index=0,ind=0,startIndex=0,curTexture=this._batchItemList.getItem(0).Texture2D;for(this._command.SetShaderValue("texture",curTexture),el=0;el<this._batchItemList.Count;el=el+1|0){for(item=this._batchItemList.getItem(el),Bridge.referenceEquals(item.Texture2D.Texture,curTexture.Texture)||(this.Draw(startIndex,index),curTexture=item.Texture2D,startIndex=index,this._command.SetShaderValue("texture",curTexture)),i=0;i<6;i=i+1|0)this._vertexArray[Bridge.identity(ind,ind=ind+1|0)]=item.positionX[i],this._vertexArray[Bridge.identity(ind,ind=ind+1|0)]=item.positionY[i],this._vertexArray[Bridge.identity(ind,ind=ind+1|0)]=item.Depth,this._vertexArray[Bridge.identity(ind,ind=ind+1|0)]=item.textureU[i],this._vertexArray[Bridge.identity(ind,ind=ind+1|0)]=item.textureV[i],this._vertexArray[Bridge.identity(ind,ind=ind+1|0)]=item.color.R,this._vertexArray[Bridge.identity(ind,ind=ind+1|0)]=item.color.G,this._vertexArray[Bridge.identity(ind,ind=ind+1|0)]=item.color.B,this._vertexArray[Bridge.identity(ind,ind=ind+1|0)]=item.color.A;index=index+2|0;this._freeBatchItemQueue.Enqueue(item)}this.Draw(startIndex,index);this._batchItemList.clear()}},Draw:function(start,end){for(var length=Bridge.Int.mul(end-start|0,JuiceboxEngine.Graphics.SpriteBatcher.ELEMENTS_PER_TRIANGLE),startPos=Bridge.Int.mul(start,JuiceboxEngine.Graphics.SpriteBatcher.ELEMENTS_PER_TRIANGLE),fa=new Float32Array(length),i=0;i<length;i=i+1|0)fa[i]=this._vertexArray[startPos+i|0];this._command.VertexBuffer.UpdateData(fa,Bridge.Int.mul(start,JuiceboxEngine.Graphics.SpriteBatcher.ELEMENTS_PER_TRIANGLE));this._command.VertexBuffer.StartIndex=Bridge.Int.mul(start,3);this._command.VertexBuffer.VertexRange=Bridge.Int.mul(end-start|0,3);JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.WORLD,JuiceboxEngine.Math.Matrix4.Identity.$clone());JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.Command(this._command)},ExpandVertexArray:function(size){for(var newCount=this._vertexArray.length;Bridge.Int.mul(size,JuiceboxEngine.Graphics.SpriteBatcher.ELEMENTS_PER_SPRITE)>newCount;)newCount=newCount+6912|0;this._vertexArray=System.Array.init(newCount,0,System.Single)}}});Bridge.define("JuiceboxEngine.Graphics.SpriteBatchItem",{fields:{Texture2D:null,Depth:0,positionX:null,positionY:null,color:null,textureU:null,textureV:null},ctors:{init:function(){this.color=new JuiceboxEngine.Math.Color},ctor:function(){this.$initialize();this.positionX=System.Array.init(6,0,System.Single);this.positionY=System.Array.init(6,0,System.Single);this.textureU=System.Array.init(6,0,System.Single);this.textureV=System.Array.init(6,0,System.Single)}},methods:{Set:function(x,y,dx,dy,w,h,sin,cos,color,texCoordUL,texCoordLR){this.color=color.v.$clone();this.positionX[0]=x+dx*cos-(dy+h)*sin;this.positionY[0]=y+dx*sin+(dy+h)*cos;this.textureU[0]=texCoordUL.v.X;this.textureV[0]=texCoordUL.v.Y;this.positionX[1]=x+(dx+w)*cos-(dy+h)*sin;this.positionY[1]=y+(dx+w)*sin+(dy+h)*cos;this.textureU[1]=texCoordLR.v.X;this.textureV[1]=texCoordUL.v.Y;this.positionX[2]=x+(dx+w)*cos-dy*sin;this.positionY[2]=y+(dx+w)*sin+dy*cos;this.textureU[2]=texCoordLR.v.X;this.textureV[2]=texCoordLR.v.Y;this.positionX[3]=this.positionX[0];this.positionY[3]=this.positionY[0];this.textureU[3]=this.textureU[0];this.textureV[3]=this.textureV[0];this.positionX[4]=x+dx*cos-dy*sin;this.positionY[4]=y+dx*sin+dy*cos;this.textureU[4]=texCoordUL.v.X;this.textureV[4]=texCoordLR.v.Y;this.positionX[5]=this.positionX[2];this.positionY[5]=this.positionY[2];this.textureU[5]=this.textureU[2];this.textureV[5]=this.textureV[2]}}});Bridge.define("JuiceboxEngine.Graphics.Texture2D.SampleMode",{$kind:"nested enum",statics:{fields:{Point:0,Linear:1}}});Bridge.define("JuiceboxEngine.Graphics.Texture2D.WrapMode",{$kind:"nested enum",statics:{fields:{Clamp:0,Repeat:1,MirrorRepeat:2}}});Bridge.define("JuiceboxEngine.Graphics.Uniform",{statics:{methods:{GetType:function(obj){var type=JuiceboxEngine.Graphics.Uniform.UniformType.NONE,f,d,i,v2,v3,v4,c,m,t;do{if(Bridge.is(obj,System.Single)){f=Bridge.cast(obj,System.Single);type=JuiceboxEngine.Graphics.Uniform.UniformType.FLOAT;break}if(Bridge.is(obj,System.Double)){d=Bridge.cast(obj,System.Double);type=JuiceboxEngine.Graphics.Uniform.UniformType.DOUBLE;break}if(Bridge.is(obj,System.Int32)){i=Bridge.cast(obj,System.Int32);type=JuiceboxEngine.Graphics.Uniform.UniformType.INT;break}if(Bridge.is(obj,JuiceboxEngine.Math.Vector2)){v2=Bridge.cast(obj,JuiceboxEngine.Math.Vector2);type=JuiceboxEngine.Graphics.Uniform.UniformType.VECTOR2;break}if(Bridge.is(obj,JuiceboxEngine.Math.Vector3)){v3=Bridge.cast(obj,JuiceboxEngine.Math.Vector3);type=JuiceboxEngine.Graphics.Uniform.UniformType.VECTOR3;break}if(Bridge.is(obj,JuiceboxEngine.Math.Vector4)){v4=Bridge.cast(obj,JuiceboxEngine.Math.Vector4);type=JuiceboxEngine.Graphics.Uniform.UniformType.VECTOR4;break}if(Bridge.is(obj,JuiceboxEngine.Math.Color)){c=Bridge.cast(obj,JuiceboxEngine.Math.Color);type=JuiceboxEngine.Graphics.Uniform.UniformType.COLOR;break}if(Bridge.is(obj,JuiceboxEngine.Math.Matrix4)){m=Bridge.cast(obj,JuiceboxEngine.Math.Matrix4);type=JuiceboxEngine.Graphics.Uniform.UniformType.MATRIX4;break}if(Bridge.is(obj,JuiceboxEngine.Graphics.Texture2D)){t=Bridge.cast(obj,JuiceboxEngine.Graphics.Texture2D);type=Bridge.is(t,JuiceboxEngine.Graphics.RenderTarget)?JuiceboxEngine.Graphics.Uniform.UniformType.RENDERTARGET:JuiceboxEngine.Graphics.Uniform.UniformType.TEXTURE2D;break}}while(0);return type}}},fields:{name:null,value:null,type:0},ctors:{$ctor1:function(name,value,type){this.$initialize();this.name=name;this.value=value;this.type=type},ctor:function(name,value){this.$initialize();this.name=name;this.value=value;this.type=JuiceboxEngine.Graphics.Uniform.GetType(value)}}});Bridge.define("JuiceboxEngine.Graphics.Uniform.UniformType",{$kind:"nested enum",statics:{fields:{NONE:0,FLOAT:1,DOUBLE:2,INT:3,VECTOR2:4,VECTOR3:5,VECTOR4:6,COLOR:7,MATRIX4:8,TEXTURE2D:9,RENDERTARGET:10}}});Bridge.define("JuiceboxEngine.Graphics.VertexAttribute",{$kind:"struct",statics:{methods:{getDefaultValue:function(){return new JuiceboxEngine.Graphics.VertexAttribute}}},fields:{Name:null,Components:0,Normalize:!1,Stride:0,Offset:0},ctors:{$ctor1:function(name,components,normalize,stride,offset){this.$initialize();this.Name=name;this.Components=components;this.Normalize=normalize;this.Stride=stride;this.Offset=offset},ctor:function(){this.$initialize()}},methods:{getHashCode:function(){return Bridge.addHash([5561828516,this.Name,this.Components,this.Normalize,this.Stride,this.Offset])},equals:function(o){return Bridge.is(o,JuiceboxEngine.Graphics.VertexAttribute)?Bridge.equals(this.Name,o.Name)&&Bridge.equals(this.Components,o.Components)&&Bridge.equals(this.Normalize,o.Normalize)&&Bridge.equals(this.Stride,o.Stride)&&Bridge.equals(this.Offset,o.Offset):!1},$clone:function(to){var s=to||new JuiceboxEngine.Graphics.VertexAttribute;return s.Name=this.Name,s.Components=this.Components,s.Normalize=this.Normalize,s.Stride=this.Stride,s.Offset=this.Offset,s}}});Bridge.define("JuiceboxEngine.Graphics.VertexBuffer",{fields:{_data:null,_context:null,Buffer:null,Attributes:null,VertCount:0,StartIndex:0,VertexRange:0,_stride:0},ctors:{ctor:function(){this.$initialize();this._context=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context;this.VertCount=0;this.StartIndex=0;this.VertexRange=0;this._stride=0;this.Attributes=new(System.Collections.Generic.List$1(JuiceboxEngine.Graphics.VertexAttribute).ctor)},$ctor1:function(data){JuiceboxEngine.Graphics.VertexBuffer.ctor.call(this);this._data=data;this.UpdateData(data)}},methods:{SetAttribute:function(attribute){this.Attributes.add(attribute);this._stride=attribute.Stride;this._data!=null&&(this.VertCount=this.CalculateVertexCount(this._data.length))},CalculateVertexCount:function(length){return this.Attributes.Count===0?0:Bridge.Int.div(length,Bridge.Int.div(this._stride,4)|0)|0},UpdateData:function(data,offset){if(offset===void 0&&(offset=0),this.Buffer==null)this.Buffer=this._context.CreateVertexBuffer(data),this._data=data;else if(this.CalculateVertexCount(data.length+offset|0)>this.VertCount){this._context.DeleteBuffer(this.Buffer);var newBuffer=new Float32Array(offset+data.length|0);newBuffer.set(this._data,0);newBuffer.set(data,offset);this.Buffer=this._context.CreateVertexBuffer(newBuffer);this._data=newBuffer}else this._context.UpdateVertexBufferData(this,offset,data),this._data.set(data,offset);this.VertCount=this.CalculateVertexCount(this._data.length)},Destroy:function(){this._context.DeleteBuffer(this.Buffer)}}});Bridge.define("JuiceboxEngine.Graphics.VerticalAlignment",{$kind:"enum",statics:{fields:{TOP:0,CENTER:1,BOTTOM:2}}});Bridge.define("JuiceboxEngine.GUI.UIElement",{fields:{Enabled:!1,World:null,Parent:null,Children:null,ShowDebugBounds:!1,InputType:0,_command:null,_isDirty:!1,_hovered:!1,_resourceManager:null,_rotation:0,_pivot:null,_position:null,_anchor:null,_dimensions:null,_color:null,_bounds:null},events:{OnMouseDown:null,OnMouseUp:null,OnMouseHeld:null,OnMouseStay:null,OnMouseEnter:null,OnMouseExit:null},props:{Position:{get:function(){return this._position.$clone()},set:function(value){this._position=value.$clone();this.UpdatePosition()}},Rotation:{get:function(){return this._rotation},set:function(value){this._rotation=value;this.UpdatePosition()}},AbsolutePosition:{get:function(){return this.Parent==null?this.Position.$clone():JuiceboxEngine.Math.Vector2.op_Subtraction(JuiceboxEngine.Math.Vector2.op_Addition(JuiceboxEngine.Math.Vector2.op_Addition(this.Position.$clone(),this.Parent.AbsolutePosition.$clone()),JuiceboxEngine.Math.Vector2.op_Multiply(this.Anchor.$clone(),this.Parent.Dimensions.$clone())),JuiceboxEngine.Math.Vector2.op_Multiply(this.Pivot.$clone(),this.Dimensions.$clone()))}},Pivot:{get:function(){return this._pivot.$clone()},set:function(value){this._pivot=value.$clone();this.UpdatePosition()}},Anchor:{get:function(){return this._anchor.$clone()},set:function(value){this._anchor=value.$clone();this.UpdatePosition()}},Color:{get:function(){return this._color.$clone()},set:function(value){this._color=value.$clone();this.ForceUpdate()}},Dimensions:{get:function(){return this._dimensions.$clone()},set:function(value){this._dimensions=value.$clone();this.ForceUpdate()}},RootElement:{get:function(){return this.Parent==null?this:this.Parent.RootElement}},Bounds:{get:function(){return this._bounds.$clone()}},ResourceManager:{get:function(){return this._resourceManager==null?this.Parent.ResourceManager:this._resourceManager},set:function(value){this._resourceManager=value}}},ctors:{init:function(){this.World=new JuiceboxEngine.Math.Matrix4;this._pivot=new JuiceboxEngine.Math.Vector2;this._position=new JuiceboxEngine.Math.Vector2;this._anchor=new JuiceboxEngine.Math.Vector2;this._dimensions=new JuiceboxEngine.Math.Vector2;this._color=new JuiceboxEngine.Math.Color;this._bounds=new JuiceboxEngine.Math.RectangleF},ctor:function(parent){JuiceboxEngine.GUI.UIElement.$ctor1.call(this,parent,null)},$ctor1:function(parent,resourceManager){this.$initialize();this.Parent=parent;this._resourceManager=resourceManager;this._hovered=!1;this._isDirty=!0;parent!=null&&parent.Children.add(this);this.Children=new(System.Collections.Generic.List$1(JuiceboxEngine.GUI.UIElement).ctor);this._command=new JuiceboxEngine.Graphics.GraphicsCommand;this.Color=new JuiceboxEngine.Math.Color.$ctor3(1,1,1,1);this._command.Program=this.ResourceManager.Load(JuiceboxEngine.Graphics.ShaderProgram,"Shaders/Sprite.vert");this._command.VertexBuffer=new JuiceboxEngine.Graphics.VertexBuffer.ctor;this._command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_pos",3,!1,36,0));this._command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_tex",2,!1,36,12));this._command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_col",4,!1,36,20));this.Enabled=!0;this.ShowDebugBounds=!1;this.InputType=JuiceboxEngine.GUI.UIInput.ALL}},methods:{HandleMouse:function(position){var i,child,focused,absolutePos,mouseEvent;if(!this.Enabled||this.InputType===JuiceboxEngine.GUI.UIInput.NONE)return null;if((this.InputType&1)==1)for(i=this.Children.Count-1|0;i>=0;i=i-1|0)if(child=this.Children.getItem(i),focused=child.HandleMouse(position.$clone()),focused!=null)return focused;return(this.InputType&2)!=2?null:(absolutePos=this.AbsolutePosition.$clone(),mouseEvent=new JuiceboxEngine.GUI.UIMouseEvent(this,JuiceboxEngine.Math.Vector2.op_Subtraction(position.$clone(),absolutePos.$clone())),position.X>absolutePos.X&&position.Y>absolutePos.Y&&position.X<absolutePos.X+this.Dimensions.X&&position.Y<absolutePos.Y+this.Dimensions.Y)?(this._hovered||(Bridge.staticEquals(this.OnMouseEnter,null)?null:this.OnMouseEnter(mouseEvent),this._hovered=!0),Bridge.staticEquals(this.OnMouseStay,null)?null:this.OnMouseStay(mouseEvent),JuiceboxEngine.Input.InputManager.Instance.MouseKeyHeld(JuiceboxEngine.Input.MouseKey.LeftMouse)&&(Bridge.staticEquals(this.OnMouseHeld,null)?null:this.OnMouseHeld(mouseEvent)),JuiceboxEngine.Input.InputManager.Instance.MouseKeyDown(JuiceboxEngine.Input.MouseKey.LeftMouse)&&(Bridge.staticEquals(this.OnMouseDown,null)?null:this.OnMouseDown(mouseEvent)),JuiceboxEngine.Input.InputManager.Instance.MouseKeyReleased(JuiceboxEngine.Input.MouseKey.LeftMouse)&&(Bridge.staticEquals(this.OnMouseUp,null)?null:this.OnMouseUp(mouseEvent)),this):null},LoseFocus:function(position){Bridge.staticEquals(this.OnMouseExit,null)?null:this.OnMouseExit(new JuiceboxEngine.GUI.UIMouseEvent(this,JuiceboxEngine.Math.Vector2.op_Subtraction(position.$clone(),this.AbsolutePosition.$clone())));this._hovered=!1},RemoveChild:function(element){this.Children.contains(element)&&this.Children.remove(element)},RenderElement:function(frustum){var updated,i;if(this.Enabled)for(updated=!1,this._isDirty&&(this.UpdateElement(),updated=!0,this._isDirty=!1),frustum.v.Intersects(this._bounds.$clone())&&(JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.WORLD,this.World.$clone()),this.Render()),this.ShowDebugBounds&&this.DrawDebuggingShapes(updated),i=0;i<this.Children.Count;i=i+1|0)this.Children.getItem(i).RenderElement(frustum)},DrawDebuggingShapes:function(fill){fill&&JuiceboxEngine.Debugging.DebugRenderer.InstanceGUI.DrawRectFilled(this._bounds.$clone(),JuiceboxEngine.Math.Color.Blue.$clone());JuiceboxEngine.Debugging.DebugRenderer.InstanceGUI.DrawRect(this._bounds.$clone(),JuiceboxEngine.Math.Color.Red.$clone(),1)},UpdatePosition:function(){var absolutePos=this.AbsolutePosition.$clone(),i,child;for(this.World=JuiceboxEngine.Math.Matrix4.CreateTranslation(new JuiceboxEngine.Math.Vector3.$ctor2(absolutePos.X,absolutePos.Y,0)),this.World=JuiceboxEngine.Math.Matrix4.Multiply(JuiceboxEngine.Math.Matrix4.CreateRotationZ(this._rotation),this.World.$clone()),this._bounds=new JuiceboxEngine.Math.RectangleF.$ctor2(absolutePos.X,absolutePos.Y,this.Dimensions.X,this.Dimensions.Y),i=0;i<this.Children.Count;i=i+1|0)child=this.Children.getItem(i),child.UpdatePosition()},ForceUpdate:function(){var i,child;for(this._isDirty=!0,this.UpdatePosition(),i=0;i<this.Children.Count;i=i+1|0)child=this.Children.getItem(i),child.ForceUpdate()}}});Bridge.define("JuiceboxEngine.GUI.TextAlignment",{$kind:"enum",statics:{fields:{Left:0,Center:1,Right:2}}});Bridge.define("JuiceboxEngine.GUI.UIDefaults",{statics:{fields:{BottomLeft:null,BottomCenter:null,BottomRight:null,CenterLeft:null,Centered:null,CenterRight:null,TopLeft:null,TopCenter:null,TopRight:null},ctors:{init:function(){this.BottomLeft=new JuiceboxEngine.Math.Vector2;this.BottomCenter=new JuiceboxEngine.Math.Vector2;this.BottomRight=new JuiceboxEngine.Math.Vector2;this.CenterLeft=new JuiceboxEngine.Math.Vector2;this.Centered=new JuiceboxEngine.Math.Vector2;this.CenterRight=new JuiceboxEngine.Math.Vector2;this.TopLeft=new JuiceboxEngine.Math.Vector2;this.TopCenter=new JuiceboxEngine.Math.Vector2;this.TopRight=new JuiceboxEngine.Math.Vector2;this.BottomLeft=new JuiceboxEngine.Math.Vector2.$ctor3(0,0);this.BottomCenter=new JuiceboxEngine.Math.Vector2.$ctor3(.5,0);this.BottomRight=new JuiceboxEngine.Math.Vector2.$ctor3(1,0);this.CenterLeft=new JuiceboxEngine.Math.Vector2.$ctor3(0,.5);this.Centered=new JuiceboxEngine.Math.Vector2.$ctor3(.5,.5);this.CenterRight=new JuiceboxEngine.Math.Vector2.$ctor3(1,.5);this.TopLeft=new JuiceboxEngine.Math.Vector2.$ctor3(0,1);this.TopCenter=new JuiceboxEngine.Math.Vector2.$ctor3(.5,1);this.TopRight=new JuiceboxEngine.Math.Vector2.$ctor3(1,1)}}}});Bridge.define("JuiceboxEngine.GUI.UIEvent",{fields:{element:null},ctors:{ctor:function(element){this.$initialize();this.element=element}}});Bridge.define("JuiceboxEngine.GUI.UIInput",{$kind:"enum",statics:{fields:{NONE:0,CHILDREN:1,SELF:2,ALL:3}}});Bridge.define("JuiceboxEngine.GUI.UserInterface",{fields:{Root:null,FocusedElement:null,_viewMatrix:null,_projMatrix:null},ctors:{init:function(){this._viewMatrix=new JuiceboxEngine.Math.Matrix4;this._projMatrix=new JuiceboxEngine.Math.Matrix4},ctor:function(resourceManager){this.$initialize();this._viewMatrix=new JuiceboxEngine.Math.Matrix4.$ctor1(1);this.Root=new JuiceboxEngine.GUI.EmptyUIElement.$ctor1(null,resourceManager);this.FocusedElement=this.Root;this.ResizeRoot(JuiceboxEngine.Graphics.GraphicsManager.Instance.Width,JuiceboxEngine.Graphics.GraphicsManager.Instance.Height);JuiceboxEngine.Graphics.GraphicsManager.Instance.addOnResize(Bridge.fn.cacheBind(this,this.ResizeRoot))}},methods:{ResizeRoot:function(width,height){this.Root.Position=new JuiceboxEngine.Math.Vector2.$ctor3((-width|0)/2,(-height|0)/2);this.Root.Dimensions=new JuiceboxEngine.Math.Vector2.$ctor3(width,height);this._projMatrix=JuiceboxEngine.Math.Matrix4.CreateOrthographic(width,height,0,1)},HandleMouse:function(position){var focused=this.Root.HandleMouse(JuiceboxEngine.Math.Vector2.op_Addition(position.$clone(),this.Root.Position.$clone()));this.FocusedElement==null||Bridge.referenceEquals(this.FocusedElement,focused)||this.FocusedElement.LoseFocus(JuiceboxEngine.Math.Vector2.op_Addition(position.$clone(),this.Root.Position.$clone()));this.FocusedElement=focused},RenderUserInterface:function(){var usedDepth=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.UsingDepth,rect;JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.UseDepth(!1);JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.VIEW,this._viewMatrix.$clone());JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.PROJ,this._projMatrix.$clone());rect={v:new JuiceboxEngine.Math.RectangleF.$ctor2(this.Root.Position.X,this.Root.Position.Y,this.Root.Dimensions.X,this.Root.Dimensions.Y)};this.Root.RenderElement(rect);JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.UseDepth(usedDepth)}}});Bridge.define("JuiceboxEngine.Input.InputManager",{statics:{fields:{Instance:null}},fields:{MousePosition:null,MouseDelta:null,_prevMousePos:null,KeyBoard:null,OnReleaseKeyboard:null,OnPressKeyboard:null,_leftClick:0,_rightClick:0,_middleClick:0,_canvas:null,InputString:null,InputIsTouch:!1,AnyKeyPressed:!1},ctors:{init:function(){this.MousePosition=new JuiceboxEngine.Math.Vector2;this.MouseDelta=new JuiceboxEngine.Math.Vector2;this._prevMousePos=new JuiceboxEngine.Math.Vector2},ctor:function(canvas){this.$initialize();JuiceboxEngine.Input.InputManager.Instance=this;this.AnyKeyPressed=!1;this.KeyBoard=new(System.Collections.Generic.Dictionary$2(System.String,System.Boolean).ctor);this.OnPressKeyboard=new(System.Collections.Generic.Dictionary$2(System.String,System.Boolean).ctor);this.OnReleaseKeyboard=new(System.Collections.Generic.Dictionary$2(System.String,System.Boolean).ctor);this.MousePosition=new JuiceboxEngine.Math.Vector2.$ctor3(.5,.5);this._canvas=canvas;this._canvas.addEventListener("mousemove",Bridge.fn.bind(this,function(x){this.UpdateMouse(x)}));this._canvas.addEventListener("mousedown",Bridge.fn.bind(this,function(x){this.MouseDown(x)}));this._canvas.addEventListener("mouseup",Bridge.fn.bind(this,function(x){this.MouseUp(x)}));this._canvas.addEventListener("touchstart",Bridge.fn.bind(this,function(x){this.TouchStart(x)}));this._canvas.addEventListener("touchmove",Bridge.fn.bind(this,function(x){this.TouchMove(x)}));this._canvas.addEventListener("touchcancel",Bridge.fn.bind(this,function(x){this.TouchEnd(x)}));this._canvas.addEventListener("touchleave",Bridge.fn.bind(this,function(x){this.TouchEnd(x)}));this._canvas.addEventListener("touchend",Bridge.fn.bind(this,function(x){this.TouchEnd(x)}));document.addEventListener("keydown",Bridge.fn.bind(this,function(x){this.KeyDown$1(x)}));document.addEventListener("keyup",Bridge.fn.bind(this,function(x){this.KeyUp(x)}))}},methods:{MouseKeyHeld:function(mouseKey){switch(mouseKey){case JuiceboxEngine.Input.MouseKey.LeftMouse:return this._leftClick===JuiceboxEngine.Input.MouseKeyStatus.Pressed||this._leftClick===JuiceboxEngine.Input.MouseKeyStatus.Down;case JuiceboxEngine.Input.MouseKey.RightMouse:return this._rightClick===JuiceboxEngine.Input.MouseKeyStatus.Pressed||this._rightClick===JuiceboxEngine.Input.MouseKeyStatus.Down;case JuiceboxEngine.Input.MouseKey.MiddleMouse:return this._middleClick===JuiceboxEngine.Input.MouseKeyStatus.Pressed||this._middleClick===JuiceboxEngine.Input.MouseKeyStatus.Down;default:return!1}},MouseKeyDown:function(mouseKey){switch(mouseKey){case JuiceboxEngine.Input.MouseKey.LeftMouse:return this._leftClick===JuiceboxEngine.Input.MouseKeyStatus.Pressed;case JuiceboxEngine.Input.MouseKey.RightMouse:return this._rightClick===JuiceboxEngine.Input.MouseKeyStatus.Pressed;case JuiceboxEngine.Input.MouseKey.MiddleMouse:return this._middleClick===JuiceboxEngine.Input.MouseKeyStatus.Pressed;default:return!1}},MouseKeyReleased:function(mouseKey){switch(mouseKey){case JuiceboxEngine.Input.MouseKey.LeftMouse:return this._leftClick===JuiceboxEngine.Input.MouseKeyStatus.Released;case JuiceboxEngine.Input.MouseKey.RightMouse:return this._rightClick===JuiceboxEngine.Input.MouseKeyStatus.Released;case JuiceboxEngine.Input.MouseKey.MiddleMouse:return this._middleClick===JuiceboxEngine.Input.MouseKeyStatus.Released;default:return!1}},UpdateInput:function(){var i,i1;for(this.InputString="",this.MouseDelta=JuiceboxEngine.Math.Vector2.op_Subtraction(this._prevMousePos.$clone(),this.MousePosition.$clone()),i=0;i<this.OnPressKeyboard.Keys.Count;i=i+1|0)this.OnPressKeyboard.setItem(System.Linq.Enumerable.from(this.OnPressKeyboard,System.Collections.Generic.KeyValuePair$2(System.String,System.Boolean)).elementAt(i).key,!1);for(i1=0;i1<this.OnReleaseKeyboard.Keys.Count;i1=i1+1|0)this.OnPressKeyboard.setItem(System.Linq.Enumerable.from(this.OnReleaseKeyboard,System.Collections.Generic.KeyValuePair$2(System.String,System.Boolean)).elementAt(i1).key,!1);this.AnyKeyPressed=!1;this._leftClick===JuiceboxEngine.Input.MouseKeyStatus.Pressed&&(this._leftClick=JuiceboxEngine.Input.MouseKeyStatus.Down);this._rightClick===JuiceboxEngine.Input.MouseKeyStatus.Pressed&&(this._rightClick=JuiceboxEngine.Input.MouseKeyStatus.Down);this._middleClick===JuiceboxEngine.Input.MouseKeyStatus.Pressed&&(this._middleClick=JuiceboxEngine.Input.MouseKeyStatus.Down);this._leftClick===JuiceboxEngine.Input.MouseKeyStatus.Released&&(this._leftClick=JuiceboxEngine.Input.MouseKeyStatus.None);this._rightClick===JuiceboxEngine.Input.MouseKeyStatus.Released&&(this._rightClick=JuiceboxEngine.Input.MouseKeyStatus.None);this._middleClick===JuiceboxEngine.Input.MouseKeyStatus.Released&&(this._middleClick=JuiceboxEngine.Input.MouseKeyStatus.None);this._prevMousePos=this.MousePosition.$clone()},KeyDown:function(key){return(key=key.toLowerCase(),!this.KeyBoard.containsKey(key))?!1:this.KeyBoard.getItem(key)},KeyDown$1:function(e){var ev=Bridge.as(e,KeyboardEvent),key;this.InputString=(this.InputString||"")+(ev.key||"");key=ev.key.toLowerCase();this.KeyDown(key)||(this.OnPressKeyboard.containsKey(key)?this.OnPressKeyboard.setItem(key,!0):this.OnPressKeyboard.add(key,!0));this.KeyBoard.containsKey(key)?this.KeyBoard.setItem(key,!0):this.KeyBoard.add(key,!0);this.AnyKeyPressed=!0},KeyPressed:function(key){return(key=key.toLowerCase(),!this.OnPressKeyboard.containsKey(key))?!1:this.OnPressKeyboard.getItem(key)},KeyReleased:function(key){return(key=key.toLowerCase(),!this.OnReleaseKeyboard.containsKey(key))?!1:this.OnReleaseKeyboard.getItem(key)},KeyUp:function(e){var ev=Bridge.as(e,KeyboardEvent),key=ev.key.toLowerCase();this.KeyBoard.containsKey(key)?this.KeyBoard.setItem(key,!1):this.KeyBoard.add(key,!1);this.OnReleaseKeyboard.containsKey(key)?this.OnReleaseKeyboard.setItem(key,!0):this.OnReleaseKeyboard.add(key,!0)},MouseDown:function(e){var ev=Bridge.as(e,MouseEvent);ev.button===0&&(this._leftClick=JuiceboxEngine.Input.MouseKeyStatus.Pressed);ev.button===2&&(this._rightClick=JuiceboxEngine.Input.MouseKeyStatus.Pressed);ev.button===1&&(this._middleClick=JuiceboxEngine.Input.MouseKeyStatus.Pressed);this.InputIsTouch=!1},MouseUp:function(e){var ev=Bridge.as(e,MouseEvent);ev.button===0&&(this._leftClick=JuiceboxEngine.Input.MouseKeyStatus.Released);ev.button===2&&(this._rightClick=JuiceboxEngine.Input.MouseKeyStatus.Released);ev.button===1&&(this._middleClick=JuiceboxEngine.Input.MouseKeyStatus.Released);this.InputIsTouch=!1},UpdateMouse:function(e){var rect=this._canvas.getBoundingClientRect(),ev=Bridge.as(e,MouseEvent),xPos=ev.clientX-Bridge.Int.clip32(rect.left)|0,yPos=Bridge.Int.clip32(rect.bottom)-ev.clientY|0;this.MousePosition=new JuiceboxEngine.Math.Vector2.$ctor3(xPos/JuiceboxEngine.Graphics.GraphicsManager.Instance.Width,yPos/JuiceboxEngine.Graphics.GraphicsManager.Instance.Height);this.InputIsTouch=!1},TouchStart:function(e){var rect=this._canvas.getBoundingClientRect(),ev=Bridge.as(e,TouchEvent),xPos,yPos;e.preventDefault();xPos=ev.touches[0].clientX-Bridge.Int.clip32(rect.left)|0;yPos=Bridge.Int.clip32(rect.bottom)-ev.touches[0].clientY|0;this.MousePosition=new JuiceboxEngine.Math.Vector2.$ctor3(xPos/JuiceboxEngine.Graphics.GraphicsManager.Instance.Width,yPos/JuiceboxEngine.Graphics.GraphicsManager.Instance.Height);this._leftClick=JuiceboxEngine.Input.MouseKeyStatus.Pressed;this.InputIsTouch=!0},TouchMove:function(e){var rect=this._canvas.getBoundingClientRect(),ev=Bridge.as(e,TouchEvent),xPos,yPos;e.preventDefault();xPos=ev.touches[0].clientX-Bridge.Int.clip32(rect.left)|0;yPos=Bridge.Int.clip32(rect.bottom)-ev.touches[0].clientY|0;this.MousePosition=new JuiceboxEngine.Math.Vector2.$ctor3(xPos/JuiceboxEngine.Graphics.GraphicsManager.Instance.Width,yPos/JuiceboxEngine.Graphics.GraphicsManager.Instance.Height);this._leftClick=JuiceboxEngine.Input.MouseKeyStatus.Down;this.InputIsTouch=!0},TouchEnd:function(e){var rect=this._canvas.getBoundingClientRect(),ev=Bridge.as(e,TouchEvent);e.preventDefault();this.MousePosition=new JuiceboxEngine.Math.Vector2.$ctor3(-1,-1);this._leftClick=JuiceboxEngine.Input.MouseKeyStatus.Released;this.InputIsTouch=!0}}});Bridge.define("JuiceboxEngine.Input.MouseKey",{$kind:"enum",statics:{fields:{LeftMouse:0,RightMouse:1,MiddleMouse:2}}});Bridge.define("JuiceboxEngine.Input.MouseKeyStatus",{$kind:"enum",statics:{fields:{None:0,Pressed:1,Down:2,Released:3}}});Bridge.define("JuiceboxEngine.JuiceboxGame",{statics:{methods:{IsClient:function(){return typeof document=="undefined"?!1:!0}}},fields:{ResourceManager:null,_preloader:null,_graphicsManager:null,_inputManager:null,_canvas:null,CurrentScene:null,Client:!1},ctors:{ctor:function(){if(this.$initialize(),this.Client=JuiceboxEngine.JuiceboxGame.IsClient(),this.Client){if(this._canvas=Bridge.as(document.getElementById("JuiceboxCanvas"),HTMLCanvasElement),this._canvas!=null)this._graphicsManager=new JuiceboxEngine.Graphics.GraphicsManager(this._canvas),this._canvas.addEventListener("webglcontextlost",function(){window.location.reload()}),JuiceboxEngine.Util.Config.ConfigValues.Fullscreen&&(this.Resize(),window.addEventListener("resize",Bridge.fn.bind(this,function(){this.Resize()}))),this._inputManager=new JuiceboxEngine.Input.InputManager(this._canvas);else{JuiceboxEngine.Logger.Error('No canvas with id "JuiceboxCanvas" found!');return}this.ResourceManager=new JuiceboxEngine.Resources.ResourceManager;this.RegisterLoaders(this.ResourceManager);this._preloader=new JuiceboxEngine.Resources.Preloader;this._preloader.Preload(this.ResourceManager,System.Array.init(["Textures/ScreenFade.png","Textures/JuiceboxIcon.png","Shaders/Debug.vert","Shaders/FullScreen.vert","Shaders/Sprite.vert","Shaders/TileMap.vert","Shaders/Mesh.vert","Fonts/Arial.bff"],System.String));JuiceboxEngine.SceneManager.Initialize(this);JuiceboxEngine.Audio.AudioManager.GlobalVolume(1)}}},methods:{Run:function(startScene){JuiceboxEngine.JuiceboxGame.IsClient()&&(this.CurrentScene=new JuiceboxEngine.SplashScene(this.ResourceManager,startScene),this.CurrentScene.Start(),this.EngineUpdate())},RegisterLoaders:function(resourceManager){this._graphicsManager.RegisterLoaders(resourceManager);resourceManager.RegisterResourceManager(new JuiceboxEngine.Audio.AudioLoader)},EngineUpdate:function(){JuiceboxEngine.Util.Time.UpdateTime();this._graphicsManager.Update();JuiceboxEngine.SceneManager.Update();this.CurrentScene.UpdateScene();this.CurrentScene.RenderScene();JuiceboxEngine.Coroutines.CoroutineManager.Update();this._inputManager.UpdateInput();window.requestAnimationFrame(Bridge.fn.bind(this,function(){this.EngineUpdate()}))},Resize:function(){var ratio=Bridge.cast(window.devicePixelRatio,System.Double),dpr=Bridge.Int.clip32(ratio);JuiceboxEngine.Logger.Log("Device Pixel Ratio: "+System.Double.format(ratio));this._canvas.width=Bridge.Int.mul(window.innerWidth,dpr);this._canvas.height=Bridge.Int.mul(window.innerHeight,dpr);this._canvas.style.width="100%";this._canvas.style.height="100%";JuiceboxEngine.Graphics.GraphicsManager.Instance.Resize(Bridge.Int.div(this._canvas.width,dpr)|0,Bridge.Int.div(this._canvas.height,dpr)|0,dpr)}}});Bridge.define("JuiceboxEngine.Logger",{statics:{fields:{_log:null,LogToConsole:!1},ctors:{ctor:function(){JuiceboxEngine.Logger._log=new(System.Collections.Generic.List$1(System.String).ctor)}},methods:{CreateLog:function(msg,type){return System.String.format("[{0}]({1}){2}",System.DateTime.format(JuiceboxEngine.Util.Time.CurDateTime),type,msg)},Log:function(msg){var log=JuiceboxEngine.Logger.CreateLog(msg,"LOG");JuiceboxEngine.Logger.LogToConsole&&Bridge.Console.log(log);JuiceboxEngine.Logger._log.add(log)},Error:function(msg){var error=JuiceboxEngine.Logger.CreateLog(msg,"ERROR");JuiceboxEngine.Logger.LogToConsole&&Bridge.Console.error(error);JuiceboxEngine.Logger._log.add(error)},Warn:function(msg){var warning=JuiceboxEngine.Logger.CreateLog(msg,"WARN");JuiceboxEngine.Logger.LogToConsole&&Bridge.Console.log(warning);JuiceboxEngine.Logger._log.add(warning)},GetLog:function(){var $t,builder=new System.Text.StringBuilder,line;$t=Bridge.getEnumerator(JuiceboxEngine.Logger._log);try{while($t.moveNext())line=$t.Current,builder.appendLine(line)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return builder.toString()}}}});Bridge.define("JuiceboxEngine.Math.Color",{inherits:function(){return[System.IEquatable$1(JuiceboxEngine.Math.Color)]},$kind:"struct",statics:{fields:{Red:null,Green:null,Blue:null,White:null,Black:null},ctors:{init:function(){this.Red=new JuiceboxEngine.Math.Color;this.Green=new JuiceboxEngine.Math.Color;this.Blue=new JuiceboxEngine.Math.Color;this.White=new JuiceboxEngine.Math.Color;this.Black=new JuiceboxEngine.Math.Color;this.Red=new JuiceboxEngine.Math.Color.$ctor2(255,0,0,255);this.Green=new JuiceboxEngine.Math.Color.$ctor2(0,255,0,255);this.Blue=new JuiceboxEngine.Math.Color.$ctor2(0,0,255,255);this.White=new JuiceboxEngine.Math.Color.$ctor2(255,255,255,255);this.Black=new JuiceboxEngine.Math.Color.$ctor2(0,0,0,255)}},methods:{Interpolate:function(min,max,gradient){return new JuiceboxEngine.Math.Color.$ctor3(JuiceboxEngine.Math.JMath.Interpolate(min.R,max.R,gradient),JuiceboxEngine.Math.JMath.Interpolate(min.G,max.G,gradient),JuiceboxEngine.Math.JMath.Interpolate(min.B,max.B,gradient),JuiceboxEngine.Math.JMath.Interpolate(min.A,max.A,gradient))},FromHSL:function(h,sl,l){var v,r=1,g=1,b=1,m,sv,sextant,fract,vsf,mid1,mid2;if(v=l<=.5?l*(1+sl):l+sl-l*sl,v>0){m=l+l-v;sv=(v-m)/v;h*=6;sextant=Bridge.Int.clip32(h);fract=h-sextant;vsf=v*sv*fract;mid1=m+vsf;mid2=v-vsf;switch(sextant){case 0:r=v;g=mid1;b=m;break;case 1:r=mid2;g=v;b=m;break;case 2:r=m;g=v;b=mid1;break;case 3:r=m;g=mid2;b=v;break;case 4:r=mid1;g=m;b=v;break;case 5:r=v;g=m;b=mid2;break}}return new JuiceboxEngine.Math.Color.$ctor3(r,g,b,1)},op_Equality:function(color1,color2){return color1.equalsT(color2.$clone())},op_Inequality:function(color1,color2){return!color1.equalsT(color2.$clone())},getDefaultValue:function(){return new JuiceboxEngine.Math.Color}}},fields:{R:0,G:0,B:0,A:0},alias:["equalsT","System$IEquatable$1$JuiceboxEngine$Math$Color$equalsT"],ctors:{$ctor3:function(r,g,b,a){this.$initialize();this.R=r;this.G=g;this.B=b;this.A=a},$ctor2:function(r,g,b,a){this.$initialize();this.R=r/255;this.G=g/255;this.B=b/255;this.A=a/255},$ctor1:function(r,g,b,a){this.$initialize();this.R=r/255;this.G=g/255;this.B=b/255;this.A=a/255},ctor:function(){this.$initialize()}},methods:{equals:function(obj){return Bridge.is(obj,JuiceboxEngine.Math.Color)&&this.equalsT(Bridge.cast(obj,JuiceboxEngine.Math.Color))},equalsT:function(other){return this.R===other.R&&this.G===other.G&&this.B===other.B&&this.A===other.A},getHashCode:function(){var hashCode=1960784236;return hashCode=Bridge.Int.mul(hashCode,-1521134295)+System.Single.getHashCode(this.R)|0,hashCode=Bridge.Int.mul(hashCode,-1521134295)+System.Single.getHashCode(this.G)|0,hashCode=Bridge.Int.mul(hashCode,-1521134295)+System.Single.getHashCode(this.B)|0,Bridge.Int.mul(hashCode,-1521134295)+System.Single.getHashCode(this.A)|0},toString:function(){return System.String.format("Color({0}, {1}, {2}, {3})",this.R,this.G,this.B,this.A)},$clone:function(to){var s=to||new JuiceboxEngine.Math.Color;return s.R=this.R,s.G=this.G,s.B=this.B,s.A=this.A,s}}});Bridge.define("JuiceboxEngine.Math.Easings",{statics:{fields:{PI:0,HALFPI:0},ctors:{init:function(){this.PI=3.14159274;this.HALFPI=1.57079637}},methods:{Interpolate:function(p,$function){switch($function){default:case JuiceboxEngine.Math.Easings.Functions.Linear:return JuiceboxEngine.Math.Easings.Linear(p);case JuiceboxEngine.Math.Easings.Functions.QuadraticEaseOut:return JuiceboxEngine.Math.Easings.QuadraticEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.QuadraticEaseIn:return JuiceboxEngine.Math.Easings.QuadraticEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.QuadraticEaseInOut:return JuiceboxEngine.Math.Easings.QuadraticEaseInOut(p);case JuiceboxEngine.Math.Easings.Functions.CubicEaseIn:return JuiceboxEngine.Math.Easings.CubicEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.CubicEaseOut:return JuiceboxEngine.Math.Easings.CubicEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.CubicEaseInOut:return JuiceboxEngine.Math.Easings.CubicEaseInOut(p);case JuiceboxEngine.Math.Easings.Functions.QuarticEaseIn:return JuiceboxEngine.Math.Easings.QuarticEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.QuarticEaseOut:return JuiceboxEngine.Math.Easings.QuarticEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.QuarticEaseInOut:return JuiceboxEngine.Math.Easings.QuarticEaseInOut(p);case JuiceboxEngine.Math.Easings.Functions.QuinticEaseIn:return JuiceboxEngine.Math.Easings.QuinticEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.QuinticEaseOut:return JuiceboxEngine.Math.Easings.QuinticEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.QuinticEaseInOut:return JuiceboxEngine.Math.Easings.QuinticEaseInOut(p);case JuiceboxEngine.Math.Easings.Functions.SineEaseIn:return JuiceboxEngine.Math.Easings.SineEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.SineEaseOut:return JuiceboxEngine.Math.Easings.SineEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.SineEaseInOut:return JuiceboxEngine.Math.Easings.SineEaseInOut(p);case JuiceboxEngine.Math.Easings.Functions.CircularEaseIn:return JuiceboxEngine.Math.Easings.CircularEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.CircularEaseOut:return JuiceboxEngine.Math.Easings.CircularEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.CircularEaseInOut:return JuiceboxEngine.Math.Easings.CircularEaseInOut(p);case JuiceboxEngine.Math.Easings.Functions.ExponentialEaseIn:return JuiceboxEngine.Math.Easings.ExponentialEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.ExponentialEaseOut:return JuiceboxEngine.Math.Easings.ExponentialEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.ExponentialEaseInOut:return JuiceboxEngine.Math.Easings.ExponentialEaseInOut(p);case JuiceboxEngine.Math.Easings.Functions.ElasticEaseIn:return JuiceboxEngine.Math.Easings.ElasticEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.ElasticEaseOut:return JuiceboxEngine.Math.Easings.ElasticEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.ElasticEaseInOut:return JuiceboxEngine.Math.Easings.ElasticEaseInOut(p);case JuiceboxEngine.Math.Easings.Functions.BackEaseIn:return JuiceboxEngine.Math.Easings.BackEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.BackEaseOut:return JuiceboxEngine.Math.Easings.BackEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.BackEaseInOut:return JuiceboxEngine.Math.Easings.BackEaseInOut(p);case JuiceboxEngine.Math.Easings.Functions.BounceEaseIn:return JuiceboxEngine.Math.Easings.BounceEaseIn(p);case JuiceboxEngine.Math.Easings.Functions.BounceEaseOut:return JuiceboxEngine.Math.Easings.BounceEaseOut(p);case JuiceboxEngine.Math.Easings.Functions.BounceEaseInOut:return JuiceboxEngine.Math.Easings.BounceEaseInOut(p)}},Linear:function(p){return p},QuadraticEaseIn:function(p){return p*p},QuadraticEaseOut:function(p){return-(p*(p-2))},QuadraticEaseInOut:function(p){return p<.5?2*p*p:-2*p*p+4*p-1},CubicEaseIn:function(p){return p*p*p},CubicEaseOut:function(p){var f=p-1;return f*f*f+1},CubicEaseInOut:function(p){if(p<.5)return 4*p*p*p;else{var f=2*p-2;return.5*f*f*f+1}},QuarticEaseIn:function(p){return p*p*p*p},QuarticEaseOut:function(p){var f=p-1;return f*f*f*(1-p)+1},QuarticEaseInOut:function(p){if(p<.5)return 8*p*p*p*p;else{var f=p-1;return-8*f*f*f*f+1}},QuinticEaseIn:function(p){return p*p*p*p*p},QuinticEaseOut:function(p){var f=p-1;return f*f*f*f*f+1},QuinticEaseInOut:function(p){if(p<.5)return 16*p*p*p*p*p;else{var f=2*p-2;return.5*f*f*f*f*f+1}},SineEaseIn:function(p){return JuiceboxEngine.Math.JMath.Sin((p-1)*JuiceboxEngine.Math.Easings.HALFPI)+1},SineEaseOut:function(p){return JuiceboxEngine.Math.JMath.Sin(p*JuiceboxEngine.Math.Easings.HALFPI)},SineEaseInOut:function(p){return.5*(1-JuiceboxEngine.Math.JMath.Cos(p*JuiceboxEngine.Math.Easings.PI))},CircularEaseIn:function(p){return 1-JuiceboxEngine.Math.JMath.Sqrt(1-p*p)},CircularEaseOut:function(p){return JuiceboxEngine.Math.JMath.Sqrt((2-p)*p)},CircularEaseInOut:function(p){return p<.5?.5*(1-JuiceboxEngine.Math.JMath.Sqrt(1-4*p*p)):.5*(JuiceboxEngine.Math.JMath.Sqrt(-(2*p-3)*(2*p-1))+1)},ExponentialEaseIn:function(p){return p===0?p:JuiceboxEngine.Math.JMath.Pow(2,10*(p-1))},ExponentialEaseOut:function(p){return p===1?p:1-JuiceboxEngine.Math.JMath.Pow(2,-10*p)},ExponentialEaseInOut:function(p){return p===0||p===1?p:p<.5?.5*JuiceboxEngine.Math.JMath.Pow(2,20*p-10):-.5*JuiceboxEngine.Math.JMath.Pow(2,-20*p+10)+1},ElasticEaseIn:function(p){return JuiceboxEngine.Math.JMath.Sin(20.4203529*p)*JuiceboxEngine.Math.JMath.Pow(2,10*(p-1))},ElasticEaseOut:function(p){return JuiceboxEngine.Math.JMath.Sin(-20.4203529*(p+1))*JuiceboxEngine.Math.JMath.Pow(2,-10*p)+1},ElasticEaseInOut:function(p){return p<.5?.5*JuiceboxEngine.Math.JMath.Sin(20.4203529*2*p)*JuiceboxEngine.Math.JMath.Pow(2,10*(2*p-1)):.5*(JuiceboxEngine.Math.JMath.Sin(-20.4203529*(2*p-0))*JuiceboxEngine.Math.JMath.Pow(2,-10*(2*p-1))+2)},BackEaseIn:function(p){return p*p*p-p*JuiceboxEngine.Math.JMath.Sin(p*JuiceboxEngine.Math.Easings.PI)},BackEaseOut:function(p){var f=1-p;return 1-(f*f*f-f*JuiceboxEngine.Math.JMath.Sin(f*JuiceboxEngine.Math.Easings.PI))},BackEaseInOut:function(p){var f,f1;return p<.5?(f=2*p,.5*(f*f*f-f*JuiceboxEngine.Math.JMath.Sin(f*JuiceboxEngine.Math.Easings.PI))):(f1=2-2*p,.5*(1-(f1*f1*f1-f1*JuiceboxEngine.Math.JMath.Sin(f1*JuiceboxEngine.Math.Easings.PI)))+.5)},BounceEaseIn:function(p){return 1-JuiceboxEngine.Math.Easings.BounceEaseOut(1-p)},BounceEaseOut:function(p){return p<.363636374?121*p*p/16:p<.727272749?9.075*p*p-9.9*p+3.4:p<.9?12.0664816*p*p-19.635458*p+8.898061:10.8*p*p-20.52*p+10.72},BounceEaseInOut:function(p){return p<.5?.5*JuiceboxEngine.Math.Easings.BounceEaseIn(p*2):.5*JuiceboxEngine.Math.Easings.BounceEaseOut(p*2-1)+.5}}}});Bridge.define("JuiceboxEngine.Math.Easings.Functions",{$kind:"nested enum",statics:{fields:{Linear:0,QuadraticEaseIn:1,QuadraticEaseOut:2,QuadraticEaseInOut:3,CubicEaseIn:4,CubicEaseOut:5,CubicEaseInOut:6,QuarticEaseIn:7,QuarticEaseOut:8,QuarticEaseInOut:9,QuinticEaseIn:10,QuinticEaseOut:11,QuinticEaseInOut:12,SineEaseIn:13,SineEaseOut:14,SineEaseInOut:15,CircularEaseIn:16,CircularEaseOut:17,CircularEaseInOut:18,ExponentialEaseIn:19,ExponentialEaseOut:20,ExponentialEaseInOut:21,ElasticEaseIn:22,ElasticEaseOut:23,ElasticEaseInOut:24,BackEaseIn:25,BackEaseOut:26,BackEaseInOut:27,BounceEaseIn:28,BounceEaseOut:29,BounceEaseInOut:30}}});Bridge.define("JuiceboxEngine.Math.JMath",{statics:{fields:{PI:0,PI_OVER_TWO:0,PI_OVER_FOUR:0,TWO_PI:0},ctors:{init:function(){this.PI=3.14159274;this.PI_OVER_TWO=1.57079637;this.PI_OVER_FOUR=.7853982;this.TWO_PI=6.28318548}},methods:{Sqrt:function(value){return Math.sqrt(value)},Pow:function(b,p){return Math.pow(b,p)},Sin:function(value){return Math.sin(value)},Cos:function(value){return Math.cos(value)},Tan:function(value){return Math.tan(value)},ACos:function(value){return Math.acos(value)},ATan:function(value){return Math.atan(value)},ATan2:function(x,y){return Math.atan2(x,y)},Abs:function(value){return value<0&&(value=-value),value},Round:function(value){return Bridge.Math.round(value,0,6)},Ceiling:function(value){return Math.ceil(value)},Floor:function(value){return Math.floor(value)},PingPong:function(t,length){var l=2*length,T=t%l;return 0<=T&&T<length?T:l-T},Clamp$1:function(value,min,max){return Math.max(min,Math.min(value,max))},Clamp:function(value,min,max){return Math.max(min,Math.min(value,max))},Interpolate:function(min,max,gradient){return min+(max-min)*JuiceboxEngine.Math.JMath.Clamp$1(gradient,0,1)},Wrap:function(value,max,min){if(min===void 0&&(min=0),value-=min,max-=min,max===0)return min;for(value=value%max,value+=min;value<min;)value+=max;return value},Max:function(x,y){return x>y?x:y},Max$1:function(x,y){return x>y?x:y},Min:function(x,y){return x<y?x:y},Min$1:function(x,y){return x<y?x:y},Log:function(x){return Bridge.Math.log(x)}}}});Bridge.define("JuiceboxEngine.Math.Matrix4",{$kind:"struct",statics:{fields:{Identity:null},ctors:{init:function(){this.Identity=new JuiceboxEngine.Math.Matrix4;this.Identity=new JuiceboxEngine.Math.Matrix4.$ctor2(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}},methods:{Transpose:function(matrix){var mat=new JuiceboxEngine.Math.Matrix4.ctor;return mat.M11=matrix.M11,mat.M12=matrix.M21,mat.M13=matrix.M31,mat.M14=matrix.M41,mat.M21=matrix.M12,mat.M22=matrix.M22,mat.M23=matrix.M32,mat.M24=matrix.M42,mat.M31=matrix.M13,mat.M32=matrix.M23,mat.M33=matrix.M33,mat.M34=matrix.M43,mat.M41=matrix.M14,mat.M42=matrix.M24,mat.M43=matrix.M34,mat.M44=matrix.M44,mat.$clone()},Add:function(matrix1,matrix2){return matrix1.M11+=matrix2.M11,matrix1.M12+=matrix2.M12,matrix1.M13+=matrix2.M13,matrix1.M14+=matrix2.M14,matrix1.M21+=matrix2.M21,matrix1.M22+=matrix2.M22,matrix1.M23+=matrix2.M23,matrix1.M24+=matrix2.M24,matrix1.M31+=matrix2.M31,matrix1.M32+=matrix2.M32,matrix1.M33+=matrix2.M33,matrix1.M34+=matrix2.M34,matrix1.M41+=matrix2.M41,matrix1.M42+=matrix2.M42,matrix1.M43+=matrix2.M43,matrix1.M44+=matrix2.M44,matrix1.$clone()},Multiply:function(matrix1,matrix2){var m11=matrix1.M11*matrix2.M11+matrix1.M12*matrix2.M21+matrix1.M13*matrix2.M31+matrix1.M14*matrix2.M41,m12=matrix1.M11*matrix2.M12+matrix1.M12*matrix2.M22+matrix1.M13*matrix2.M32+matrix1.M14*matrix2.M42,m13=matrix1.M11*matrix2.M13+matrix1.M12*matrix2.M23+matrix1.M13*matrix2.M33+matrix1.M14*matrix2.M43,m14=matrix1.M11*matrix2.M14+matrix1.M12*matrix2.M24+matrix1.M13*matrix2.M34+matrix1.M14*matrix2.M44,m21=matrix1.M21*matrix2.M11+matrix1.M22*matrix2.M21+matrix1.M23*matrix2.M31+matrix1.M24*matrix2.M41,m22=matrix1.M21*matrix2.M12+matrix1.M22*matrix2.M22+matrix1.M23*matrix2.M32+matrix1.M24*matrix2.M42,m23=matrix1.M21*matrix2.M13+matrix1.M22*matrix2.M23+matrix1.M23*matrix2.M33+matrix1.M24*matrix2.M43,m24=matrix1.M21*matrix2.M14+matrix1.M22*matrix2.M24+matrix1.M23*matrix2.M34+matrix1.M24*matrix2.M44,m31=matrix1.M31*matrix2.M11+matrix1.M32*matrix2.M21+matrix1.M33*matrix2.M31+matrix1.M34*matrix2.M41,m32=matrix1.M31*matrix2.M12+matrix1.M32*matrix2.M22+matrix1.M33*matrix2.M32+matrix1.M34*matrix2.M42,m33=matrix1.M31*matrix2.M13+matrix1.M32*matrix2.M23+matrix1.M33*matrix2.M33+matrix1.M34*matrix2.M43,m34=matrix1.M31*matrix2.M14+matrix1.M32*matrix2.M24+matrix1.M33*matrix2.M34+matrix1.M34*matrix2.M44,m41=matrix1.M41*matrix2.M11+matrix1.M42*matrix2.M21+matrix1.M43*matrix2.M31+matrix1.M44*matrix2.M41,m42=matrix1.M41*matrix2.M12+matrix1.M42*matrix2.M22+matrix1.M43*matrix2.M32+matrix1.M44*matrix2.M42,m43=matrix1.M41*matrix2.M13+matrix1.M42*matrix2.M23+matrix1.M43*matrix2.M33+matrix1.M44*matrix2.M43,m44=matrix1.M41*matrix2.M14+matrix1.M42*matrix2.M24+matrix1.M43*matrix2.M34+matrix1.M44*matrix2.M44;return matrix1.M11=m11,matrix1.M12=m12,matrix1.M13=m13,matrix1.M14=m14,matrix1.M21=m21,matrix1.M22=m22,matrix1.M23=m23,matrix1.M24=m24,matrix1.M31=m31,matrix1.M32=m32,matrix1.M33=m33,matrix1.M34=m34,matrix1.M41=m41,matrix1.M42=m42,matrix1.M43=m43,matrix1.M44=m44,matrix1.$clone()},CreateFromAxisAngle:function(axis,angle){var result=new JuiceboxEngine.Math.Matrix4,x=axis.X,y=axis.Y,z=axis.Z,num2=JuiceboxEngine.Math.JMath.Sin(angle),num=JuiceboxEngine.Math.JMath.Cos(angle),num11=x*x,num10=y*y,num9=z*z,num8=x*y,num7=x*z,num6=y*z;return result.M11=num11+num*(1-num11),result.M12=num8-num*num8+num2*z,result.M13=num7-num*num7-num2*y,result.M14=0,result.M21=num8-num*num8-num2*z,result.M22=num10+num*(1-num10),result.M23=num6-num*num6+num2*x,result.M24=0,result.M31=num7-num*num7+num2*y,result.M32=num6-num*num6-num2*x,result.M33=num9+num*(1-num9),result.M34=0,result.M41=0,result.M42=0,result.M43=0,result.M44=1,result.$clone()},CreateLookAt:function(cameraPosition,cameraTarget,cameraUpVector){var matrix=new JuiceboxEngine.Math.Matrix4.ctor,vector=JuiceboxEngine.Math.Vector3.Normalize(JuiceboxEngine.Math.Vector3.op_Subtraction(cameraPosition.$clone(),cameraTarget.$clone())),vector2=JuiceboxEngine.Math.Vector3.Normalize(JuiceboxEngine.Math.Vector3.Cross(cameraUpVector.$clone(),vector.$clone())),vector3=JuiceboxEngine.Math.Vector3.Cross(vector.$clone(),vector2.$clone());return matrix.M11=vector2.X,matrix.M12=vector3.X,matrix.M13=vector.X,matrix.M14=0,matrix.M21=vector2.Y,matrix.M22=vector3.Y,matrix.M23=vector.Y,matrix.M24=0,matrix.M31=vector2.Z,matrix.M32=vector3.Z,matrix.M33=vector.Z,matrix.M34=0,matrix.M41=-JuiceboxEngine.Math.Vector3.Dot(vector2.$clone(),cameraPosition.$clone()),matrix.M42=-JuiceboxEngine.Math.Vector3.Dot(vector3.$clone(),cameraPosition.$clone()),matrix.M43=-JuiceboxEngine.Math.Vector3.Dot(vector.$clone(),cameraPosition.$clone()),matrix.M44=1,matrix.$clone()},CreateOrthographic:function(width,height,zNearPlane,zFarPlane){var matrix=new JuiceboxEngine.Math.Matrix4.ctor;return matrix.M11=2/width,matrix.M12=matrix.M13=matrix.M14=0,matrix.M22=2/height,matrix.M21=matrix.M23=matrix.M24=0,matrix.M33=1/(zNearPlane-zFarPlane),matrix.M31=matrix.M32=matrix.M34=0,matrix.M41=matrix.M42=0,matrix.M43=zNearPlane/(zNearPlane-zFarPlane),matrix.M44=1,matrix.$clone()},CreatePerspectiveFieldOfView:function(fieldOfView,aspectRatio,nearPlaneDistance,farPlaneDistance){var matrix=new JuiceboxEngine.Math.Matrix4.ctor,num=1/JuiceboxEngine.Math.JMath.Tan(fieldOfView*.5),num9=num/aspectRatio;return matrix.M11=num9,matrix.M12=matrix.M13=matrix.M14=0,matrix.M22=num,matrix.M21=matrix.M23=matrix.M24=0,matrix.M31=matrix.M32=0,matrix.M33=farPlaneDistance/(nearPlaneDistance-farPlaneDistance),matrix.M34=-1,matrix.M41=matrix.M42=matrix.M44=0,matrix.M43=nearPlaneDistance*farPlaneDistance/(nearPlaneDistance-farPlaneDistance),matrix.$clone()},CreateRotationX:function(radians){var result=new JuiceboxEngine.Math.Matrix4.$ctor1(1),val1=JuiceboxEngine.Math.JMath.Cos(radians),val2=JuiceboxEngine.Math.JMath.Sin(radians);return result.M22=val1,result.M23=val2,result.M32=-val2,result.M33=val1,result.$clone()},CreateRotationY:function(radians){var result=new JuiceboxEngine.Math.Matrix4.$ctor1(1),val1=JuiceboxEngine.Math.JMath.Cos(radians),val2=JuiceboxEngine.Math.JMath.Sin(radians);return result.M11=val1,result.M13=-val2,result.M31=val2,result.M33=val1,result.$clone()},CreateRotationZ:function(radians){var result=new JuiceboxEngine.Math.Matrix4.$ctor1(1),val1=JuiceboxEngine.Math.JMath.Cos(radians),val2=JuiceboxEngine.Math.JMath.Sin(radians);return result.M11=val1,result.M12=val2,result.M21=-val2,result.M22=val1,result.$clone()},CreateFromYawPitchRoll:function(yaw,pitch,roll){var quaternion=JuiceboxEngine.Math.Quaternion.CreateFromYawPitchRoll(yaw,pitch,roll);return JuiceboxEngine.Math.Matrix4.CreateFromQuaternion(quaternion.$clone())},CreateFromQuaternion:function(quaternion){var result=new JuiceboxEngine.Math.Matrix4,num9=quaternion.X*quaternion.X,num8=quaternion.Y*quaternion.Y,num7=quaternion.Z*quaternion.Z,num6=quaternion.X*quaternion.Y,num5=quaternion.Z*quaternion.W,num4=quaternion.Z*quaternion.X,num3=quaternion.Y*quaternion.W,num2=quaternion.Y*quaternion.Z,num=quaternion.X*quaternion.W;return result.M11=1-2*(num8+num7),result.M12=2*(num6+num5),result.M13=2*(num4-num3),result.M14=0,result.M21=2*(num6-num5),result.M22=1-2*(num7+num9),result.M23=2*(num2+num),result.M24=0,result.M31=2*(num4+num3),result.M32=2*(num2-num),result.M33=1-2*(num8+num9),result.M34=0,result.M41=0,result.M42=0,result.M43=0,result.M44=1,result.$clone()},CreateScale:function(scale){var result=new JuiceboxEngine.Math.Matrix4.ctor;return result.M11=scale.X,result.M12=0,result.M13=0,result.M14=0,result.M21=0,result.M22=scale.Y,result.M23=0,result.M24=0,result.M31=0,result.M32=0,result.M33=scale.Z,result.M34=0,result.M41=0,result.M42=0,result.M43=0,result.M44=1,result.$clone()},CreateTranslation:function(translation){var result=new JuiceboxEngine.Math.Matrix4.$ctor1(1);return result.M41=translation.X,result.M42=translation.Y,result.M43=translation.Z,result.$clone()},getDefaultValue:function(){return new JuiceboxEngine.Math.Matrix4}}},fields:{M11:0,M12:0,M13:0,M14:0,M21:0,M22:0,M23:0,M24:0,M31:0,M32:0,M33:0,M34:0,M41:0,M42:0,M43:0,M44:0},ctors:{$ctor1:function(value){this.$initialize();this.M11=value;this.M12=0;this.M13=0;this.M14=0;this.M21=0;this.M22=value;this.M23=0;this.M24=0;this.M31=0;this.M32=0;this.M33=value;this.M34=0;this.M41=0;this.M42=0;this.M43=0;this.M44=value},$ctor2:function(m11,m12,m13,m14,m21,m22,m23,m24,m31,m32,m33,m34,m41,m42,m43,m44){this.$initialize();this.M11=m11;this.M12=m12;this.M13=m13;this.M14=m14;this.M21=m21;this.M22=m22;this.M23=m23;this.M24=m24;this.M31=m31;this.M32=m32;this.M33=m33;this.M34=m34;this.M41=m41;this.M42=m42;this.M43=m43;this.M44=m44},ctor:function(){this.$initialize()}},methods:{getItem:function(index){switch(index){case 0:return this.M11;case 1:return this.M12;case 2:return this.M13;case 3:return this.M14;case 4:return this.M21;case 5:return this.M22;case 6:return this.M23;case 7:return this.M24;case 8:return this.M31;case 9:return this.M32;case 10:return this.M33;case 11:return this.M34;case 12:return this.M41;case 13:return this.M42;case 14:return this.M43;case 15:return this.M44}throw new System.ArgumentOutOfRangeException.ctor;},setItem:function(index,value){switch(index){case 0:this.M11=value;break;case 1:this.M12=value;break;case 2:this.M13=value;break;case 3:this.M14=value;break;case 4:this.M21=value;break;case 5:this.M22=value;break;case 6:this.M23=value;break;case 7:this.M24=value;break;case 8:this.M31=value;break;case 9:this.M32=value;break;case 10:this.M33=value;break;case 11:this.M34=value;break;case 12:this.M41=value;break;case 13:this.M42=value;break;case 14:this.M43=value;break;case 15:this.M44=value;break;default:throw new System.ArgumentOutOfRangeException.ctor;}},getItem$1:function(row,column){return this.getItem(Bridge.Int.mul(row,4)+column|0)},setItem$1:function(row,column,value){this.setItem(Bridge.Int.mul(row,4)+column|0,value)},ToFloatArray:function(){return System.Array.init([this.M11,this.M12,this.M13,this.M14,this.M21,this.M22,this.M23,this.M24,this.M31,this.M32,this.M33,this.M34,this.M41,this.M42,this.M43,this.M44],System.Single)},toString:function(){var retval=new System.Text.StringBuilder,i;for(retval.append("{ "),i=0;i<15;i=i+1|0)retval.append((System.Single.format(this.getItem(i))||"")+", ");return retval.append(System.Single.format(this.getItem(15))+" }"),retval.toString()},getHashCode:function(){return Bridge.addHash([1923668406,this.M11,this.M12,this.M13,this.M14,this.M21,this.M22,this.M23,this.M24,this.M31,this.M32,this.M33,this.M34,this.M41,this.M42,this.M43,this.M44])},equals:function(o){return Bridge.is(o,JuiceboxEngine.Math.Matrix4)?Bridge.equals(this.M11,o.M11)&&Bridge.equals(this.M12,o.M12)&&Bridge.equals(this.M13,o.M13)&&Bridge.equals(this.M14,o.M14)&&Bridge.equals(this.M21,o.M21)&&Bridge.equals(this.M22,o.M22)&&Bridge.equals(this.M23,o.M23)&&Bridge.equals(this.M24,o.M24)&&Bridge.equals(this.M31,o.M31)&&Bridge.equals(this.M32,o.M32)&&Bridge.equals(this.M33,o.M33)&&Bridge.equals(this.M34,o.M34)&&Bridge.equals(this.M41,o.M41)&&Bridge.equals(this.M42,o.M42)&&Bridge.equals(this.M43,o.M43)&&Bridge.equals(this.M44,o.M44):!1},$clone:function(to){var s=to||new JuiceboxEngine.Math.Matrix4;return s.M11=this.M11,s.M12=this.M12,s.M13=this.M13,s.M14=this.M14,s.M21=this.M21,s.M22=this.M22,s.M23=this.M23,s.M24=this.M24,s.M31=this.M31,s.M32=this.M32,s.M33=this.M33,s.M34=this.M34,s.M41=this.M41,s.M42=this.M42,s.M43=this.M43,s.M44=this.M44,s}}});Bridge.define("JuiceboxEngine.Math.Point",{inherits:function(){return[System.IEquatable$1(JuiceboxEngine.Math.Point)]},$kind:"struct",statics:{fields:{Zero:null},ctors:{init:function(){this.Zero=new JuiceboxEngine.Math.Point;this.Zero=new JuiceboxEngine.Math.Point.$ctor1(0,0)}},methods:{Distance:function(value1,value2){return JuiceboxEngine.Math.JMath.Sqrt(JuiceboxEngine.Math.Point.DistanceSquared(value1.$clone(),value2.$clone()))},DistanceSquared:function(value1,value2){return Bridge.Int.mul(value1.X-value2.X|0,value1.X-value2.X|0)+Bridge.Int.mul(value1.Y-value2.Y|0,value1.Y-value2.Y|0)|0},op_Equality:function(point1,point2){return point1.equalsT(point2.$clone())},op_Multiply$1:function(point,scalar){return new JuiceboxEngine.Math.Point.$ctor1(Bridge.Int.mul(point.X,scalar),Bridge.Int.mul(point.Y,scalar))},op_Multiply:function(point1,point2){return new JuiceboxEngine.Math.Point.$ctor1(Bridge.Int.mul(point1.X,point2.X),Bridge.Int.mul(point1.Y,point2.Y))},op_Subtraction:function(point1,point2){return new JuiceboxEngine.Math.Point.$ctor1(point1.X-point2.X|0,point1.Y-point2.Y|0)},op_Addition:function(point1,point2){return new JuiceboxEngine.Math.Point.$ctor1(point1.X+point2.X|0,point1.Y+point2.Y|0)},op_Division$1:function(point,value){return new JuiceboxEngine.Math.Point.$ctor1(Bridge.Int.div(point.X,value)|0,Bridge.Int.div(point.Y,value)|0)},op_Division:function(point1,point2){return new JuiceboxEngine.Math.Point.$ctor1(Bridge.Int.div(point1.X,point2.X)|0,Bridge.Int.div(point1.Y,point2.Y)|0)},op_Inequality:function(point1,point2){return!JuiceboxEngine.Math.Point.op_Equality(point1.$clone(),point2.$clone())},getDefaultValue:function(){return new JuiceboxEngine.Math.Point}}},fields:{X:0,Y:0},alias:["equalsT","System$IEquatable$1$JuiceboxEngine$Math$Point$equalsT"],ctors:{$ctor1:function(x,y){this.$initialize();this.X=x;this.Y=y},ctor:function(){this.$initialize()}},methods:{equalsT:function(other){return this.X===other.X&&this.Y===other.Y},equals:function(other){return Bridge.is(other,JuiceboxEngine.Math.Point)&&this.equalsT(Bridge.cast(other,JuiceboxEngine.Math.Point))},getHashCode:function(){var hashCode=1861411795;return hashCode=Bridge.Int.mul(hashCode,-1521134295)+Bridge.getHashCode(this.X)|0,Bridge.Int.mul(hashCode,-1521134295)+Bridge.getHashCode(this.Y)|0},toString:function(){return System.String.format("Point({0}, {1})",this.X,this.Y)},ToVector2:function(){return new JuiceboxEngine.Math.Vector2.$ctor3(this.X,this.Y)},$clone:function(to){var s=to||new JuiceboxEngine.Math.Point;return s.X=this.X,s.Y=this.Y,s}}});Bridge.define("JuiceboxEngine.Math.Quaternion",{$kind:"struct",statics:{methods:{CreateFromYawPitchRoll:function(yaw,pitch,roll){var halfRoll=roll*.5,halfPitch=pitch*.5,halfYaw=yaw*.5,sinRoll=JuiceboxEngine.Math.JMath.Sin(halfRoll),cosRoll=JuiceboxEngine.Math.JMath.Cos(halfRoll),sinPitch=JuiceboxEngine.Math.JMath.Sin(halfPitch),cosPitch=JuiceboxEngine.Math.JMath.Cos(halfPitch),sinYaw=JuiceboxEngine.Math.JMath.Sin(halfYaw),cosYaw=JuiceboxEngine.Math.JMath.Cos(halfYaw);return new JuiceboxEngine.Math.Quaternion.$ctor3(cosYaw*sinPitch*cosRoll+sinYaw*cosPitch*sinRoll,sinYaw*cosPitch*cosRoll-cosYaw*sinPitch*sinRoll,cosYaw*cosPitch*sinRoll-sinYaw*sinPitch*cosRoll,cosYaw*cosPitch*cosRoll+sinYaw*sinPitch*sinRoll)},getDefaultValue:function(){return new JuiceboxEngine.Math.Quaternion}}},fields:{X:0,Y:0,Z:0,W:0},ctors:{$ctor3:function(x,y,z,w){this.$initialize();this.X=x;this.Y=y;this.Z=z;this.W=w},$ctor1:function(value,w){this.$initialize();this.X=value.X;this.Y=value.Y;this.Z=value.Z;this.W=w},$ctor2:function(value){this.$initialize();this.X=value.X;this.Y=value.Y;this.Z=value.Z;this.W=value.W},ctor:function(){this.$initialize()}},methods:{getHashCode:function(){return Bridge.addHash([3721418277,this.X,this.Y,this.Z,this.W])},equals:function(o){return Bridge.is(o,JuiceboxEngine.Math.Quaternion)?Bridge.equals(this.X,o.X)&&Bridge.equals(this.Y,o.Y)&&Bridge.equals(this.Z,o.Z)&&Bridge.equals(this.W,o.W):!1},$clone:function(to){var s=to||new JuiceboxEngine.Math.Quaternion;return s.X=this.X,s.Y=this.Y,s.Z=this.Z,s.W=this.W,s}}});Bridge.define("JuiceboxEngine.Math.Rectangle",{inherits:function(){return[System.IEquatable$1(JuiceboxEngine.Math.Rectangle)]},$kind:"struct",statics:{methods:{op_Implicit:function(rect){return new JuiceboxEngine.Math.RectangleF.$ctor2(rect.X,rect.Y,rect.Width,rect.Height)},op_Equality:function(rectangle1,rectangle2){return rectangle1.equalsT(rectangle2.$clone())},op_Inequality:function(rectangle1,rectangle2){return!rectangle1.equalsT(rectangle2.$clone())},getDefaultValue:function(){return new JuiceboxEngine.Math.Rectangle}}},fields:{X:0,Y:0,Width:0,Height:0},props:{Left:{get:function(){return this.X}},Right:{get:function(){return this.X+this.Width|0}},Bottom:{get:function(){return this.Y}},Top:{get:function(){return this.Y+this.Height|0}}},alias:["equalsT","System$IEquatable$1$JuiceboxEngine$Math$Rectangle$equalsT"],ctors:{$ctor2:function(x,y,width,height){this.$initialize();this.X=x;this.Y=y;this.Width=width;this.Height=height},$ctor1:function(position,width,height){this.$initialize();this.X=position.X;this.Y=position.Y;this.Width=width;this.Height=height},ctor:function(){this.$initialize()}},methods:{Intersects:function(r2){return!(r2.X>(this.X+this.Width|0)||(r2.X+r2.Width|0)<this.X||(r2.Y+r2.Height|0)<this.Y||r2.Y>(this.Y+this.Height|0))},Intersects$1:function(point){return point.X>=this.X&&point.Y>=this.Y&&point.X<=(this.X+this.Width|0)&&point.Y<=(this.Y+this.Height|0)},equals:function(obj){return Bridge.is(obj,JuiceboxEngine.Math.Rectangle)&&this.equalsT(Bridge.cast(obj,JuiceboxEngine.Math.Rectangle))},equalsT:function(other){return this.X===other.X&&this.Y===other.Y&&this.Width===other.Width&&this.Height===other.Height},getHashCode:function(){var hashCode=466501756;return hashCode=Bridge.Int.mul(hashCode,-1521134295)+Bridge.getHashCode(this.X)|0,hashCode=Bridge.Int.mul(hashCode,-1521134295)+Bridge.getHashCode(this.Y)|0,hashCode=Bridge.Int.mul(hashCode,-1521134295)+Bridge.getHashCode(this.Width)|0,Bridge.Int.mul(hashCode,-1521134295)+Bridge.getHashCode(this.Height)|0},$clone:function(to){var s=to||new JuiceboxEngine.Math.Rectangle;return s.X=this.X,s.Y=this.Y,s.Width=this.Width,s.Height=this.Height,s}}});Bridge.define("JuiceboxEngine.Math.RectangleF",{inherits:function(){return[System.IEquatable$1(JuiceboxEngine.Math.RectangleF)]},$kind:"struct",statics:{methods:{op_Equality:function(rectangle1,rectangle2){return rectangle1.equalsT(rectangle2.$clone())},op_Inequality:function(rectangle1,rectangle2){return!rectangle1.equalsT(rectangle2.$clone())},getDefaultValue:function(){return new JuiceboxEngine.Math.RectangleF}}},fields:{X:0,Y:0,Width:0,Height:0},props:{Left:{get:function(){return this.X}},Right:{get:function(){return this.X+this.Width}},Bottom:{get:function(){return this.Y}},Top:{get:function(){return this.Y+this.Height}}},alias:["equalsT","System$IEquatable$1$JuiceboxEngine$Math$RectangleF$equalsT"],ctors:{$ctor2:function(x,y,width,height){this.$initialize();this.X=x;this.Y=y;this.Width=width;this.Height=height},$ctor1:function(position,width,height){this.$initialize();this.X=position.X;this.Y=position.Y;this.Width=width;this.Height=height},ctor:function(){this.$initialize()}},methods:{Intersects:function(r2){return!(r2.X>this.X+this.Width||r2.X+r2.Width<this.X||r2.Y+r2.Height<this.Y||r2.Y>this.Y+this.Height)},Intersects$1:function(point){return point.X>=this.X&&point.Y>=this.Y&&point.X<=this.X+this.Width&&point.Y<=this.Y+this.Height},equals:function(obj){return Bridge.is(obj,JuiceboxEngine.Math.RectangleF)&&this.equalsT(Bridge.cast(obj,JuiceboxEngine.Math.RectangleF))},equalsT:function(other){return this.X===other.X&&this.Y===other.Y&&this.Width===other.Width&&this.Height===other.Height},getHashCode:function(){var hashCode=466501756;return hashCode=Bridge.Int.mul(hashCode,-1521134295)+System.Single.getHashCode(this.X)|0,hashCode=Bridge.Int.mul(hashCode,-1521134295)+System.Single.getHashCode(this.Y)|0,hashCode=Bridge.Int.mul(hashCode,-1521134295)+System.Single.getHashCode(this.Width)|0,Bridge.Int.mul(hashCode,-1521134295)+System.Single.getHashCode(this.Height)|0},$clone:function(to){var s=to||new JuiceboxEngine.Math.RectangleF;return s.X=this.X,s.Y=this.Y,s.Width=this.Width,s.Height=this.Height,s}}});Bridge.define("JuiceboxEngine.Math.Vector2",{inherits:function(){return[System.IEquatable$1(JuiceboxEngine.Math.Vector2)]},$kind:"struct",statics:{fields:{Up:null,Down:null,Right:null,Left:null,Zero:null},ctors:{init:function(){this.Up=new JuiceboxEngine.Math.Vector2;this.Down=new JuiceboxEngine.Math.Vector2;this.Right=new JuiceboxEngine.Math.Vector2;this.Left=new JuiceboxEngine.Math.Vector2;this.Zero=new JuiceboxEngine.Math.Vector2;this.Up=new JuiceboxEngine.Math.Vector2.$ctor3(0,1);this.Down=new JuiceboxEngine.Math.Vector2.$ctor3(0,1);this.Right=new JuiceboxEngine.Math.Vector2.$ctor3(1,0);this.Left=new JuiceboxEngine.Math.Vector2.$ctor3(-1,0);this.Zero=new JuiceboxEngine.Math.Vector2.$ctor3(0,0)}},methods:{Distance:function(value1,value2){return JuiceboxEngine.Math.JMath.Sqrt(JuiceboxEngine.Math.Vector2.DistanceSquared(value1.$clone(),value2.$clone()))},DistanceSquared:function(value1,value2){return(value1.X-value2.X)*(value1.X-value2.X)+(value1.Y-value2.Y)*(value1.Y-value2.Y)},Normalize:function(vector){return vector.Normalize(),vector.$clone()},Dot:function(vector1,vector2){return vector1.X*vector2.X+vector1.Y*vector2.Y},Interpolate:function(start,end,gradient){return new JuiceboxEngine.Math.Vector2.$ctor3(JuiceboxEngine.Math.JMath.Interpolate(start.X,end.X,gradient),JuiceboxEngine.Math.JMath.Interpolate(start.Y,end.Y,gradient))},Rotate:function(vector,radians){var sin=JuiceboxEngine.Math.JMath.Sin(radians),cos=JuiceboxEngine.Math.JMath.Cos(radians),tx=vector.X,ty=vector.Y;return vector.X=cos*tx-sin*ty,vector.Y=sin*tx+cos*ty,vector.$clone()},op_UnaryNegation:function(value){return new JuiceboxEngine.Math.Vector2.$ctor3(-value.X,-value.Y)},op_Equality:function(value1,value2){return value1.X===value2.X&&value1.Y===value2.Y},op_Inequality:function(value1,value2){return value1.X!==value2.X||value1.Y!==value2.Y},op_Addition:function(value1,value2){return value1.X+=value2.X,value1.Y+=value2.Y,value1.$clone()},op_Subtraction:function(value1,value2){return value1.X-=value2.X,value1.Y-=value2.Y,value1.$clone()},op_Multiply:function(value1,value2){return value1.X*=value2.X,value1.Y*=value2.Y,value1.$clone()},op_Multiply$1:function(value1,scalar){return value1.X*=scalar,value1.Y*=scalar,value1.$clone()},op_Multiply$2:function(scalar,value1){return value1.X*=scalar,value1.Y*=scalar,value1.$clone()},op_Division:function(value1,value2){return value1.X/=value2.X,value1.Y/=value2.Y,value1.$clone()},op_Division$1:function(value1,divider){return value1.X/=divider,value1.Y/=divider,value1.$clone()},getDefaultValue:function(){return new JuiceboxEngine.Math.Vector2}}},fields:{X:0,Y:0},alias:["equalsT","System$IEquatable$1$JuiceboxEngine$Math$Vector2$equalsT"],ctors:{$ctor3:function(x,y){this.$initialize();this.X=x;this.Y=y},$ctor2:function(value){this.$initialize();this.X=value;this.Y=value},$ctor1:function(value){this.$initialize();this.X=value.X;this.Y=value.Y},ctor:function(){this.$initialize()}},methods:{Length:function(){return JuiceboxEngine.Math.JMath.Sqrt(this.X*this.X+this.Y*this.Y)},LengthSquared:function(){return this.X*this.X+this.Y*this.Y},Normalize:function(){var factor=JuiceboxEngine.Math.JMath.Sqrt(this.X*this.X+this.Y*this.Y);factor=1/factor;this.X*=factor;this.Y*=factor},toString:function(){return System.String.format("Vector2({0}, {1})",this.X,this.Y)},ToPoint:function(){return new JuiceboxEngine.Math.Point.$ctor1(Bridge.Int.clip32(this.X),Bridge.Int.clip32(this.Y))},equalsT:function(other){return this.X===other.X&&this.Y===other.Y},equals:function(o){return Bridge.is(o,JuiceboxEngine.Math.Vector2)?this.equalsT(Bridge.cast(o,JuiceboxEngine.Math.Vector2)):!1},getHashCode:function(){var hashCode=System.Single.getHashCode(this.X);return Bridge.Int.mul(hashCode,397)^System.Single.getHashCode(this.Y)},$clone:function(to){var s=to||new JuiceboxEngine.Math.Vector2;return s.X=this.X,s.Y=this.Y,s}}});Bridge.define("JuiceboxEngine.Math.Vector3",{inherits:function(){return[System.IEquatable$1(JuiceboxEngine.Math.Vector3)]},$kind:"struct",statics:{fields:{Up:null,Down:null,Right:null,Left:null,Forward:null,Backward:null},ctors:{init:function(){this.Up=new JuiceboxEngine.Math.Vector3;this.Down=new JuiceboxEngine.Math.Vector3;this.Right=new JuiceboxEngine.Math.Vector3;this.Left=new JuiceboxEngine.Math.Vector3;this.Forward=new JuiceboxEngine.Math.Vector3;this.Backward=new JuiceboxEngine.Math.Vector3;this.Up=new JuiceboxEngine.Math.Vector3.$ctor2(0,1,0);this.Down=new JuiceboxEngine.Math.Vector3.$ctor2(0,1,0);this.Right=new JuiceboxEngine.Math.Vector3.$ctor2(1,0,0);this.Left=new JuiceboxEngine.Math.Vector3.$ctor2(-1,0,0);this.Forward=new JuiceboxEngine.Math.Vector3.$ctor2(0,0,1);this.Backward=new JuiceboxEngine.Math.Vector3.$ctor2(0,0,-1)}},methods:{Distance:function(value1,value2){return JuiceboxEngine.Math.JMath.Sqrt(JuiceboxEngine.Math.Vector3.DistanceSquared(value1.$clone(),value2.$clone()))},DistanceSquared:function(value1,value2){return(value1.X-value2.X)*(value1.X-value2.X)+(value1.Y-value2.Y)*(value1.Y-value2.Y)+(value1.Z-value2.Z)*(value1.Z-value2.Z)},Normalize:function(vector){return vector.Normalize(),vector.$clone()},Dot:function(vector1,vector2){return vector1.X*vector2.X+vector1.Y*vector2.Y+vector1.Z*vector2.Z},Cross:function(vector1,vector2){var x=vector1.Y*vector2.Z-vector2.Y*vector1.Z,y=-(vector1.X*vector2.Z-vector2.X*vector1.Z),z=vector1.X*vector2.Y-vector2.X*vector1.Y;return vector1.X=x,vector1.Y=y,vector1.Z=z,vector1.$clone()},op_UnaryNegation:function(value){return new JuiceboxEngine.Math.Vector3.$ctor2(-value.X,-value.Y,-value.Z)},op_Equality:function(value1,value2){return value1.X===value2.X&&value1.Y===value2.Y&&value1.Z===value2.Z},op_Inequality:function(value1,value2){return value1.X!==value2.X||value1.Y!==value2.Y||value1.Z!==value2.Z},op_Addition:function(value1,value2){return value1.X+=value2.X,value1.Y+=value2.Y,value1.Z+=value2.Z,value1.$clone()},op_Subtraction:function(value1,value2){return value1.X-=value2.X,value1.Y-=value2.Y,value1.Z-=value2.Z,value1.$clone()},op_Multiply:function(value1,value2){return value1.X*=value2.X,value1.Y*=value2.Y,value1.Z*=value2.Z,value1.$clone()},op_Multiply$1:function(value1,scalar){return value1.X*=scalar,value1.Y*=scalar,value1.Z*=scalar,value1.$clone()},op_Multiply$2:function(scalar,value1){return value1.X*=scalar,value1.Y*=scalar,value1.Z*=scalar,value1.$clone()},op_Division:function(value1,value2){return value1.X/=value2.X,value1.Y/=value2.Y,value1.Z/=value2.Z,value1.$clone()},op_Division$1:function(value1,divider){return value1.X/=divider,value1.Y/=divider,value1.Z/=divider,value1.$clone()},getDefaultValue:function(){return new JuiceboxEngine.Math.Vector3}}},fields:{X:0,Y:0,Z:0},alias:["equalsT","System$IEquatable$1$JuiceboxEngine$Math$Vector3$equalsT"],ctors:{$ctor2:function(x,y,z){this.$initialize();this.X=x;this.Y=y;this.Z=z},$ctor1:function(value){this.$initialize();this.X=value;this.Y=value;this.Z=value},ctor:function(){this.$initialize()}},methods:{Length:function(){return JuiceboxEngine.Math.JMath.Sqrt(this.X*this.X+this.Y*this.Y+this.Z*this.Z)},LengthSquared:function(){return this.X*this.X+this.Y*this.Y+this.Z*this.Z},Normalize:function(){var factor=JuiceboxEngine.Math.JMath.Sqrt(this.X*this.X+this.Y*this.Y+this.Z*this.Z);factor=1/factor;this.X*=factor;this.Y*=factor;this.Z*=factor},toString:function(){return System.String.format("Vector3({0}, {1}, {2})",this.X,this.Y,this.Z)},equalsT:function(other){return this.X===other.X&&this.Y===other.Y&&this.Z===other.Z},equals:function(o){return Bridge.is(o,JuiceboxEngine.Math.Vector3)?this.equalsT(Bridge.cast(o,JuiceboxEngine.Math.Vector3)):!1},getHashCode:function(){var hashCode=System.Single.getHashCode(this.X);return hashCode=Bridge.Int.mul(hashCode,397)^System.Single.getHashCode(this.Y),Bridge.Int.mul(hashCode,397)^System.Single.getHashCode(this.Z)},$clone:function(to){var s=to||new JuiceboxEngine.Math.Vector3;return s.X=this.X,s.Y=this.Y,s.Z=this.Z,s}}});Bridge.define("JuiceboxEngine.Math.Vector4",{inherits:function(){return[System.IEquatable$1(JuiceboxEngine.Math.Vector4)]},$kind:"struct",statics:{methods:{Distance:function(value1,value2){return JuiceboxEngine.Math.JMath.Sqrt(JuiceboxEngine.Math.Vector4.DistanceSquared(value1.$clone(),value2.$clone()))},DistanceSquared:function(value1,value2){return(value1.W-value2.W)*(value1.W-value2.W)+(value1.X-value2.X)*(value1.X-value2.X)+(value1.Y-value2.Y)*(value1.Y-value2.Y)+(value1.Z-value2.Z)*(value1.Z-value2.Z)},Normalize:function(vector){return vector.Normalize(),vector.$clone()},Dot:function(vector1,vector2){return vector1.X*vector2.X+vector1.Y*vector2.Y+vector1.Z*vector2.Z+vector1.W*vector2.W},op_UnaryNegation:function(value){return new JuiceboxEngine.Math.Vector4.$ctor2(-value.X,-value.Y,-value.Z,-value.W)},op_Equality:function(value1,value2){return value1.X===value2.X&&value1.Y===value2.Y&&value1.Z===value2.Z&&value1.W===value2.W},op_Inequality:function(value1,value2){return value1.X!==value2.X||value1.Y!==value2.Y||value1.Z!==value2.Z||value1.W!==value2.W},op_Addition:function(value1,value2){return value1.X+=value2.X,value1.Y+=value2.Y,value1.Z+=value2.Z,value1.W+=value2.W,value1.$clone()},op_Subtraction:function(value1,value2){return value1.X-=value2.X,value1.Y-=value2.Y,value1.Z-=value2.Z,value1.W-=value2.W,value1.$clone()},op_Multiply:function(value1,value2){return value1.X*=value2.X,value1.Y*=value2.Y,value1.Z*=value2.Z,value1.W*=value2.W,value1.$clone()},op_Multiply$1:function(value1,scalar){return value1.X*=scalar,value1.Y*=scalar,value1.Z*=scalar,value1.W*=scalar,value1.$clone()},op_Multiply$2:function(scalar,value1){return value1.X*=scalar,value1.Y*=scalar,value1.Z*=scalar,value1.W*=scalar,value1.$clone()},op_Division:function(value1,value2){return value1.X/=value2.X,value1.Y/=value2.Y,value1.Z/=value2.Z,value1.W/=value2.W,value1.$clone()},op_Division$1:function(value1,divider){return value1.X/=divider,value1.Y/=divider,value1.Z/=divider,value1.W/=divider,value1.$clone()},getDefaultValue:function(){return new JuiceboxEngine.Math.Vector4}}},fields:{X:0,Y:0,Z:0,W:0},alias:["equalsT","System$IEquatable$1$JuiceboxEngine$Math$Vector4$equalsT"],ctors:{$ctor2:function(x,y,z,w){this.$initialize();this.X=x;this.Y=y;this.Z=z;this.W=w},$ctor1:function(value){this.$initialize();this.X=value;this.Y=value;this.Z=value;this.W=value},ctor:function(){this.$initialize()}},methods:{Length:function(){return JuiceboxEngine.Math.JMath.Sqrt(this.X*this.X+this.Y*this.Y+this.Z*this.Z+this.W*this.W)},LengthSquared:function(){return this.X*this.X+this.Y*this.Y+this.Z*this.Z+this.W*this.W},Normalize:function(){var factor=JuiceboxEngine.Math.JMath.Sqrt(this.X*this.X+this.Y*this.Y+this.Z*this.Z+this.W*this.W);factor=1/factor;this.X*=factor;this.Y*=factor;this.Z*=factor;this.W*=factor},toString:function(){return System.String.format("Vector4({0}, {1}, {2}, {3})",this.X,this.Y,this.Z,this.W)},equalsT:function(other){return this.X===other.X&&this.Y===other.Y&&this.Z===other.Z&&this.W===other.W},equals:function(o){return Bridge.is(o,JuiceboxEngine.Math.Vector4)?this.equalsT(Bridge.cast(o,JuiceboxEngine.Math.Vector4)):!1},getHashCode:function(){var hashCode=System.Single.getHashCode(this.X);return hashCode=Bridge.Int.mul(hashCode,397)^System.Single.getHashCode(this.Y),hashCode=Bridge.Int.mul(hashCode,397)^System.Single.getHashCode(this.Z),Bridge.Int.mul(hashCode,397)^System.Single.getHashCode(this.W)},$clone:function(to){var s=to||new JuiceboxEngine.Math.Vector4;return s.X=this.X,s.Y=this.Y,s.Z=this.Z,s.W=this.W,s}}});Bridge.define("JuiceboxEngine.Networking.NetworkManager",{fields:{_socket:null,ID:null,Connected:!1},events:{OnConnect:null,OnDisconnect:null},ctors:{ctor:function(uri){this.$initialize();this._socket=io(uri);this.ID=this._socket.id;this.Connected=!1;this._socket.on("connect",Bridge.fn.bind(this,function(){this.ID=this._socket.id;this.Connected=!0;Bridge.staticEquals(this.OnConnect,null)?null:this.OnConnect(this,null)}));this._socket.on("reconnect",Bridge.fn.bind(this,function(){this.Connected=!0;Bridge.staticEquals(this.OnConnect,null)?null:this.OnConnect(this,null)}));this._socket.on("disconnect",Bridge.fn.bind(this,function(){this.Connected=!1;Bridge.staticEquals(this.OnDisconnect,null)?null:this.OnDisconnect(this,null)}))}},methods:{Disconnect:function(){this._socket.disconnect()},AddListener:function(T,key,$function){var action=function(data){var sendable=Bridge.createInstance(T);sendable.Decode(data);$function(sendable)};this._socket.on(key,action)},Send:function(key,obj){this._socket.emit(key,obj.GetEncoded())}}});Bridge.define("JuiceboxEngine.Networking.Sceme",{fields:{_strings:null,_bools:null,_floats:null,_integers:null,_sendables:null,_sendableArrays:null,_cachedSizes:!1,_intSizes:0,_floatSizes:0},props:{ProperiesBytes:{get:function(){var total=((((this._strings.Count+this._bools.Count|0)+this._integers.Count|0)+this._floats.Count|0)+this._sendables.Count|0)+this._sendableArrays.Count|0;return 1+(Bridge.Int.div(total-1|0,8)|0)|0}},BooleanBytes:{get:function(){return this._bools.Count===0?0:1+(Bridge.Int.div(this._bools.Count-1|0,8)|0)|0}}},ctors:{ctor:function(){this.$initialize();this._strings=new(System.Collections.Generic.List$1(System.String).ctor);this._bools=new(System.Collections.Generic.List$1(System.String).ctor);this._integers=new(System.Collections.Generic.List$1(System.Collections.Generic.KeyValuePair$2(System.String,System.Int32)).ctor);this._sendables=new(System.Collections.Generic.List$1(System.Collections.Generic.KeyValuePair$2(System.String,System.Type)).ctor);this._sendableArrays=new(System.Collections.Generic.List$1(System.Collections.Generic.KeyValuePair$2(System.String,System.Type)).ctor);this._floats=new(System.Collections.Generic.List$1(System.Collections.Generic.KeyValuePair$2(System.String,System.Int32)).ctor);this._cachedSizes=!1}},methods:{AddString:function(name){this._strings.add(name)},AddBoolean:function(name){this._bools.add(name)},AddInteger:function(name,bytes){this._integers.add(new(System.Collections.Generic.KeyValuePair$2(System.String,System.Int32).$ctor1)(name,bytes))},AddFloat:function(name,bytes){this._floats.add(new(System.Collections.Generic.KeyValuePair$2(System.String,System.Int32).$ctor1)(name,bytes))},AddSendable:function(T,name){this._sendables.add(new(System.Collections.Generic.KeyValuePair$2(System.String,System.Type).$ctor1)(name,T))},AddSendableArray:function(T,name){this._sendableArrays.add(new(System.Collections.Generic.KeyValuePair$2(System.String,System.Type).$ctor1)(name,T))},ComputeSize:function(sendable){for(var $t,size=0,raw=sendable,prop,i,i2,i3,prop1,sendObj,i4,prop2,sendableArray,j,sendObj1,size=size+this.ProperiesBytes|0,i1=0;i1<this._strings.Count;i1=i1+1|0)prop=this._strings.getItem(i1),size=size+(Bridge.as(raw[prop],System.String).length+1|0)|0;if(size=size+this.BooleanBytes|0,!this._cachedSizes){for(this._intSizes=0,this._floatSizes=0,i=0;i<this._integers.Count;i=i+1|0)this._intSizes=this._intSizes+this._integers.getItem(i).value|0;for(i2=0;i2<this._floats.Count;i2=i2+1|0)this._floatSizes=this._floatSizes+this._floats.getItem(i2).value|0;this._cachedSizes=!0}for(size=size+this._intSizes|0,size=size+this._floatSizes|0,i3=0;i3<this._sendables.Count;i3=i3+1|0)prop1=this._sendables.getItem(i3),sendObj=Bridge.as(sendable[prop1.key],JuiceboxEngine.Networking.Sendable),size=sendObj!=null?size+(sendObj.ComputeSize()+1|0)|0:size+1|0;for(i4=0;i4<this._sendableArrays.Count;i4=i4+1|0){for(prop2=this._sendableArrays.getItem(i4),sendableArray=Bridge.as(sendable[prop2.key],System.Array.type(JuiceboxEngine.Networking.Sendable)),j=sendableArray.length;j>=0;j=j-255|0)size=size+1|0;$t=Bridge.getEnumerator(sendableArray);try{while($t.moveNext())sendObj1=$t.Current,size=sendableArray!=null?size+(sendObj1.ComputeSize()+1|0)|0:size+1|0}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}}return size},Encode:function(sendable){for(var prop,stringBytes,i1,packedBools,i2,value,curBoolByte,b,i3,value1,intBytes,bytes,j,i4,value2,bytes1,packed,prop1,sendableObj,arrayBuffer,byteBuffer,i5,prop2,array,length,sendableObj1,arrayBuffer1,byteBuffer1,i6,$t,$t1,$t2,$t3,$t4,obj=sendable,buffer=new ArrayBuffer(this.ComputeSize(sendable)),dv=new DataView(buffer),curByte=0,i=0;i<this.ProperiesBytes;i=i+1|0)dv.setUint8(i,255);curByte=curByte+this.ProperiesBytes|0;$t=Bridge.getEnumerator(this._strings);try{while($t.moveNext()){for(prop=$t.Current,stringBytes=System.Text.Encoding.ASCII.GetBytes$2(Bridge.cast(obj[prop],System.String)),dv.setUint8(curByte,stringBytes.length&255),i1=1;i1<=stringBytes.length;i1=i1+1|0)dv.setUint8(curByte+i1|0,stringBytes[i1-1|0]);curByte=curByte+(stringBytes.length+1|0)|0}}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}for(packedBools=System.Array.init(this.BooleanBytes,0,System.Byte),i2=0;i2<this._bools.Count;i2=i2+1|0)value=obj[this._bools.getItem(i2)],curBoolByte=Bridge.Int.div(i2,8)|0,packedBools[curBoolByte]=packedBools[curBoolByte]<<1&255,value&&(packedBools[curBoolByte]=(packedBools[curBoolByte]|1)&255);$t1=Bridge.getEnumerator(packedBools);try{while($t1.moveNext())b=$t1.Current,dv.setUint8(curByte,b),curByte=curByte+1|0}finally{Bridge.is($t1,System.IDisposable)&&$t1.System$IDisposable$Dispose()}for(i3=0;i3<this._integers.Count;i3=i3+1|0){for(value1=obj[this._integers.getItem(i3).key],bytes=this._integers.getItem(i3).value,intBytes=bytes===1?System.BitConverter.getBytes$3(Bridge.Int.sxb(value1&255)):bytes===2?System.BitConverter.getBytes$3(Bridge.Int.sxs(value1&65535)):System.BitConverter.getBytes$4(value1),j=0;j<bytes;j=j+1|0)dv.setUint8(curByte+j|0,intBytes[j]);curByte=curByte+bytes|0}for(i4=0;i4<this._floats.Count;i4=i4+1|0)value2=obj[this._floats.getItem(i4).key],bytes1=this._floats.getItem(i4).value,bytes1===1?dv.setInt8(curByte,Bridge.Int.clip8(value2*127)):bytes1===2?(packed=Bridge.Int.clip16(value2*255),dv.setInt16(curByte,packed)):bytes1===4?dv.setFloat32(curByte,value2):bytes1===8&&dv.setFloat64(curByte,value2),curByte=curByte+bytes1|0;$t2=Bridge.getEnumerator(this._sendables);try{while($t2.moveNext()){if(prop1=$t2.Current,sendableObj=obj[prop1.key],sendableObj==null){dv.setUint8(curByte,0);curByte=curByte+1|0;continue}for(arrayBuffer=Bridge.cast(sendableObj.GetEncoded(),ArrayBuffer),byteBuffer=new Uint8Array(arrayBuffer),dv.setUint8(curByte,byteBuffer.length&255),i5=0;i5<byteBuffer.length;i5=i5+1|0)dv.setUint8((curByte+i5|0)+1|0,byteBuffer[i5]);curByte=curByte+(byteBuffer.length+1|0)|0}}finally{Bridge.is($t2,System.IDisposable)&&$t2.System$IDisposable$Dispose()}$t3=Bridge.getEnumerator(this._sendableArrays);try{while($t3.moveNext()){for(prop2=$t3.Current,array=Bridge.as(obj[prop2.key],System.Array.type(JuiceboxEngine.Networking.Sendable)),length=array.length;length>=0;length=length-255|0)length>255?dv.setUint8(curByte,255):dv.setUint8(curByte,length&255),curByte=curByte+1|0;$t4=Bridge.getEnumerator(array);try{while($t4.moveNext()){if(sendableObj1=$t4.Current,sendableObj1==null){dv.setUint8(curByte,0);curByte=curByte+1|0;continue}for(arrayBuffer1=Bridge.cast(sendableObj1.GetEncoded(),ArrayBuffer),byteBuffer1=new Uint8Array(arrayBuffer1),dv.setUint8(curByte,byteBuffer1.length&255),i6=0;i6<byteBuffer1.length;i6=i6+1|0)dv.setUint8((curByte+i6|0)+1|0,byteBuffer1[i6]);curByte=curByte+(byteBuffer1.length+1|0)|0}}finally{Bridge.is($t4,System.IDisposable)&&$t4.System$IDisposable$Dispose()}}}finally{Bridge.is($t3,System.IDisposable)&&$t3.System$IDisposable$Dispose()}return buffer},Decode:function(data){var $t,$t1,$t2,$t3,$t4,retval={},bytes=new Uint8Array(data),curByte=this.ProperiesBytes,i,boolBytes,i1,curBoolCount,i2,curBool,curBoolByte,i3,j,value,i4,j1,prop3,length,sendableBytes,sendable,prop4,length1,value1,array,i5,objLenght,sendableBytes1;$t=Bridge.getEnumerator(this._strings);try{while($t.moveNext()){var prop=$t.Current,lenght=bytes[curByte],chars=System.Array.init(lenght,0,System.Char);for(i=0;i<lenght;i=i+1|0)chars[i]=bytes[(1+curByte|0)+i|0];retval[prop]=System.String.fromCharArray(chars);curByte=curByte+(lenght+1|0)|0}}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}for(boolBytes=System.Array.init(this.BooleanBytes,0,System.Byte),i1=0;i1<boolBytes.length;i1=i1+1|0)boolBytes[i1]=bytes[curByte+i1|0];for(curByte=curByte+boolBytes.length|0,curBoolCount=0,i2=this._bools.Count-1|0;i2>=0;i2=i2-1|0)curBool=this._bools.getItem(i2),curBoolByte=Bridge.Int.div(curBoolCount,8)|0,retval[curBool]=(boolBytes[curBoolByte]&1)==1,boolBytes[curBoolByte]=($t1=boolBytes[curBoolByte]>>1&255,boolBytes[curBoolByte]=$t1,$t1),curBoolCount=curBoolCount+1|0;for(i3=0;i3<this._integers.Count;i3=i3+1|0){var prop1=this._integers.getItem(i3).key,size=this._integers.getItem(i3).value,intBytes=System.Array.init(size,0,System.Byte);for(j=0;j<intBytes.length;j=j+1|0)intBytes[j]=bytes[j+curByte|0];value=0;size===1?value=Bridge.Int.sxb(intBytes[0]&255):size===2?value=System.BitConverter.toInt16(intBytes,0):size===4&&(value=System.BitConverter.toInt32(intBytes,0));retval[prop1]=value;curByte=curByte+size|0}for(i4=0;i4<this._floats.Count;i4=i4+1|0){var prop2=this._floats.getItem(i4).key,size1=this._floats.getItem(i4).value,floatBytes=System.Array.init(size1,0,System.Byte);for(j1=0;j1<size1;j1=j1+1|0)floatBytes[j1]=bytes[j1+curByte|0];floatBytes.reverse();size1===1&&(retval[prop2]=Bridge.Int.sxb(floatBytes[0]&255)/127);size1===2?retval[prop2]=System.BitConverter.toInt16(floatBytes,0)/255:size1===4?retval[prop2]=System.BitConverter.toSingle(floatBytes,0):size1===8&&(retval[prop2]=System.BitConverter.toDouble(floatBytes,0));curByte=curByte+size1|0}$t2=Bridge.getEnumerator(this._sendables);try{while($t2.moveNext()){if(prop3=$t2.Current,length=bytes[curByte],curByte=curByte+1|0,length===0){retval[prop3.key]=null;continue}sendableBytes=bytes.slice(curByte,curByte+length|0);sendable=Bridge.cast(Bridge.createInstance(prop3.value),JuiceboxEngine.Networking.Sendable);sendable.Decode(sendableBytes);retval[prop3.key]=sendable;curByte=curByte+length|0}}finally{Bridge.is($t2,System.IDisposable)&&$t2.System$IDisposable$Dispose()}$t3=Bridge.getEnumerator(this._sendableArrays);try{while($t3.moveNext()){for(prop4=$t3.Current,length1=0;;)if(value1=bytes[curByte],length1=length1+value1|0,curByte=curByte+1|0,value1!==255)break;if(array=Bridge.as(($t4=prop4.value,System.Array.init(length1,Bridge.getDefaultValue($t4),$t4)),System.Array.type(JuiceboxEngine.Networking.Sendable)),retval[prop4.key]=array,length1!==0){for(i5=0;i5<length1;i5=i5+1|0){if(objLenght=bytes[curByte],curByte=curByte+1|0,objLenght===0){array[i5]=null;continue}sendableBytes1=bytes.slice(curByte,curByte+objLenght|0);array[i5]=Bridge.cast(Bridge.createInstance(prop4.value),JuiceboxEngine.Networking.Sendable);array[i5].Decode(sendableBytes1);curByte=curByte+objLenght|0}retval[prop4.key]=array}}}finally{Bridge.is($t3,System.IDisposable)&&$t3.System$IDisposable$Dispose()}return retval}}});Bridge.define("JuiceboxEngine.Networking.ScemeManager",{statics:{fields:{_scemes:null},ctors:{ctor:function(){JuiceboxEngine.Networking.ScemeManager._scemes=new(System.Collections.Generic.Dictionary$2(System.Type,JuiceboxEngine.Networking.Sceme).ctor)}},methods:{GetSceme:function(sendable){var type=Bridge.getType(sendable),sceme={};return JuiceboxEngine.Networking.ScemeManager._scemes.tryGetValue(type,sceme),sceme.v==null&&(sceme.v=sendable.GetSceme(),JuiceboxEngine.Networking.ScemeManager._scemes.add(type,sceme.v)),sceme.v}}}});Bridge.define("JuiceboxEngine.Networking.Sendable",{props:{Sceme:{get:function(){return JuiceboxEngine.Networking.ScemeManager.GetSceme(this)}}},methods:{FromDynamic:function(rawData){var $t,names=Object.getOwnPropertyNames(rawData),name;$t=Bridge.getEnumerator(names);try{while($t.moveNext())name=$t.Current,this[name]=rawData[name]}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}},ComputeSize:function(){return this.Sceme.ComputeSize(this)},GetEncoded:function(){return this.Sceme.Encode(this)},Decode:function(data){var obj=this.Sceme.Decode(data);this.FromDynamic(obj)}}});Bridge.define("JuiceboxEngine.Resources.Preloader",{fields:{_resources:null,ToPreload:0,Preloaded:0,Busy:!1,ResourceLoading:null},methods:{Preload:function(resourceManager,files){if(this.Busy){JuiceboxEngine.Logger.Warn("Already preloading!");return}this.Busy=!0;this.PreloadItems(resourceManager,files);this.Busy=!1},PreloadCoroutine:function(resourceManager,files){var $step=0,$jumpFromFinally,$returnValue,$t,s,resource,time,$async_e,$enumerator=new Bridge.GeneratorEnumerator(Bridge.fn.bind(this,function(){try{for(;;)switch($step){case 0:this._resources=new(System.Collections.Generic.List$1(JuiceboxEngine.Resources.IResource).ctor);this.ToPreload=files.length;this.Busy=!0;$t=Bridge.getEnumerator(files);$step=1;continue;case 1:if($t.moveNext()){s={v:$t.Current};$step=2;continue}$step=4;continue;case 2:return this.ResourceLoading=s.v,this.Preloaded=this.Preloaded+1|0,resource={v:resourceManager.Load$1(s.v)},time={v:0},$enumerator.current=new JuiceboxEngine.Coroutines.WaitUntilTrue(function($me,time,s,resource){return function(){return(time.v+=JuiceboxEngine.Util.Time.DeltaTimeRealTime,time.v>5)?(JuiceboxEngine.Logger.Warn(System.String.format("{0} took too long to pre-load, skipping it for now.",[s.v])),!0):resource.v.JuiceboxEngine$Resources$IResource$Loaded}}(this,time,s,resource)),$step=3,!0;case 3:$step=1;continue;case 4:this.Busy=!1;default:return!1}}catch($async_e1){$async_e=System.Exception.create($async_e1);throw $async_e;}}));return $enumerator},PreloadItems:function(resourceManager,files){var $t,s,resource;this._resources=new(System.Collections.Generic.List$1(JuiceboxEngine.Resources.IResource).ctor);this.ToPreload=files.length;$t=Bridge.getEnumerator(files);try{while($t.moveNext())s=$t.Current,JuiceboxEngine.Logger.Log("Preloading "+(s||"")),resource=resourceManager.Load$1(s),this.Preloaded=this.Preloaded+1|0}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}}}});Bridge.define("JuiceboxEngine.Resources.ResourceManager",{fields:{_resources:null,_resourceManagers:null},ctors:{ctor:function(){this.$initialize();this._resources=new(System.Collections.Generic.Dictionary$2(System.String,JuiceboxEngine.Resources.IResource).ctor);this._resourceManagers=new(System.Collections.Generic.Dictionary$2(System.String,JuiceboxEngine.Resources.ResourceLoader).ctor)}},methods:{RegisterResourceManager:function(manager){this._resourceManagers.add(manager.Extension,manager)},Load:function(T,path){return Bridge.cast(this.Load$1(path),T)},Load$1:function(path){var $t,extension,resource;if(this._resources.containsKey(path))return this._resources.getItem(path);try{if(extension=($t=System.String.split(path,[46].map(function(i){return String.fromCharCode(i)})))[1],resource=this._resourceManagers.getItem(extension).Load(path),resource==null)throw new System.Exception("File "+(path||"")+" not found!");return this._resources.add(path,resource),resource}catch(e){e=System.Exception.create(e);JuiceboxEngine.Logger.Error("Unable to load "+(path||"")+", reason: "+(Bridge.toString(e)||""))}return null}}});Bridge.define("JuiceboxEngine.Scene",{fields:{_objects:null,_cameras:null,DefaultCamera:null,ResourceManager:null,GUI:null},ctors:{ctor:function(manager){this.$initialize();this._objects=new(System.Collections.Generic.List$1(JuiceboxEngine.GameObject).ctor);this._cameras=new(System.Collections.Generic.List$1(JuiceboxEngine.Camera).ctor);this.ResourceManager=manager;this.GUI=new JuiceboxEngine.GUI.UserInterface(this.ResourceManager);var cameraObj=this.AddGameObject$1("Camera");this.DefaultCamera=cameraObj.AddComponent(JuiceboxEngine.Camera);this.DefaultCamera.ClearColor=new JuiceboxEngine.Math.Color.$ctor3(.1,.1,.1,1)}},methods:{AddGameObject:function(){return this.AddGameObject$1("Gameobject")},AddGameObject$1:function(name){var obj=new JuiceboxEngine.GameObject.$ctor1(this,name);return this._objects.add(obj),obj},DestroyGameObject:function(obj){this._objects.contains(obj)&&(obj.Destroy(),this._objects.remove(obj))},GetObjectByName:function(name){return System.Linq.Enumerable.from(this._objects,JuiceboxEngine.GameObject).where(function(x){return System.String.equals(x.Name,name)}).firstOrDefault(null,null)},AddCamera:function(cam){this._cameras.add(cam)},Start:function(){JuiceboxEngine.Sprite.spriteBatch=new JuiceboxEngine.Graphics.Spritebatch(this.ResourceManager);this.InitializeScene()},Destroy:function(){for(var i=0;i<this._objects.Count;i=i+1|0)this._objects.getItem(i).Destroy();this._objects.clear();this.FinalizeScene()},UpdateScene:function(){var obj,i;for(this.PreUpdate(),obj=null,i=0;i<this._objects.Count;i=i+1|0)obj=this._objects.getItem(i),obj.Enabled&&obj.Update();this.GUI.HandleMouse(JuiceboxEngine.Math.Vector2.op_Multiply(JuiceboxEngine.Input.InputManager.Instance.MousePosition.$clone(),new JuiceboxEngine.Math.Vector2.$ctor3(JuiceboxEngine.Graphics.GraphicsManager.Instance.Width,JuiceboxEngine.Graphics.GraphicsManager.Instance.Height)));this.LateUpdate()},RenderScene:function(){for(var cam,transform,go,$t,context=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context,i=0;i<this._cameras.Count;i=i+1|0)if(cam=this._cameras.getItem(i),cam.Enabled){context.SetRenderTarget(cam.Target);context.Clear(cam.ClearColor.$clone());transform=cam.Parent.Transform;context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.VIEW,cam.ViewMatrix.$clone());context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.PROJ,cam.ProjMatrix.$clone());context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.CAMERAPOSITION,transform.Position.$clone());context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.ZOOM,cam.Zoom);JuiceboxEngine.Sprite.spriteBatch.Begin(cam.Frustum.$clone());$t=Bridge.getEnumerator(this._objects);try{while($t.moveNext())go=$t.Current,go.Enabled&&go.Render()}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}JuiceboxEngine.Sprite.spriteBatch.End();JuiceboxEngine.Debugging.DebugRenderer.Instance.RenderDebugLines()}context.SetRenderTarget(null);JuiceboxEngine.Graphics.GraphicsManager.Instance.RenderCamera(this.DefaultCamera);this.GUI.RenderUserInterface();JuiceboxEngine.Debugging.DebugRenderer.InstanceGUI.RenderDebugLines()}}});Bridge.define("JuiceboxEngine.SceneManager",{statics:{fields:{_target:null,FadeInTexture:null,FadeOutTexture:null,FadeInDuration:0,FadeOutDuration:0,Fading:!1,FadeProgress:0,CurFadeTexture:null,CurrentScene:null,_game:null,_delay:0,_switched:!1,_progress:0},props:{FadeDuration:{get:function(){return JuiceboxEngine.SceneManager.FadeInDuration+JuiceboxEngine.SceneManager.FadeOutDuration}}},methods:{Initialize:function(game){JuiceboxEngine.SceneManager._game=game;JuiceboxEngine.SceneManager.FadeOutDuration=1;JuiceboxEngine.SceneManager.FadeInDuration=1;JuiceboxEngine.SceneManager._delay=0;JuiceboxEngine.SceneManager.Fading=!1;JuiceboxEngine.SceneManager._progress=0;JuiceboxEngine.SceneManager.FadeOutTexture=JuiceboxEngine.SceneManager._game.ResourceManager.Load(JuiceboxEngine.Graphics.Texture2D,"Textures/ScreenFade.png");JuiceboxEngine.SceneManager.FadeInTexture=JuiceboxEngine.SceneManager._game.ResourceManager.Load(JuiceboxEngine.Graphics.Texture2D,"Textures/ScreenFade.png")},SwitchToScene:function(scene,delay){delay===void 0&&(delay=0);JuiceboxEngine.SceneManager._delay=delay;JuiceboxEngine.SceneManager._target=scene},Update:function(){JuiceboxEngine.SceneManager.FadeProgress=0;JuiceboxEngine.SceneManager.Fading?(JuiceboxEngine.SceneManager._progress+=JuiceboxEngine.Util.Time.DeltaTimeRealTime,JuiceboxEngine.SceneManager._progress<JuiceboxEngine.SceneManager.FadeOutDuration?(JuiceboxEngine.SceneManager.CurFadeTexture=JuiceboxEngine.SceneManager.FadeOutTexture,JuiceboxEngine.SceneManager.FadeProgress=JuiceboxEngine.SceneManager._progress/JuiceboxEngine.SceneManager.FadeOutDuration):(JuiceboxEngine.SceneManager.CurFadeTexture=JuiceboxEngine.SceneManager.FadeInTexture,JuiceboxEngine.SceneManager.FadeProgress=1-(JuiceboxEngine.SceneManager._progress-JuiceboxEngine.SceneManager.FadeOutDuration)/JuiceboxEngine.SceneManager.FadeInDuration,JuiceboxEngine.SceneManager._switched||(JuiceboxEngine.SceneManager._switched=!0,JuiceboxEngine.SceneManager.FadeProgress=1,JuiceboxEngine.SceneManager._game.CurrentScene.Destroy(),JuiceboxEngine.SceneManager._game.CurrentScene=JuiceboxEngine.SceneManager._target,JuiceboxEngine.SceneManager.CurrentScene=JuiceboxEngine.SceneManager._target,JuiceboxEngine.SceneManager._game.CurrentScene.Start(),JuiceboxEngine.SceneManager._target=null)),JuiceboxEngine.SceneManager._progress>JuiceboxEngine.SceneManager.FadeDuration&&(JuiceboxEngine.SceneManager.Fading=!1,JuiceboxEngine.SceneManager._switched=!1,JuiceboxEngine.SceneManager._progress=0)):JuiceboxEngine.SceneManager._target!=null&&(JuiceboxEngine.SceneManager._delay-=JuiceboxEngine.Util.Time.DeltaTimeRealTime,JuiceboxEngine.SceneManager._delay<=0&&!JuiceboxEngine.SceneManager.Fading&&(JuiceboxEngine.SceneManager.Fading=!0))}}}});Bridge.define("JuiceboxEngine.Sprite.SpriteFlip",{$kind:"nested enum",statics:{fields:{None:0,HorizontalFlip:1,VerticalFlip:2}}});Bridge.define("JuiceboxEngine.Util.Browser",{statics:{methods:{OpenWindow:function(url){var $window=window.open(url)},Alert:function(msg){window.alert(msg)},SetTitle:function(title){document.title=title},GetResource:function(url,onLoad){var request=new XMLHttpRequest;request.onload=function(x){var obj=request.response;onLoad(obj)};request.open("GET",url);request.responseType="json";request.send()},DateNow:function(){return Date.now()},Prompt:function(msg,value){return window.prompt(msg,value)},IsMobile:function(){var u=window.navigator.userAgent,b=new System.Text.RegularExpressions.Regex.ctor("(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino",3),v=new System.Text.RegularExpressions.Regex.ctor("1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-",3);return b.isMatch(u)||v.isMatch(u.substr(0,4))},GetHostName:function(){return window.location.hostname},RequestFullscreen:function(){document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen():document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()}}}});Bridge.define("JuiceboxEngine.Util.Config",{statics:{fields:{ConfigValues:null},ctors:{ctor:function(){JuiceboxEngine.Util.Config.ConfigValues=JuiceboxEngine.Util.JSON.JSONToObject(JuiceboxEngine.Util.ConfigModel,System.IO.File.ReadAllText("config.txt"))}}}});Bridge.define("JuiceboxEngine.Util.ConfigModel",{fields:{PixelSize:0,PixelPerfect:!1,PreloadList:null,Fullscreen:!1,WebSocketServer:null}});Bridge.define("JuiceboxEngine.Util.JSON",{statics:{methods:{GetDynamicFromJSON:function(json){return JSON.parse(json)},GetDynamicFromFile:function(file){try{var json=System.IO.File.ReadAllText(file);return JuiceboxEngine.Util.JSON.GetDynamicFromJSON(json)}catch($e1){return $e1=System.Exception.create($e1),JuiceboxEngine.Logger.Error("Failed to read "+(file||"")),null}},ObjectToJSON:function(obj){return JSON.stringify(obj)},JSONToObject:function(T,json){return Bridge.merge(Bridge.createInstance(T),JSON.parse(json))}}}});Bridge.define("JuiceboxEngine.Util.LocalStorage",{statics:{methods:{StoreValue:function(key,value){window.localStorage.setItem(key,value)},GetValue:function(key){return window.localStorage[key]}}}});Bridge.define("JuiceboxEngine.Util.Random",{statics:{fields:{_random:null},ctors:{ctor:function(){JuiceboxEngine.Util.Random._random=new System.Random.ctor}},methods:{Next:function(){return JuiceboxEngine.Util.Random._random.NextDouble()},NextRange:function(min,max){return JuiceboxEngine.Util.Random._random.Next$2(min,max)},NextRange$1:function(min,max){return JuiceboxEngine.Math.JMath.Interpolate(min,max,JuiceboxEngine.Util.Random.Next())},NextGaussian:function(mean,stddiv){var first=JuiceboxEngine.Util.Random.Next(),second=JuiceboxEngine.Util.Random.Next(),normal=JuiceboxEngine.Math.JMath.Sqrt(-2*JuiceboxEngine.Math.JMath.Log(first))*JuiceboxEngine.Math.JMath.Sin(6.28318548*second);return mean+stddiv*normal}}}});Bridge.define("JuiceboxEngine.Util.Time",{statics:{fields:{TotalSeconds:0,DeltaTime:0,DeltaTimeRealTime:0,TimeScale:0,MaxTimeStep:0,ConstantTimeStep:0,_previous:null},props:{CurDateTime:{get:function(){return System.DateTime.getNow()}}},ctors:{init:function(){this._previous=System.DateTime.getDefaultValue();this.TimeScale=1},ctor:function(){JuiceboxEngine.Util.Time._previous=System.DateTime.getNow();JuiceboxEngine.Util.Time.MaxTimeStep=.0333333351;JuiceboxEngine.Util.Time.ConstantTimeStep=0}},methods:{UpdateTime:function(){Bridge.equals(JuiceboxEngine.Util.Time._previous,null)&&(JuiceboxEngine.Util.Time._previous=System.DateTime.getNow());var now=System.DateTime.getNow(),span=System.DateTime.subdd(now,JuiceboxEngine.Util.Time._previous);JuiceboxEngine.Util.Time.TotalSeconds+=span.getTotalSeconds();JuiceboxEngine.Util.Time.DeltaTime=span.getTotalSeconds()*JuiceboxEngine.Util.Time.TimeScale;JuiceboxEngine.Util.Time.DeltaTimeRealTime=span.getTotalSeconds();JuiceboxEngine.Util.Time.ConstantTimeStep!==0?JuiceboxEngine.Util.Time.DeltaTime=JuiceboxEngine.Util.Time.ConstantTimeStep:JuiceboxEngine.Util.Time.DeltaTime>JuiceboxEngine.Util.Time.MaxTimeStep&&(JuiceboxEngine.Util.Time.DeltaTime=JuiceboxEngine.Util.Time.MaxTimeStep);JuiceboxEngine.Util.Time._previous=now}}}});Bridge.define("Humper.Box",{inherits:[Humper.IBox],fields:{world:null,bounds:null,Data:null,TriggerOnly:!1,Parent:null},props:{Bounds:{get:function(){return this.bounds.$clone()}},Height:{get:function(){return this.Bounds.Height}},Width:{get:function(){return this.Bounds.Width}},X:{get:function(){return this.Bounds.X}},Y:{get:function(){return this.Bounds.Y}}},alias:["Bounds","Humper$IBox$Bounds","Data","Humper$IBox$Data","Height","Humper$IBox$Height","Width","Humper$IBox$Width","X","Humper$IBox$X","Y","Humper$IBox$Y","TriggerOnly","Humper$IBox$TriggerOnly","Simulate$1","Humper$IBox$Simulate$1","Simulate","Humper$IBox$Simulate","Move$1","Humper$IBox$Move$1","Move","Humper$IBox$Move"],ctors:{init:function(){this.bounds=new Humper.Base.RectangleF},ctor:function(world,x,y,width,height){this.$initialize();this.world=world;this.bounds=new Humper.Base.RectangleF.$ctor3(x,y,width,height);this.TriggerOnly=!1}},methods:{Simulate$1:function(x,y,filter){return this.world.Simulate(this,x,y,filter)},Simulate:function(x,y,filter){return this.Move$1(x,y,function(col){return col.Humper$ICollision$Hit==null?null:Humper.Responses.CollisionResponse.Create(col,filter(col))})},Move$1:function(x,y,filter){var movement=this.Simulate$1(x,y,filter);return this.bounds.X=movement.Humper$IMovement$Destination.X,this.bounds.Y=movement.Humper$IMovement$Destination.Y,this.world.Update(this,movement.Humper$IMovement$Origin.$clone()),movement},Move:function(x,y,filter){var movement=this.Simulate(x,y,filter);return this.bounds.X=movement.Humper$IMovement$Destination.X,this.bounds.Y=movement.Humper$IMovement$Destination.Y,this.world.Update(this,movement.Humper$IMovement$Origin.$clone()),movement}}});Bridge.define("Humper.Collision",{inherits:[Humper.ICollision],fields:{Box:null,Origin:null,Goal:null,Hit:null},props:{Other:{get:function(){var $t;return($t=this.Hit)!=null?$t.Humper$IHit$Box:null}},HasCollided:{get:function(){return this.Hit!=null}}},alias:["Box","Humper$ICollision$Box","Other","Humper$ICollision$Other","Origin","Humper$ICollision$Origin","Goal","Humper$ICollision$Goal","Hit","Humper$ICollision$Hit"],ctors:{init:function(){this.Origin=new Humper.Base.RectangleF;this.Goal=new Humper.Base.RectangleF},ctor:function(){this.$initialize()}}});Bridge.define("Humper.Hit",{inherits:[Humper.IHit],statics:{methods:{Resolve$2:function(origin,destination,other){var result=Humper.Hit.Resolve(origin.$clone(),destination.$clone(),other.Humper$IBox$Bounds.$clone());return result!=null&&(result.Box=other),result},Resolve$3:function(origin,destination,other){var result=Humper.Hit.Resolve$1(origin.$clone(),destination.$clone(),other.Humper$IBox$Bounds.$clone());return result!=null&&(result.Box=other),result},Resolve:function(origin,destination,other){var broadphaseArea=Humper.Base.RectangleF.Union(origin.$clone(),destination.$clone());return broadphaseArea.Intersects(other.$clone())||broadphaseArea.Contains(other.$clone())?Humper.Hit.ResolveNarrow(origin.$clone(),destination.$clone(),other.$clone()):null},Resolve$1:function(origin,destination,other){var min=Humper.Base.Vector2.Min(origin.$clone(),destination.$clone()),size=Humper.Base.Vector2.op_Subtraction(Humper.Base.Vector2.Max(origin.$clone(),destination.$clone()),min.$clone()),broadphaseArea=new Humper.Base.RectangleF.$ctor2(min.$clone(),size.$clone());return broadphaseArea.Intersects(other.$clone())||broadphaseArea.Contains(other.$clone())?Humper.Hit.ResolveNarrow$1(origin.$clone(),destination.$clone(),other.$clone()):null},Resolve$4:function(point,other){var $t,outside;return other.Humper$IBox$Bounds.Contains$1(point.$clone())?(outside=Humper.Hit.PushOutside$1(point.$clone(),other.Humper$IBox$Bounds.$clone()),$t=new Humper.Hit,$t.Amount=0,$t.Box=other,$t.Position=outside.Item1.$clone(),$t.Normal=outside.Item2.$clone(),$t):null},PushOutside$1:function(origin,other){var position=origin.$clone(),normal=Humper.Base.Vector2.Zero.$clone(),top=origin.Y-other.Top,bottom=other.Bottom-origin.Y,left=origin.X-other.Left,right=other.Right-origin.X,min=Math.min(top,Math.min(bottom,Math.min(right,left)));return Math.abs(min-top)<Humper.Base.Constants.Threshold?(normal=Humper.Base.Vector2.op_UnaryNegation(Humper.Base.Vector2.UnitY.$clone()),position=new Humper.Base.Vector2.$ctor2(position.X,other.Top)):Math.abs(min-bottom)<Humper.Base.Constants.Threshold?(normal=Humper.Base.Vector2.UnitY.$clone(),position=new Humper.Base.Vector2.$ctor2(position.X,other.Bottom)):Math.abs(min-left)<Humper.Base.Constants.Threshold?(normal=Humper.Base.Vector2.op_UnaryNegation(Humper.Base.Vector2.UnitX.$clone()),position=new Humper.Base.Vector2.$ctor2(other.Left,position.Y)):Math.abs(min-right)<Humper.Base.Constants.Threshold&&(normal=Humper.Base.Vector2.UnitX.$clone(),position=new Humper.Base.Vector2.$ctor2(other.Right,position.Y)),{Item1:position.$clone(),Item2:normal.$clone()}},PushOutside:function(origin,other){var position=origin.$clone(),normal=Humper.Base.Vector2.Zero.$clone(),top=origin.Center.Y-other.Top,bottom=other.Bottom-origin.Center.Y,left=origin.Center.X-other.Left,right=other.Right-origin.Center.X,min=Math.min(top,Math.min(bottom,Math.min(right,left)));return Math.abs(min-top)<Humper.Base.Constants.Threshold?(normal=Humper.Base.Vector2.op_UnaryNegation(Humper.Base.Vector2.UnitY.$clone()),position.Location=new Humper.Base.Vector2.$ctor2(position.Location.X,other.Top-position.Height)):Math.abs(min-bottom)<Humper.Base.Constants.Threshold?(normal=Humper.Base.Vector2.UnitY.$clone(),position.Location=new Humper.Base.Vector2.$ctor2(position.Location.X,other.Bottom)):Math.abs(min-left)<Humper.Base.Constants.Threshold?(normal=Humper.Base.Vector2.op_UnaryNegation(Humper.Base.Vector2.UnitX.$clone()),position.Location=new Humper.Base.Vector2.$ctor2(other.Left-position.Width,position.Location.Y)):Math.abs(min-right)<Humper.Base.Constants.Threshold&&(normal=Humper.Base.Vector2.UnitX.$clone(),position.Location=new Humper.Base.Vector2.$ctor2(other.Right,position.Location.Y)),{Item1:position.$clone(),Item2:normal.$clone()}},ResolveNarrow:function(origin,destination,other){var $t,outside,entryTime,exitTime;if(other.Contains(origin.$clone())||other.Intersects(origin.$clone()))return outside=Humper.Hit.PushOutside(origin.$clone(),other.$clone()),$t=new Humper.Hit,$t.Amount=0,$t.Position=outside.Item1.Location.$clone(),$t.Normal=outside.Item2.$clone(),$t;var velocity=Humper.Base.Vector2.op_Subtraction(destination.Location.$clone(),origin.Location.$clone()),invEntry=new Humper.Base.Vector2,invExit=new Humper.Base.Vector2,entry=new Humper.Base.Vector2,exit=new Humper.Base.Vector2;return(velocity.X>0?(invEntry.X=other.Left-origin.Right,invExit.X=other.Right-origin.Left):(invEntry.X=other.Right-origin.Left,invExit.X=other.Left-origin.Right),velocity.Y>0?(invEntry.Y=other.Top-origin.Bottom,invExit.Y=other.Bottom-origin.Top):(invEntry.Y=other.Bottom-origin.Top,invExit.Y=other.Top-origin.Bottom),Math.abs(velocity.X)<Humper.Base.Constants.Threshold?(entry.X=-340282347e30,exit.X=340282347e30):(entry.X=invEntry.X/velocity.X,exit.X=invExit.X/velocity.X),Math.abs(velocity.Y)<Humper.Base.Constants.Threshold?(entry.Y=-340282347e30,exit.Y=340282347e30):(entry.Y=invEntry.Y/velocity.Y,exit.Y=invExit.Y/velocity.Y),entry.Y>1&&(entry.Y=-340282347e30),entry.X>1&&(entry.X=-340282347e30),entryTime=Math.max(entry.X,entry.Y),exitTime=Math.min(exit.X,exit.Y),entryTime>exitTime||entry.X<0&&entry.Y<0||entry.X<0&&(origin.Right<other.Left||origin.Left>other.Right)||entry.Y<0&&(origin.Bottom<other.Top||origin.Top>other.Bottom))?null:($t=new Humper.Hit,$t.Amount=entryTime,$t.Position=Humper.Base.Vector2.op_Addition(origin.Location.$clone(),Humper.Base.Vector2.op_Multiply$1(velocity.$clone(),entryTime)),$t.Normal=Humper.Hit.GetNormal(invEntry.$clone(),invExit.$clone(),entry.$clone()),$t)},ResolveNarrow$1:function(origin,destination,other){var $t,outside,entryTime,exitTime;if(other.Contains$1(origin.$clone()))return outside=Humper.Hit.PushOutside$1(origin.$clone(),other.$clone()),$t=new Humper.Hit,$t.Amount=0,$t.Position=outside.Item1.$clone(),$t.Normal=outside.Item2.$clone(),$t;var velocity=Humper.Base.Vector2.op_Subtraction(destination.$clone(),origin.$clone()),invEntry=new Humper.Base.Vector2,invExit=new Humper.Base.Vector2,entry=new Humper.Base.Vector2,exit=new Humper.Base.Vector2;return(velocity.X>0?(invEntry.X=other.Left-origin.X,invExit.X=other.Right-origin.X):(invEntry.X=other.Right-origin.X,invExit.X=other.Left-origin.X),velocity.Y>0?(invEntry.Y=other.Top-origin.Y,invExit.Y=other.Bottom-origin.Y):(invEntry.Y=other.Bottom-origin.Y,invExit.Y=other.Top-origin.Y),Math.abs(velocity.X)<Humper.Base.Constants.Threshold?(entry.X=-340282347e30,exit.X=340282347e30):(entry.X=invEntry.X/velocity.X,exit.X=invExit.X/velocity.X),Math.abs(velocity.Y)<Humper.Base.Constants.Threshold?(entry.Y=-340282347e30,exit.Y=340282347e30):(entry.Y=invEntry.Y/velocity.Y,exit.Y=invExit.Y/velocity.Y),entry.Y>1&&(entry.Y=-340282347e30),entry.X>1&&(entry.X=-340282347e30),entryTime=Math.max(entry.X,entry.Y),exitTime=Math.min(exit.X,exit.Y),entryTime>exitTime||entry.X<0&&entry.Y<0||entry.X<0&&(origin.X<other.Left||origin.X>other.Right)||entry.Y<0&&(origin.Y<other.Top||origin.Y>other.Bottom))?null:($t=new Humper.Hit,$t.Amount=entryTime,$t.Position=Humper.Base.Vector2.op_Addition(origin.$clone(),Humper.Base.Vector2.op_Multiply$1(velocity.$clone(),entryTime)),$t.Normal=Humper.Hit.GetNormal(invEntry.$clone(),invExit.$clone(),entry.$clone()),$t)},GetNormal:function(invEntry,invExit,entry){return entry.X>entry.Y?invEntry.X<0||Math.abs(invEntry.X)<Humper.Base.Constants.Threshold&&invExit.X<0?Humper.Base.Vector2.UnitX:Humper.Base.Vector2.op_UnaryNegation(Humper.Base.Vector2.UnitX.$clone()):invEntry.Y<0||Math.abs(invEntry.Y)<Humper.Base.Constants.Threshold&&invExit.Y<0?Humper.Base.Vector2.UnitY:Humper.Base.Vector2.op_UnaryNegation(Humper.Base.Vector2.UnitY.$clone())}}},fields:{Box:null,Normal:null,Amount:0,Position:null},props:{Remaining:{get:function(){return 1-this.Amount}}},alias:["Box","Humper$IHit$Box","Normal","Humper$IHit$Normal","Amount","Humper$IHit$Amount","Position","Humper$IHit$Position","Remaining","Humper$IHit$Remaining","IsNearest","Humper$IHit$IsNearest"],ctors:{init:function(){this.Normal=new Humper.Base.Vector2;this.Position=new Humper.Base.Vector2},ctor:function(){this.$initialize();this.Normal=Humper.Base.Vector2.Zero.$clone();this.Amount=1}},methods:{IsNearest:function(than,origin){if(this.Amount<than.Humper$IHit$Amount)return!0;else if(this.Amount>than.Humper$IHit$Amount)return!0;var thisDistance=Humper.Base.Vector2.op_Subtraction(origin.$clone(),this.Position.$clone()).LengthSquared(),otherDistance=Humper.Base.Vector2.op_Subtraction(origin.$clone(),than.Humper$IHit$Position.$clone()).LengthSquared();return thisDistance<otherDistance}}});Bridge.define("Humper.Movement",{inherits:[Humper.IMovement],fields:{Hits:null,Origin:null,Destination:null,Goal:null},props:{HasCollided:{get:function(){return System.Linq.Enumerable.from(this.Hits,Humper.IHit).any()}}},alias:["Hits","Humper$IMovement$Hits","HasCollided","Humper$IMovement$HasCollided","Origin","Humper$IMovement$Origin","Destination","Humper$IMovement$Destination","Goal","Humper$IMovement$Goal"],ctors:{init:function(){this.Origin=new Humper.Base.RectangleF;this.Destination=new Humper.Base.RectangleF;this.Goal=new Humper.Base.RectangleF},ctor:function(){this.$initialize();this.Hits=System.Array.init(0,null,Humper.IHit)}}});Bridge.define("Humper.Responses.BounceResponse",{inherits:[Humper.Responses.ICollisionResponse],fields:{Destination:null},alias:["Destination","Humper$Responses$ICollisionResponse$Destination"],ctors:{init:function(){this.Destination=new Humper.Base.RectangleF},ctor:function(collision){this.$initialize();var velocity=Humper.Base.Vector2.op_Subtraction(collision.Humper$ICollision$Goal.Center.$clone(),collision.Humper$ICollision$Origin.Center.$clone()),deflected=Humper.Base.Vector2.op_Multiply$1(velocity.$clone(),collision.Humper$ICollision$Hit.Humper$IHit$Amount);Math.abs(collision.Humper$ICollision$Hit.Humper$IHit$Normal.X)>1e-5&&(deflected.X*=-1);Math.abs(collision.Humper$ICollision$Hit.Humper$IHit$Normal.Y)>1e-5&&(deflected.Y*=-1);this.Destination=new Humper.Base.RectangleF.$ctor2(Humper.Base.Vector2.op_Addition(collision.Humper$ICollision$Hit.Humper$IHit$Position.$clone(),deflected.$clone()),collision.Humper$ICollision$Goal.Size.$clone())}}});Bridge.define("Humper.Responses.CollisionResponse",{inherits:[Humper.Responses.ICollisionResponse],statics:{methods:{Create:function(col,response){return response===Humper.Responses.CollisionResponses.None?null:new Humper.Responses.CollisionResponse(col,response)}}},fields:{child:null},props:{Destination:{get:function(){return this.child.Humper$Responses$ICollisionResponse$Destination.$clone()}}},alias:["Destination","Humper$Responses$ICollisionResponse$Destination"],ctors:{ctor:function(col,response){this.$initialize();switch(response){case Humper.Responses.CollisionResponses.Touch:this.child=new Humper.Responses.TouchResponse(col);break;case Humper.Responses.CollisionResponses.Cross:this.child=new Humper.Responses.CrossResponse(col);break;case Humper.Responses.CollisionResponses.Slide:this.child=new Humper.SlideResponse(col);break;case Humper.Responses.CollisionResponses.Bounce:this.child=new Humper.Responses.BounceResponse(col);break;default:throw new System.ArgumentException.$ctor1("Unsupported collision type");}}}});Bridge.define("Humper.Responses.CrossResponse",{inherits:[Humper.Responses.ICollisionResponse],fields:{Destination:null},alias:["Destination","Humper$Responses$ICollisionResponse$Destination"],ctors:{init:function(){this.Destination=new Humper.Base.RectangleF},ctor:function(collision){this.$initialize();this.Destination=collision.Humper$ICollision$Goal.$clone()}}});Bridge.define("Humper.Responses.TouchResponse",{inherits:[Humper.Responses.ICollisionResponse],fields:{Destination:null},alias:["Destination","Humper$Responses$ICollisionResponse$Destination"],ctors:{init:function(){this.Destination=new Humper.Base.RectangleF},ctor:function(collision){this.$initialize();this.Destination=new Humper.Base.RectangleF.$ctor2(collision.Humper$ICollision$Hit.Humper$IHit$Position.$clone(),collision.Humper$ICollision$Goal.Size.$clone())}}});Bridge.define("Humper.SlideResponse",{inherits:[Humper.Responses.ICollisionResponse],fields:{Destination:null},alias:["Destination","Humper$Responses$ICollisionResponse$Destination"],ctors:{init:function(){this.Destination=new Humper.Base.RectangleF},ctor:function(collision){this.$initialize();var velocity=Humper.Base.Vector2.op_Subtraction(collision.Humper$ICollision$Goal.Center.$clone(),collision.Humper$ICollision$Origin.Center.$clone()),normal=collision.Humper$ICollision$Hit.Humper$IHit$Normal.$clone(),dot=collision.Humper$ICollision$Hit.Humper$IHit$Remaining*(velocity.X*normal.Y+velocity.Y*normal.X),slide=Humper.Base.Vector2.op_Multiply$1(new Humper.Base.Vector2.$ctor2(normal.Y,normal.X),dot);this.Destination=new Humper.Base.RectangleF.$ctor2(Humper.Base.Vector2.op_Addition(collision.Humper$ICollision$Hit.Humper$IHit$Position.$clone(),slide.$clone()),collision.Humper$ICollision$Goal.Size.$clone())}}});Bridge.define("Humper.World",{inherits:[Humper.IWorld],fields:{grid:null},props:{Bounds:{get:function(){return new Humper.Base.RectangleF.$ctor3(0,0,this.grid.Width,this.grid.Height)}}},alias:["Create","Humper$IWorld$Create","Find$1","Humper$IWorld$Find$1","Find","Humper$IWorld$Find","Remove","Humper$IWorld$Remove","Update","Humper$IWorld$Update","Hit$2","Humper$IWorld$Hit$2","Hit$1","Humper$IWorld$Hit$1","Hit","Humper$IWorld$Hit","Simulate","Humper$IWorld$Simulate","DrawDebug","Humper$IWorld$DrawDebug"],ctors:{ctor:function(width,height,cellSize){cellSize===void 0&&(cellSize=64);this.$initialize();var iwidth=Bridge.Int.clip32(Math.ceil(width/cellSize)),iheight=Bridge.Int.clip32(Math.ceil(height/cellSize));this.grid=new Humper.Grid(iwidth,iheight,cellSize)}},methods:{Create:function(x,y,width,height){var box=new Humper.Box(this,x,y,width,height);return this.grid.Add(box),box},Find$1:function(x,y,w,h){return x=Math.max(0,Math.min(x,this.Bounds.Right-w)),y=Math.max(0,Math.min(y,this.Bounds.Bottom-h)),this.grid.QueryBoxes(x,y,w,h)},Find:function(area){return this.Find$1(area.X,area.Y,area.Width,area.Height)},Remove:function(box){return this.grid.Remove(box)},Update:function(box,from){this.grid.Update(box,from.$clone())},Hit$2:function(point,ignoring){var $t,boxes,other,hit;ignoring===void 0&&(ignoring=null);boxes=this.Find$1(point.X,point.Y,0,0);ignoring!=null&&(boxes=System.Linq.Enumerable.from(boxes,Humper.IBox).except(ignoring));$t=Bridge.getEnumerator(boxes,Humper.IBox);try{while($t.moveNext())if(other=$t.Current,hit=Humper.Hit.Resolve$4(point.$clone(),other),hit!=null)return hit}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return null},Hit$1:function(origin,destination,ignoring){var $t,nearest,other,hit;ignoring===void 0&&(ignoring=null);var min=Humper.Base.Vector2.Min(origin.$clone(),destination.$clone()),max=Humper.Base.Vector2.Max(origin.$clone(),destination.$clone()),wrap=new Humper.Base.RectangleF.$ctor2(min.$clone(),Humper.Base.Vector2.op_Subtraction(max.$clone(),min.$clone())),boxes=this.Find$1(wrap.X,wrap.Y,wrap.Width,wrap.Height);ignoring!=null&&(boxes=System.Linq.Enumerable.from(boxes,Humper.IBox).except(ignoring));nearest=null;$t=Bridge.getEnumerator(boxes,Humper.IBox);try{while($t.moveNext())other=$t.Current,hit=Humper.Hit.Resolve$3(origin.$clone(),destination.$clone(),other),hit!=null&&(nearest==null||hit.Humper$IHit$IsNearest(nearest,origin.$clone()))&&(nearest=hit)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return nearest},Hit:function(origin,destination,ignoring){var $t,wrap,boxes,nearest,other,hit;ignoring===void 0&&(ignoring=null);wrap=new Humper.Base.RectangleF.$ctor1(origin.$clone(),destination.$clone());boxes=this.Find$1(wrap.X,wrap.Y,wrap.Width,wrap.Height);ignoring!=null&&(boxes=System.Linq.Enumerable.from(boxes,Humper.IBox).except(ignoring));nearest=null;$t=Bridge.getEnumerator(boxes,Humper.IBox);try{while($t.moveNext())other=$t.Current,hit=Humper.Hit.Resolve$2(origin.$clone(),destination.$clone(),other),hit!=null&&(nearest==null||hit.Humper$IHit$IsNearest(nearest,origin.Location.$clone()))&&(nearest=hit)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return nearest},Simulate:function(box,x,y,filter){var $t,origin=box.Bounds.$clone(),destination=new Humper.Base.RectangleF.$ctor3(x,y,box.Width,box.Height),hits=new(System.Collections.Generic.List$1(Humper.IHit).ctor);return $t=new Humper.Movement,$t.Origin=origin.$clone(),$t.Goal=destination.$clone(),$t.Destination=this.Simulate$1(hits,function(_o1){return _o1.add(box),_o1}(new(System.Collections.Generic.List$1(Humper.IBox).ctor)),box,origin.$clone(),destination.$clone(),filter),$t.Hits=hits,$t},Simulate$1:function(hits,ignoring,box,origin,destination,filter){var $t,nearest=this.Hit(origin.$clone(),destination.$clone(),ignoring);if(nearest!=null){hits.add(nearest);var impact=new Humper.Base.RectangleF.$ctor2(nearest.Humper$IHit$Position.$clone(),origin.Size.$clone()),collision=($t=new Humper.Collision,$t.Box=box,$t.Hit=nearest,$t.Goal=destination.$clone(),$t.Origin=origin.$clone(),$t),response=filter(collision);if(nearest.Humper$IHit$Box.Humper$IBox$TriggerOnly)return ignoring.add(nearest.Humper$IHit$Box),destination.$clone();if(response!=null&&Humper.Base.RectangleF.op_Inequality(destination.$clone(),response.Humper$Responses$ICollisionResponse$Destination.$clone()))return ignoring.add(nearest.Humper$IHit$Box),this.Simulate$1(hits,ignoring,box,impact.$clone(),response.Humper$Responses$ICollisionResponse$Destination.$clone(),filter)}return destination.$clone()},DrawDebug:function(x,y,w,h,drawCell,drawBox,drawString){var $t,$t1,boxes=this.grid.QueryBoxes(x,y,w,h),box,cells;$t=Bridge.getEnumerator(boxes,Humper.IBox);try{while($t.moveNext())box=$t.Current,drawBox(box)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}cells=this.grid.QueryCells(x,y,w,h);$t1=Bridge.getEnumerator(cells,Humper.Grid.Cell);try{while($t1.moveNext()){var cell=$t1.Current,count=cell.Count(),alpha=count>0?1:.4;drawCell(Bridge.Int.clip32(cell.Bounds.X),Bridge.Int.clip32(cell.Bounds.Y),Bridge.Int.clip32(cell.Bounds.Width),Bridge.Int.clip32(cell.Bounds.Height),alpha);drawString(Bridge.toString(count),Bridge.Int.clip32(cell.Bounds.Center.X),Bridge.Int.clip32(cell.Bounds.Center.Y),alpha)}}finally{Bridge.is($t1,System.IDisposable)&&$t1.System$IDisposable$Dispose()}}}});Bridge.define("JuiceboxEngine.Animations.Animation",{inherits:[JuiceboxEngine.Resources.IResource],fields:{Name:null,Frames:null,Loaded:!1,FrameCount:0},alias:["Name","JuiceboxEngine$Resources$IResource$Name","Loaded","JuiceboxEngine$Resources$IResource$Loaded","Unload","JuiceboxEngine$Resources$IResource$Unload"],ctors:{ctor:function(){this.$initialize();this.Frames=new(System.Collections.Generic.List$1(JuiceboxEngine.Animations.AnimationFrame).ctor);this.FrameCount=0}},methods:{Unload:function(){}}});Bridge.define("JuiceboxEngine.Animations.AnimatorLoader",{inherits:[JuiceboxEngine.Resources.ResourceLoader],ctors:{ctor:function(){this.$initialize();JuiceboxEngine.Resources.ResourceLoader.ctor.call(this,"AnimationLoader","anim")}},methods:{Load:function(path){var $t,anim=new JuiceboxEngine.Animations.Animation,data=JuiceboxEngine.Util.JSON.GetDynamicFromJSON(System.IO.File.ReadAllText(path));$t=Bridge.getEnumerator(data.frames);try{while($t.moveNext()){var frame=Bridge.cast($t.Current,System.Object),animFrame=new JuiceboxEngine.Animations.AnimationFrame,sourceRect=frame.frame;animFrame.Duration=frame.duration/1e3;animFrame.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(sourceRect.x,sourceRect.y,sourceRect.w,sourceRect.h);anim.Frames.add(animFrame)}}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return anim.Loaded=!0,anim.Name=path,anim.FrameCount=anim.Frames.Count,anim}}});Bridge.define("JuiceboxEngine.Audio.AudioClip",{inherits:[JuiceboxEngine.Resources.IResource],fields:{Name:null,Loaded:!1,_howl:null},alias:["Name","JuiceboxEngine$Resources$IResource$Name","Loaded","JuiceboxEngine$Resources$IResource$Loaded","Unload","JuiceboxEngine$Resources$IResource$Unload"],ctors:{ctor:function(howl){this.$initialize();this._howl=howl}},methods:{Play:function(){return this._howl.play()},Play$1:function(id){this._howl.play(id)},OnEnd:function(id,onEnd){this._howl.on("end",function(){onEnd()},id)},Pause:function(id){this._howl.pause(id)},SetPlaybackSpeed:function(id,speed){this._howl.rate(speed,id)},Seek:function(id,seconds){this._howl.seek(seconds,id)},Loop:function(id,loop){this._howl.loop(loop,id)},Stop:function(id){this._howl.stop(id)},SetVolume:function(id,volume){this._howl.volume(volume,id)},SetGlobalVolume:function(volume){this._howl.volume(volume)},Unload:function(){this._howl.unload()}}});Bridge.define("JuiceboxEngine.Audio.AudioComponent",{inherits:[JuiceboxEngine.Component],fields:{_clip:null,_hasID:!1,_id:0,Playing:!1,Volume:0,PlaybackSpeed:0,Looping:!1},methods:{Initialize:function(resourceManager){this.Reset()},Reset:function(){this.Volume=1;this.PlaybackSpeed=1;this.Looping=!1},SetAudioClip:function(clip,reset){reset===void 0&&(reset=!1);this._clip!=null&&this._clip.Stop(this._id);this._clip=clip;this._hasID=!1;this._id=0;this.Playing=!1;reset&&this.Reset()},Play:function(){this._clip!=null&&(this.Playing=!0,this._hasID?this._clip.Play$1(this._id):(this._id=this._clip.Play(),this._hasID=!0,this.SetVolume(this.Volume),this.SetPlaybackSpeed(this.PlaybackSpeed),this.Loop(this.Looping),this._clip.OnEnd(this._id,Bridge.fn.bind(this,function(){this.Looping||(this.Playing=!1,this._hasID=!1)}))))},Pause:function(){this._clip!=null&&(this.Playing=!1,this._hasID&&this._clip.Pause(this._id))},Stop:function(){this._clip!=null&&(this.Playing=!1,this._hasID&&(this._clip.Stop(this._id),this._hasID=!1))},SetVolume:function(volume){(this.Volume=volume,this._clip!=null)&&this._hasID&&this._clip.SetVolume(this._id,volume)},Loop:function(loop){(this.Looping=loop,this._clip!=null)&&this._hasID&&this._clip.Loop(this._id,loop)},SetPlaybackSpeed:function(speed){this._clip!=null&&speed!==this.PlaybackSpeed&&(this.PlaybackSpeed=speed,this._hasID&&this._clip.SetPlaybackSpeed(this._id,speed))},Unique:function(){return!1},Update:function(){},Destroy:function(){this._clip!=null&&this._clip.Stop(this._id)}}});Bridge.define("JuiceboxEngine.Audio.AudioLoader",{inherits:[JuiceboxEngine.Resources.ResourceLoader],ctors:{ctor:function(){this.$initialize();JuiceboxEngine.Resources.ResourceLoader.ctor.call(this,"AudioLoader","mp3")}},methods:{Load:function(path){var props={},howl,clip;props.src=path;props.autoplay=!1;props.loop=!1;howl=new Howl(props);clip=new JuiceboxEngine.Audio.AudioClip(howl);howl.on("load",function(){clip.Loaded=!0});return clip}}});Bridge.define("JuiceboxEngine.Camera",{inherits:[JuiceboxEngine.Component],fields:{ClearColor:null,PerspectiveCamera:!1,PixelPerfect:!1,Target:null,PixelSize:0,Zoom:0},props:{ViewMatrix:{get:function(){var pos=this.Parent.Transform.Position.$clone();return(this.PixelPerfect&&(pos=new JuiceboxEngine.Math.Vector3.$ctor2(JuiceboxEngine.Math.JMath.Round(this.Parent.Transform.Position.X),JuiceboxEngine.Math.JMath.Round(this.Parent.Transform.Position.Y),Bridge.Int.clip32(this.Parent.Transform.Position.Z))),!this.PerspectiveCamera)?JuiceboxEngine.Math.Matrix4.CreateLookAt(pos.$clone(),new JuiceboxEngine.Math.Vector3.$ctor2(pos.X,pos.Y,1),new JuiceboxEngine.Math.Vector3.$ctor2(0,-1,0)):JuiceboxEngine.Math.Matrix4.CreateLookAt(pos.$clone(),new JuiceboxEngine.Math.Vector3.$ctor2(0,0,0),new JuiceboxEngine.Math.Vector3.$ctor2(0,1,0))}},ProjMatrix:{get:function(){return this.PerspectiveCamera?JuiceboxEngine.Math.Matrix4.CreatePerspectiveFieldOfView(1.57079637,this.Target.Width/this.Target.Height,.1,1e3):JuiceboxEngine.Math.Matrix4.CreateOrthographic(this.Target.Width/this.Zoom,this.Target.Height/this.Zoom,0,100)}},Frustum:{get:function(){var width=this.Target.Width/this.Zoom,height=this.Target.Height/this.Zoom;return new JuiceboxEngine.Math.RectangleF.$ctor2(this.Parent.Transform.Position2D.X-width/2,this.Parent.Transform.Position2D.Y-height/2,width,height)}}},ctors:{init:function(){this.ClearColor=new JuiceboxEngine.Math.Color}},methods:{Initialize:function(resourceManager){this.PixelSize=JuiceboxEngine.Util.Config.ConfigValues.PixelSize;this.PixelPerfect=JuiceboxEngine.Util.Config.ConfigValues.PixelPerfect;this.PerspectiveCamera=!1;this.Zoom=1;this.CreateRenderTarget();JuiceboxEngine.Graphics.GraphicsManager.Instance.addOnResize(Bridge.fn.cacheBind(this,this.Resize))},Resize:function(width,height){JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.DeleteRenderTarget(this.Target);this.CreateRenderTarget()},CreateRenderTarget:function(){this.Target=new JuiceboxEngine.Graphics.RenderTarget(Bridge.Int.div(JuiceboxEngine.Graphics.GraphicsManager.Instance.Width,this.PixelSize)|0,Bridge.Int.div(JuiceboxEngine.Graphics.GraphicsManager.Instance.Height,this.PixelSize)|0)},Unique:function(){return!0},ScreenPointToWorld:function(point){return new JuiceboxEngine.Math.Vector2.$ctor3((point.X*2-1)/this.Zoom*this.Target.Width/2+this.Parent.Transform.Position.X,(point.Y*2-1)/this.Zoom*this.Target.Height/2+this.Parent.Transform.Position.Y)},WorldToScreenPoint:function(world){var x=((world.X-this.Parent.Transform.Position.X)/(this.Target.Width/2)*this.Zoom+1)/2,y=((world.Y-this.Parent.Transform.Position.Y)/(this.Target.Height/2)*this.Zoom+1)/2;return new JuiceboxEngine.Math.Vector2.$ctor3(x,y)},Update:function(){},Destroy:function(){JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.DeleteRenderTarget(this.Target)}}});Bridge.define("JuiceboxEngine.Coroutines.WaitForAllCoroutines",{inherits:[JuiceboxEngine.Coroutines.YieldInstruction],fields:{_coroutines:null},ctors:{ctor:function(coroutines){coroutines===void 0&&(coroutines=[]);this.$initialize();JuiceboxEngine.Coroutines.YieldInstruction.ctor.call(this);this._coroutines=coroutines},$ctor1:function(coroutines){coroutines===void 0&&(coroutines=[]);this.$initialize();JuiceboxEngine.Coroutines.YieldInstruction.ctor.call(this);this._coroutines=System.Array.init(coroutines.length,null,JuiceboxEngine.Coroutines.Coroutine);for(var i=0;i<coroutines.length;i=i+1|0)this._coroutines[i]=JuiceboxEngine.Coroutines.CoroutineManager.StartCoroutine(coroutines[i])}},methods:{Stop:function(){var $t,coroutine;$t=Bridge.getEnumerator(this._coroutines);try{while($t.moveNext())coroutine=$t.Current,coroutine!=null&&JuiceboxEngine.Coroutines.CoroutineManager.StopCoroutine(coroutine)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}},CanContinue:function(){var $t,canContinue=!0,coroutine;$t=Bridge.getEnumerator(this._coroutines);try{while($t.moveNext())coroutine=$t.Current,canContinue=!!(canContinue&!coroutine.MoveNextResult)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return canContinue}}});Bridge.define("JuiceboxEngine.Coroutines.WaitForCoroutine",{inherits:[JuiceboxEngine.Coroutines.YieldInstruction],fields:{_coroutine:null},ctors:{ctor:function(coroutine){this.$initialize();JuiceboxEngine.Coroutines.YieldInstruction.ctor.call(this);this._coroutine=coroutine},$ctor1:function(coroutine){this.$initialize();JuiceboxEngine.Coroutines.YieldInstruction.ctor.call(this);this._coroutine=JuiceboxEngine.Coroutines.CoroutineManager.StartCoroutine(coroutine)}},methods:{Stop:function(){this._coroutine!=null&&JuiceboxEngine.Coroutines.CoroutineManager.StopCoroutine(this._coroutine)},CanContinue:function(){return!this._coroutine.MoveNextResult}}});Bridge.define("JuiceboxEngine.Coroutines.WaitForFirstRoutine",{inherits:[JuiceboxEngine.Coroutines.YieldInstruction],fields:{_coroutines:null},ctors:{ctor:function(coroutines){coroutines===void 0&&(coroutines=[]);this.$initialize();JuiceboxEngine.Coroutines.YieldInstruction.ctor.call(this);this._coroutines=coroutines},$ctor1:function(coroutines){coroutines===void 0&&(coroutines=[]);this.$initialize();JuiceboxEngine.Coroutines.YieldInstruction.ctor.call(this);this._coroutines=System.Array.init(coroutines.length,null,JuiceboxEngine.Coroutines.Coroutine);for(var i=0;i<coroutines.length;i=i+1|0)this._coroutines[i]=JuiceboxEngine.Coroutines.CoroutineManager.StartCoroutine(coroutines[i])}},methods:{Stop:function(){var $t,coroutine;$t=Bridge.getEnumerator(this._coroutines);try{while($t.moveNext())coroutine=$t.Current,coroutine!=null&&JuiceboxEngine.Coroutines.CoroutineManager.StopCoroutine(coroutine)}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}},CanContinue:function(){var $t,coroutine;$t=Bridge.getEnumerator(this._coroutines);try{while($t.moveNext())if(coroutine=$t.Current,!coroutine.MoveNextResult)return!1}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return!0}}});Bridge.define("JuiceboxEngine.Coroutines.WaitForFrame",{inherits:[JuiceboxEngine.Coroutines.YieldInstruction],methods:{CanContinue:function(){return!0}}});Bridge.define("JuiceboxEngine.Coroutines.WaitForSeconds",{inherits:[JuiceboxEngine.Coroutines.YieldInstruction],fields:{_secondsToWait:0},ctors:{ctor:function(seconds){this.$initialize();JuiceboxEngine.Coroutines.YieldInstruction.ctor.call(this);this._secondsToWait=seconds}},methods:{CanContinue:function(){return this._secondsToWait-=JuiceboxEngine.Util.Time.DeltaTime,this._secondsToWait<=0}}});Bridge.define("JuiceboxEngine.Coroutines.WaitForSecondsRealTime",{inherits:[JuiceboxEngine.Coroutines.YieldInstruction],fields:{_secondsToWait:0},ctors:{ctor:function(seconds){this.$initialize();JuiceboxEngine.Coroutines.YieldInstruction.ctor.call(this);this._secondsToWait=seconds}},methods:{CanContinue:function(){return this._secondsToWait-=JuiceboxEngine.Util.Time.DeltaTimeRealTime,this._secondsToWait<=0}}});Bridge.define("JuiceboxEngine.Coroutines.WaitUntilTrue",{inherits:[JuiceboxEngine.Coroutines.YieldInstruction],fields:{_fn:null},ctors:{ctor:function(fn){this.$initialize();JuiceboxEngine.Coroutines.YieldInstruction.ctor.call(this);this._fn=fn}},methods:{CanContinue:function(){return this._fn()}}});Bridge.define("JuiceboxEngine.Graphics.Font",{inherits:[JuiceboxEngine.Resources.IResource],fields:{Name:null,Loaded:!1,Texture:null,_width:0,_height:0,_charOffset:0,_charWidths:null,_cellWidth:0,_cellHeight:0,_rowCount:0},alias:["Name","JuiceboxEngine$Resources$IResource$Name","Loaded","JuiceboxEngine$Resources$IResource$Loaded","Unload","JuiceboxEngine$Resources$IResource$Unload"],ctors:{ctor:function(width,height,charOffset,charWidths,cellWidth,cellHeight,texture){this.$initialize();this._width=width;this._height=height;this._charOffset=charOffset;this._charWidths=charWidths;this._cellWidth=cellWidth;this._cellHeight=cellHeight;this._rowCount=Bridge.Int.div(width,this._cellWidth)|0;this.Texture=texture}},methods:{GenerateBufferInRect:function(text,color,rectangle){var $t,word,width;if(System.String.isNullOrEmpty(text))return System.Array.init(0,0,System.Single);var currentLine="",realText="",words=System.String.split(text,[32].map(function(i){return String.fromCharCode(i)}));$t=Bridge.getEnumerator(words);try{while($t.moveNext())word=$t.Current,width=this.GetWidth((currentLine||"")+(word||"")),width>rectangle.Width?(realText=(realText||"")+((currentLine||"")+String.fromCharCode(10)||""),currentLine=(word||"")+" "):currentLine=(currentLine||"")+((word||"")+" "||"")}finally{Bridge.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}return realText=(realText||"")+(currentLine||""),this.GenerateBuffer(realText,color.$clone(),new JuiceboxEngine.Math.Vector3.$ctor2(rectangle.Left,rectangle.Top-this._cellHeight|0,.5))},GenerateBuffer:function(text,color,offset){for(var c,rawData=System.Array.init(Bridge.Int.mul(Bridge.Int.mul(text.length,9),6),0,System.Single),colorR=color.R,colorG=color.G,colorB=color.B,colorA=color.A,curPos=offset.$clone(),i=0;i<text.length;i=i+1|0){if(c=text.charCodeAt(i),c===10){curPos=new JuiceboxEngine.Math.Vector3.$ctor2(offset.X,curPos.Y-this._cellHeight,offset.Z);continue}if(!(c<this._charOffset)){var no=c-this._charOffset|0,texWidth=this._charWidths[c],texHeight=this._cellHeight,yCell=Bridge.Int.div(no,Bridge.Int.div(this._height,this._cellHeight)|0)|0,xCell=no-Bridge.Int.mul(yCell,Bridge.Int.div(this._width,this._cellWidth)|0)|0,charTexWidth=this._charWidths[c]/this._width,charTexHeight=this._cellHeight/this._height,texX=xCell*(this._cellWidth/this._width),texY=(yCell+1|0)*(this._cellHeight/this._height);this.BufferVertex(rawData,Bridge.Int.mul(Bridge.Int.mul(i,9),6)+0|0,[curPos.X,curPos.Y,curPos.Z,texX,texY,colorR,colorG,colorB,colorA]);this.BufferVertex(rawData,Bridge.Int.mul(Bridge.Int.mul(i,9),6)+9|0,[curPos.X+texWidth,curPos.Y,curPos.Z,texX+charTexWidth,texY,colorR,colorG,colorB,colorA]);this.BufferVertex(rawData,Bridge.Int.mul(Bridge.Int.mul(i,9),6)+18|0,[curPos.X,curPos.Y+texHeight,curPos.Z,texX,texY-charTexHeight,colorR,colorG,colorB,colorA]);this.BufferVertex(rawData,Bridge.Int.mul(Bridge.Int.mul(i,9),6)+27|0,[curPos.X+texWidth,curPos.Y,curPos.Z,texX+charTexWidth,texY,colorR,colorG,colorB,colorA]);this.BufferVertex(rawData,Bridge.Int.mul(Bridge.Int.mul(i,9),6)+36|0,[curPos.X,curPos.Y+texHeight,curPos.Z,texX,texY-charTexHeight,colorR,colorG,colorB,colorA]);this.BufferVertex(rawData,Bridge.Int.mul(Bridge.Int.mul(i,9),6)+45|0,[curPos.X+texWidth,curPos.Y+texHeight,curPos.Z,texX+charTexWidth,texY-charTexHeight,colorR,colorG,colorB,colorA]);curPos=new JuiceboxEngine.Math.Vector3.$ctor2(curPos.X+texWidth,curPos.Y,curPos.Z)}}return rawData},GetWidth:function(text){for(var c,no,texWidth,width=0,i=0;i<text.length;i=i+1|0){if(c=text.charCodeAt(i),c===10){width=0;continue}c<this._charOffset||(no=c-this._charOffset|0,texWidth=this._charWidths[c],width+=texWidth)}return width},BufferVertex:function(buffer,offset,data){data===void 0&&(data=[]);buffer[offset+0|0]=data[0];buffer[offset+1|0]=data[1];buffer[offset+2|0]=data[2];buffer[offset+3|0]=data[3];buffer[offset+4|0]=data[4];buffer[offset+5|0]=data[5];buffer[offset+6|0]=data[6];buffer[offset+7|0]=data[7];buffer[offset+8|0]=data[8]},Unload:function(){JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.DeleteTexture(this.Texture);this.Loaded=!1}}});Bridge.define("JuiceboxEngine.Graphics.FontResourceLoader",{inherits:[JuiceboxEngine.Resources.ResourceLoader],fields:{_textureLoader:null},ctors:{ctor:function(textureLoader){this.$initialize();JuiceboxEngine.Resources.ResourceLoader.ctor.call(this,"FontLoader","bff");this._textureLoader=textureLoader}},methods:{Load:function(path){var textureWidth,textureHeight,charOffset,charWidths,cellWidth,cellHeight,filestream=new System.IO.FileStream.$ctor1(path,3),reader=new System.IO.BinaryReader.ctor(filestream),h0=reader.ReadByte(),h1=reader.ReadByte(),texture,font;return h0!==191||h1!==242?(JuiceboxEngine.Logger.Error("Unable to load font format. Make sure it is a .bff file. This file should be generated from CBFG."),null):(textureWidth=reader.ReadInt32(),textureHeight=reader.ReadInt32(),cellWidth=reader.ReadInt32(),cellHeight=reader.ReadInt32(),reader.ReadByte(),charOffset=reader.ReadByte(),charWidths=reader.ReadBytes(256),texture=Bridge.cast(this._textureLoader.Load(System.String.replaceAll(path,".bff",".png")),JuiceboxEngine.Graphics.Texture2D),reader.Close(),font=new JuiceboxEngine.Graphics.Font(textureWidth,textureHeight,charOffset,charWidths,cellWidth,cellHeight,texture),font.Loaded=!0,font)}}});Bridge.define("JuiceboxEngine.Graphics.Texture2D",{inherits:[JuiceboxEngine.Resources.IResource],fields:{_sample:0,_wrap:0,Width:0,Height:0,Texture:null,Name:null,sortValue:0,Loaded:!1},events:{onLoad:null},props:{Sample:{get:function(){return this._sample},set:function(value){this._sample=value;JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.UpdateTexture(this)}},Wrap:{get:function(){return this._wrap},set:function(value){this._wrap=value;JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.UpdateTexture(this)}}},alias:["Name","JuiceboxEngine$Resources$IResource$Name","Loaded","JuiceboxEngine$Resources$IResource$Loaded","Unload","JuiceboxEngine$Resources$IResource$Unload"],ctors:{ctor:function(){this.$initialize();this.Width=1;this.Height=1;this.Texture=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.DefaultTexture;this.Loaded=!0},$ctor1:function(width,height,data){this.$initialize();this.Width=width;this.Height=height;this.Texture=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.CreateTexture$1(width,height,data);this.Loaded=!0}},methods:{GetPixels:function(rect){return this.Loaded?JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.GetPixels(this,rect.$clone()):null},FinishLoad:function(){Bridge.staticEquals(this.onLoad,null)?null:this.onLoad(this,null);this.Loaded=!0},Unload:function(){JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.DeleteTexture(this);this.Loaded=!1}}});Bridge.define("JuiceboxEngine.Graphics.ShaderProgram",{inherits:[JuiceboxEngine.Resources.IResource],fields:{Name:null,Program:null,UniformLocations:null,VertexAttribLocations:null,DefaultShaderValues:null,Loaded:!1},alias:["Name","JuiceboxEngine$Resources$IResource$Name","Loaded","JuiceboxEngine$Resources$IResource$Loaded","Unload","JuiceboxEngine$Resources$IResource$Unload"],ctors:{ctor:function(vertSource,fragSource){this.$initialize();this.Program=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.CompileShader(vertSource,fragSource);this.UniformLocations=new(System.Collections.Generic.Dictionary$2(System.String,JuiceboxEngine.Graphics.ShaderProgram.UniformLocation).ctor);this.VertexAttribLocations=new(System.Collections.Generic.Dictionary$2(System.String,System.Int32).ctor);JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.CacheLocations(this)}},methods:{Unload:function(){JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.DeleteShader(this);this.Loaded=!1}}});Bridge.define("JuiceboxEngine.Graphics.ShaderResourceLoader",{inherits:[JuiceboxEngine.Resources.ResourceLoader],ctors:{ctor:function(){this.$initialize();JuiceboxEngine.Resources.ResourceLoader.ctor.call(this,"ShaderLoader","vert")}},methods:{Load:function(path){var $t,$t1;System.String.contains(path,".")||(path=(path||"")+".");var vertPath=(($t=System.String.split(path,System.Array.init([46],System.Char).map(function(i){return String.fromCharCode(i)}),null,1))[0]||"")+".vert",fragPath=(($t1=System.String.split(path,System.Array.init([46],System.Char).map(function(i){return String.fromCharCode(i)}),null,1))[0]||"")+".frag",vertSource=System.IO.File.ReadAllText(vertPath),fragSource=System.IO.File.ReadAllText(fragPath),program=new JuiceboxEngine.Graphics.ShaderProgram(vertSource,fragSource);return program.Loaded=!0,program}}});Bridge.define("JuiceboxEngine.Graphics.TextureResourceLoader",{inherits:[JuiceboxEngine.Resources.ResourceLoader],fields:{_sortValue:0},ctors:{ctor:function(){this.$initialize();JuiceboxEngine.Resources.ResourceLoader.ctor.call(this,"TextureLoader","png");this._sortValue=0}},methods:{Load:function(path){var texture=new JuiceboxEngine.Graphics.Texture2D.ctor,image;return texture.Name=path,texture.Loaded=!1,image=new Image,image.onload=Bridge.fn.bind(this,function(x){texture.Texture=this.OnDataLoaded(image);texture.Width=image.width;texture.Height=image.height;texture.sortValue=this._sortValue;texture.FinishLoad();this._sortValue=this._sortValue+1|0}),image.addEventListener("error",function(){JuiceboxEngine.Logger.Error(System.String.format("Failed to load image {0}!",[path]));texture.FinishLoad()}),image.src=path,texture},OnDataLoaded:function(element){return JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.CreateTexture(element)}}});Bridge.define("JuiceboxEngine.GraphicsComponent",{inherits:[JuiceboxEngine.Component]});Bridge.define("JuiceboxEngine.GUI.EmptyUIElement",{inherits:[JuiceboxEngine.GUI.UIElement],ctors:{$ctor1:function(parent,resourceManager){resourceManager===void 0&&(resourceManager=null);this.$initialize();JuiceboxEngine.GUI.UIElement.$ctor1.call(this,parent,resourceManager)},ctor:function(parent){JuiceboxEngine.GUI.EmptyUIElement.$ctor1.call(this,parent,null)}},methods:{Render:function(){return},UpdateElement:function(){return}}});Bridge.define("JuiceboxEngine.GUI.Image",{inherits:[JuiceboxEngine.GUI.UIElement],fields:{_displayImage:null},props:{DisplayImage:{get:function(){return this._displayImage},set:function(value){this._displayImage=value;this.ForceUpdate()}}},ctors:{ctor:function(parent){this.$initialize();JuiceboxEngine.GUI.UIElement.ctor.call(this,parent);this._command.SetShaderValue("texture",new JuiceboxEngine.Graphics.Texture2D.ctor)}},methods:{Render:function(){JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.Command(this._command)},UpdateElement:function(){var data=System.Array.init([0,0,.5,0,1,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0+this.Dimensions.X,0,.5,1,1,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0+this.Dimensions.X,0+this.Dimensions.Y,.5,1,0,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0,0,.5,0,1,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0,0+this.Dimensions.Y,.5,0,0,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0+this.Dimensions.X,0+this.Dimensions.Y,.5,1,0,this.Color.R,this.Color.G,this.Color.B,this.Color.A],System.Single);this._command.SetShaderValue("texture",this.DisplayImage);this._command.VertexBuffer.UpdateData(new Float32Array(data))}}});Bridge.define("JuiceboxEngine.GUI.Panel",{inherits:[JuiceboxEngine.GUI.UIElement],ctors:{ctor:function(parent){this.$initialize();JuiceboxEngine.GUI.UIElement.ctor.call(this,parent);this._command.SetShaderValue("texture",new JuiceboxEngine.Graphics.Texture2D.ctor)}},methods:{Render:function(){JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.Command(this._command)},UpdateElement:function(){var data=System.Array.init([0,0,.5,0,0,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0+this.Dimensions.X,0,.5,1,0,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0+this.Dimensions.X,0+this.Dimensions.Y,.5,1,1,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0,0,.5,0,0,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0,0+this.Dimensions.Y,.5,0,1,this.Color.R,this.Color.G,this.Color.B,this.Color.A,0+this.Dimensions.X,0+this.Dimensions.Y,.5,1,1,this.Color.R,this.Color.G,this.Color.B,this.Color.A],System.Single);this._command.VertexBuffer.UpdateData(new Float32Array(data))}}});Bridge.define("JuiceboxEngine.GUI.Text",{inherits:[JuiceboxEngine.GUI.UIElement],fields:{shadowColor:null,_shadow:null,_displayText:null,_font:null,_textAlignment:0,_shadowBuffer:null},props:{Font:{get:function(){return this._font},set:function(value){this._font=value;this.ForceUpdate()}},DisplayText:{get:function(){return this._displayText},set:function(value){Bridge.referenceEquals(this._displayText,value)||(this._displayText=value,this.ForceUpdate())}},TextAlignment:{get:function(){return this._textAlignment},set:function(value){this._textAlignment=value;this.ForceUpdate()}},ShadowOffset:{get:function(){return this._shadow.$clone()},set:function(value){this._shadow=value.$clone();this._shadowBuffer==null&&(this._shadowBuffer=new JuiceboxEngine.Graphics.VertexBuffer.ctor,this._shadowBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_pos",3,!1,36,0)),this._shadowBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_tex",2,!1,36,12)),this._shadowBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_col",4,!1,36,20)));this.ForceUpdate()}},ShadowColor:{get:function(){return this.shadowColor.$clone()},set:function(value){this.shadowColor=value.$clone();this.ForceUpdate()}}},ctors:{init:function(){this.shadowColor=new JuiceboxEngine.Math.Color;this._shadow=new JuiceboxEngine.Math.Point},ctor:function(parent){this.$initialize();JuiceboxEngine.GUI.UIElement.ctor.call(this,parent);this.Font=this.ResourceManager.Load(JuiceboxEngine.Graphics.Font,"Fonts/Arial.bff");this.TextAlignment=JuiceboxEngine.GUI.TextAlignment.Left;this.ShadowColor=JuiceboxEngine.Math.Color.Black.$clone();this._command.SetShaderValue("texture",this.Font.Texture)}},methods:{Render:function(){if(!System.String.isNullOrEmpty(this.DisplayText)){var vertexBuffer=this._command.VertexBuffer;JuiceboxEngine.Math.Point.op_Inequality(this._shadow.$clone(),JuiceboxEngine.Math.Point.Zero.$clone())&&(this._command.VertexBuffer=this._shadowBuffer,JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.Command(this._command));this._command.VertexBuffer=vertexBuffer;JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.Command(this._command)}},UpdateElement:function(){var rectangle,data,rectangleShadow,shadowData;this._command.SetShaderValue("texture",this.Font.Texture);rectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(0,0,Bridge.Int.clip32(this.Dimensions.X),Bridge.Int.clip32(this.Dimensions.Y));data=this.Font.GenerateBufferInRect(this.DisplayText,this.Color.$clone(),rectangle.$clone());this._command.VertexBuffer.UpdateData(new Float32Array(data));this._command.VertexBuffer.VertexRange=this._command.VertexBuffer.CalculateVertexCount(data.length);JuiceboxEngine.Math.Point.op_Inequality(this._shadow.$clone(),JuiceboxEngine.Math.Point.Zero.$clone())&&(rectangleShadow=new JuiceboxEngine.Math.Rectangle.$ctor2(rectangle.X+this._shadow.X|0,rectangle.Y+this._shadow.Y|0,rectangle.Width,rectangle.Height),shadowData=this.Font.GenerateBufferInRect(this.DisplayText,this.ShadowColor.$clone(),rectangleShadow.$clone()),this._shadowBuffer.UpdateData(new Float32Array(shadowData)),this._shadowBuffer.VertexRange=this._command.VertexBuffer.CalculateVertexCount(shadowData.length))}}});Bridge.define("JuiceboxEngine.GUI.UIMouseEvent",{inherits:[JuiceboxEngine.GUI.UIEvent],fields:{position:null,absolutePosition:null},ctors:{init:function(){this.position=new JuiceboxEngine.Math.Vector2;this.absolutePosition=new JuiceboxEngine.Math.Vector2},ctor:function(element,position){this.$initialize();JuiceboxEngine.GUI.UIEvent.ctor.call(this,element);this.position=position.$clone();this.absolutePosition=JuiceboxEngine.Math.Vector2.op_Subtraction(JuiceboxEngine.Math.Vector2.op_Addition(position.$clone(),element.AbsolutePosition.$clone()),element.RootElement.Position.$clone())}}});Bridge.define("JuiceboxEngine.Networking.WorldSendable",{inherits:[JuiceboxEngine.Networking.Sendable],fields:{timeStamp:0},methods:{GetSceme:function(){var sceme=new JuiceboxEngine.Networking.Sceme;return sceme.AddFloat("timeStamp",8),sceme}}});Bridge.define("JuiceboxEngine.PhysicsComponent",{inherits:[JuiceboxEngine.Component],fields:{_box:null,_aabb:null,_triggerOnly:!1,_world:null,DrawBox:!1},props:{AABB:{get:function(){return this._aabb.$clone()},set:function(value){this._aabb=value.$clone();this._box=Bridge.as(this._world.Create(this.Parent.Transform.Position.X+this._aabb.X,this.Parent.Transform.Position.Y+this._aabb.Y,this._aabb.Width,this._aabb.Height),Humper.Box);this._box.Parent=this}},TriggerOnly:{get:function(){return this._triggerOnly},set:function(value){this._triggerOnly=value;this._box.TriggerOnly=this._triggerOnly}}},ctors:{init:function(){this._aabb=new JuiceboxEngine.Math.Rectangle}},methods:{Initialize:function(resourceManager){},SetWorld:function(world){this._world=world},Translate:function(direction){var movement=this._box.Move(this.Parent.Transform.Position.X+this._aabb.X+direction.X,this.Parent.Transform.Position.Y+this._aabb.Y+direction.Y,function(c){return Humper.Responses.CollisionResponses.Slide});return this.UpdatePosition(),System.Linq.Enumerable.from(movement.Humper$IMovement$Hits,Humper.IHit).select(function(x){return Bridge.as(x.Humper$IHit$Box,Humper.Box).Parent}).ToArray(JuiceboxEngine.PhysicsComponent)},SetPosition:function(position){},UpdatePosition:function(){this.Parent.Transform.Position=new JuiceboxEngine.Math.Vector3.$ctor2(this._box.X-this._aabb.X,this._box.Y-this._aabb.Y,this.Parent.Transform.Position.Z)},Unique:function(){return!1},Update:function(){this.DrawBox&&this._box!=null&&JuiceboxEngine.Debugging.DebugRenderer.Instance.DrawRect(JuiceboxEngine.Math.Rectangle.op_Implicit(new JuiceboxEngine.Math.Rectangle.$ctor2(Bridge.Int.clip32(this._box.X),Bridge.Int.clip32(this._box.Y),Bridge.Int.clip32(this._box.Width),Bridge.Int.clip32(this._box.Height))),new JuiceboxEngine.Math.Color.$ctor3(1,0,0,1),1)},Destroy:function(){this._world.Remove(this._box)}}});Bridge.define("JuiceboxEngine.SplashScene",{inherits:[JuiceboxEngine.Scene],fields:{_switchTo:null,_preloader:null,_done:!1,_info:null,_icon:null},ctors:{ctor:function(manager,switchTo){this.$initialize();JuiceboxEngine.Scene.ctor.call(this,manager);this._switchTo=switchTo;this._done=!1;this._preloader=new JuiceboxEngine.Resources.Preloader;var preloadList=System.IO.File.ReadAllLines(JuiceboxEngine.Util.Config.ConfigValues.PreloadList);JuiceboxEngine.Coroutines.CoroutineManager.StartCoroutine(this._preloader.PreloadCoroutine(this.ResourceManager,preloadList))}},methods:{InitializeScene:function(){var icon,textComponent;this.DefaultCamera.Zoom=Bridge.Int.div(4,JuiceboxEngine.Util.Config.ConfigValues.PixelSize)|0;this.DefaultCamera.ClearColor=new JuiceboxEngine.Math.Color.$ctor2(15,15,15,255);icon=this.AddGameObject$1("Icon");icon.Transform.Position=new JuiceboxEngine.Math.Vector3.$ctor2(0,0,1);this._icon=icon.AddComponent(JuiceboxEngine.Sprite);this._icon.Offset=new JuiceboxEngine.Math.Vector2.$ctor3(-8,16);this._icon.Color=JuiceboxEngine.Math.Color.White.$clone();this._icon.Texture=this.ResourceManager.Load(JuiceboxEngine.Graphics.Texture2D,"Textures/JuiceboxIcon.png");textComponent=icon.AddComponent(JuiceboxEngine.TextComponent);textComponent.DisplayText="Juicebox Engine";textComponent.Alignment=JuiceboxEngine.GUI.TextAlignment.Center;this._info=new JuiceboxEngine.GUI.Text(this.GUI.Root);this._info.DisplayText="";this._info.Pivot=new JuiceboxEngine.Math.Vector2.$ctor3(.5,1);this._info.Anchor=new JuiceboxEngine.Math.Vector2.$ctor3(.5,1);this._info.Dimensions=new JuiceboxEngine.Math.Vector2.$ctor3(0,16);JuiceboxEngine.Coroutines.CoroutineManager.StartCoroutine(JuiceboxEngine.Coroutines.DefaultRoutines.Linear(1,Bridge.fn.bind(this,function(x){this._icon.Size=JuiceboxEngine.Math.Vector2.op_Multiply$1(new JuiceboxEngine.Math.Vector2.$ctor3(1,1),1+JuiceboxEngine.Math.Easings.ElasticEaseIn(1-x));this._icon.Offset=JuiceboxEngine.Math.Vector2.op_Multiply$1(new JuiceboxEngine.Math.Vector2.$ctor3(-8,16),1+JuiceboxEngine.Math.Easings.ElasticEaseIn(1-x))})))},PreUpdate:function(){this._info.DisplayText=System.String.format("Loading {0}%",[JuiceboxEngine.Math.JMath.Round(this._preloader.Preloaded/this._preloader.ToPreload*100)]);this._info.Dimensions=new JuiceboxEngine.Math.Vector2.$ctor3(this._info.Font.GetWidth(this._info.DisplayText),this._info.Dimensions.Y);this._preloader.Preloaded!==this._preloader.ToPreload||this._done||(this._done=!0,JuiceboxEngine.SceneManager.SwitchToScene(this._switchTo))},LateUpdate:function(){},FinalizeScene:function(){}}});Bridge.define("JuiceboxEngine.Transform",{inherits:[JuiceboxEngine.Component],fields:{Position:null,Rotation:null,Scale:null},props:{Enabled$1:{get:function(){return!0},set:function(value){}},Position2D:{get:function(){return new JuiceboxEngine.Math.Vector2.$ctor3(this.Position.X,this.Position.Y)},set:function(value){this.Position=new JuiceboxEngine.Math.Vector3.$ctor2(value.X,value.Y,this.Position.Z)}}},ctors:{init:function(){this.Position=new JuiceboxEngine.Math.Vector3;this.Rotation=new JuiceboxEngine.Math.Vector3;this.Scale=new JuiceboxEngine.Math.Vector3},ctor:function(){this.$initialize();JuiceboxEngine.Component.ctor.call(this);this.Position=new JuiceboxEngine.Math.Vector3.$ctor2(0,0,0);this.Scale=new JuiceboxEngine.Math.Vector3.$ctor1(1)}},methods:{Update:function(){},Translate:function(translation){this.Position=JuiceboxEngine.Math.Vector3.op_Addition(this.Position.$clone(),translation.$clone())},Translate2D:function(translation){this.Position=JuiceboxEngine.Math.Vector3.op_Addition(this.Position.$clone(),new JuiceboxEngine.Math.Vector3.$ctor2(translation.X,translation.Y,0))},GetWorldMatrix:function(){return JuiceboxEngine.Math.Matrix4.Multiply(JuiceboxEngine.Math.Matrix4.Multiply(JuiceboxEngine.Math.Matrix4.CreateScale(this.Scale.$clone()),JuiceboxEngine.Math.Matrix4.CreateFromYawPitchRoll(this.Rotation.X,this.Rotation.Y,this.Rotation.Z)),JuiceboxEngine.Math.Matrix4.CreateTranslation(this.Position.$clone()))},GetWorldMatrix2D:function(){return JuiceboxEngine.Math.Matrix4.Multiply(JuiceboxEngine.Math.Matrix4.Multiply(JuiceboxEngine.Math.Matrix4.CreateScale(this.Scale.$clone()),JuiceboxEngine.Math.Matrix4.CreateRotationZ(this.Rotation.Z)),JuiceboxEngine.Math.Matrix4.CreateTranslation(this.Position.$clone()))},GetWorldMatrixPixelPerfect2D:function(){return JuiceboxEngine.Math.Matrix4.Multiply(JuiceboxEngine.Math.Matrix4.Multiply(JuiceboxEngine.Math.Matrix4.CreateScale(this.Scale.$clone()),JuiceboxEngine.Math.Matrix4.CreateRotationZ(this.Rotation.Z)),JuiceboxEngine.Math.Matrix4.CreateTranslation(new JuiceboxEngine.Math.Vector3.$ctor2(JuiceboxEngine.Math.JMath.Round(this.Position.X),JuiceboxEngine.Math.JMath.Round(this.Position.Y),this.Position.Z)))},Unique:function(){return!0},Initialize:function(resourceManager){},Destroy:function(){}}});Bridge.define("JuiceboxEngine.UIComponent",{inherits:[JuiceboxEngine.Component],fields:{UIElement:null,_scene:null},methods:{Initialize:function(resourceManager){this.UIElement=null;this._scene=null},Setup:function(element,scene){this.UIElement!=null&&this.UIElement.Parent.RemoveChild(this.UIElement);this.UIElement=element;this._scene=scene},Update:function(){this.UIElement.Anchor=this._scene.DefaultCamera.WorldToScreenPoint(this.Parent.Transform.Position2D.$clone())},Unique:function(){return!1},Destroy:function(){}}});Bridge.define("JuiceboxEngine.Graphics.RenderTarget",{inherits:[JuiceboxEngine.Graphics.Texture2D],fields:{Target:null},ctors:{ctor:function(width,height){this.$initialize();JuiceboxEngine.Graphics.Texture2D.ctor.call(this);this.Width=width;this.Height=height;this.Texture=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.CreateTexture$1(width,height,null);this.Target=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.CreateRenderTarget(width,height,this)}}});Bridge.define("JuiceboxEngine.GUI.SlicedImage",{inherits:[JuiceboxEngine.GUI.Image],fields:{_border:0},props:{Border:{get:function(){return this._border},set:function(value){this._border=value;this.ForceUpdate()}}},ctors:{ctor:function(parent){this.$initialize();JuiceboxEngine.GUI.Image.ctor.call(this,parent)}},methods:{DrawDebuggingShapes:function(fill){JuiceboxEngine.GUI.Image.prototype.DrawDebuggingShapes.call(this,fill);JuiceboxEngine.Debugging.DebugRenderer.InstanceGUI.DrawLine(new JuiceboxEngine.Math.Vector2.$ctor3(this.Bounds.Left+this.Border,this.Bounds.Bottom),new JuiceboxEngine.Math.Vector2.$ctor3(this.Bounds.Left+this.Border,this.Bounds.Top),JuiceboxEngine.Math.Color.Green.$clone(),1);JuiceboxEngine.Debugging.DebugRenderer.InstanceGUI.DrawLine(new JuiceboxEngine.Math.Vector2.$ctor3(this.Bounds.Right-this.Border,this.Bounds.Bottom),new JuiceboxEngine.Math.Vector2.$ctor3(this.Bounds.Right-this.Border,this.Bounds.Top),JuiceboxEngine.Math.Color.Green.$clone(),1);JuiceboxEngine.Debugging.DebugRenderer.InstanceGUI.DrawLine(new JuiceboxEngine.Math.Vector2.$ctor3(this.Bounds.Left,this.Bounds.Bottom+this.Border),new JuiceboxEngine.Math.Vector2.$ctor3(this.Bounds.Right,this.Bounds.Bottom+this.Border),JuiceboxEngine.Math.Color.Green.$clone(),1);JuiceboxEngine.Debugging.DebugRenderer.InstanceGUI.DrawLine(new JuiceboxEngine.Math.Vector2.$ctor3(this.Bounds.Left,this.Bounds.Top-this.Border),new JuiceboxEngine.Math.Vector2.$ctor3(this.Bounds.Right,this.Bounds.Top-this.Border),JuiceboxEngine.Math.Color.Green.$clone(),1)},UpdateElement:function(){var uvBorder=new JuiceboxEngine.Math.Vector2.$ctor3(this.Border/this.DisplayImage.Width,this.Border/this.DisplayImage.Height),positionRects=System.Array.init(9,function(){return new JuiceboxEngine.Math.RectangleF},JuiceboxEngine.Math.RectangleF),uvRects,data,i;for(positionRects[0]=new JuiceboxEngine.Math.RectangleF.$ctor2(0,0,this._border,this._border),positionRects[1]=new JuiceboxEngine.Math.RectangleF.$ctor2(0,this._border,this._border,this.Dimensions.Y-this._border*2),positionRects[2]=new JuiceboxEngine.Math.RectangleF.$ctor2(0,this.Dimensions.Y-this._border,this._border,this._border),positionRects[3]=new JuiceboxEngine.Math.RectangleF.$ctor2(this._border,0,this.Dimensions.X-this._border*2,this._border),positionRects[4]=new JuiceboxEngine.Math.RectangleF.$ctor2(this._border,this._border,this.Dimensions.X-this._border*2,this.Dimensions.Y-this._border*2),positionRects[5]=new JuiceboxEngine.Math.RectangleF.$ctor2(this._border,this.Dimensions.Y-this._border,this.Dimensions.X-this._border*2,this._border),positionRects[6]=new JuiceboxEngine.Math.RectangleF.$ctor2(this.Dimensions.X-this._border,0,this._border,this._border),positionRects[7]=new JuiceboxEngine.Math.RectangleF.$ctor2(this.Dimensions.X-this._border,this._border,this._border,this.Dimensions.Y-this._border*2),positionRects[8]=new JuiceboxEngine.Math.RectangleF.$ctor2(this.Dimensions.X-this._border,this.Dimensions.Y-this._border,this._border,this._border),uvRects=System.Array.init(9,function(){return new JuiceboxEngine.Math.RectangleF},JuiceboxEngine.Math.RectangleF),uvRects[0]=new JuiceboxEngine.Math.RectangleF.$ctor2(0,1,uvBorder.X,-uvBorder.Y),uvRects[1]=new JuiceboxEngine.Math.RectangleF.$ctor2(0,1-uvBorder.Y,uvBorder.X,-1+uvBorder.Y*2),uvRects[2]=new JuiceboxEngine.Math.RectangleF.$ctor2(0,uvBorder.Y,uvBorder.X,-uvBorder.Y),uvRects[3]=new JuiceboxEngine.Math.RectangleF.$ctor2(uvBorder.X,1,1-uvBorder.X*2,-uvBorder.Y),uvRects[4]=new JuiceboxEngine.Math.RectangleF.$ctor2(uvBorder.X,1-uvBorder.Y,1-uvBorder.X*2,-1+uvBorder.Y*2),uvRects[5]=new JuiceboxEngine.Math.RectangleF.$ctor2(uvBorder.X,uvBorder.Y,1-uvBorder.X*2,-uvBorder.Y),uvRects[6]=new JuiceboxEngine.Math.RectangleF.$ctor2(1-uvBorder.X,1,uvBorder.X,-uvBorder.Y),uvRects[7]=new JuiceboxEngine.Math.RectangleF.$ctor2(1-uvBorder.X,1-uvBorder.Y,uvBorder.X,-1+uvBorder.Y*2),uvRects[8]=new JuiceboxEngine.Math.RectangleF.$ctor2(1-uvBorder.X,uvBorder.Y,uvBorder.X,-uvBorder.Y),data=System.Array.init(486,0,System.Single),i=0;i<9;i=i+1|0)System.Array.copy(this.GetFloats(positionRects[i].$clone(),uvRects[i].$clone()),0,data,Bridge.Int.mul(Bridge.Int.mul(i,9),6),54);this._command.SetShaderValue("texture",this.DisplayImage);this._command.VertexBuffer.UpdateData(new Float32Array(data))},GetFloats:function(posRect,uvRect){var R=this.Color.R,G=this.Color.G,B=this.Color.B,A=this.Color.A;return System.Array.init([posRect.Left,posRect.Bottom,.5,uvRect.Left,uvRect.Bottom,R,G,B,A,posRect.Right,posRect.Bottom,.5,uvRect.Right,uvRect.Bottom,R,G,B,A,posRect.Right,posRect.Top,.5,uvRect.Right,uvRect.Top,R,G,B,A,posRect.Left,posRect.Bottom,.5,uvRect.Left,uvRect.Bottom,R,G,B,A,posRect.Left,posRect.Top,.5,uvRect.Left,uvRect.Top,R,G,B,A,posRect.Right,posRect.Top,.5,uvRect.Right,uvRect.Top,R,G,B,A],System.Single)}}});Bridge.define("JuiceboxEngine.LayeredSprite",{inherits:[JuiceboxEngine.GraphicsComponent],fields:{PixelPerfect:!1,Color:null,AddativeColor:null,Size:null,Offset:null,Rotation:0,Texture:null,Priority:0,Dimensions:null,Layers:0,Row:0,LayerHeight:0,LayerOffset:0,ColorStep:0,SnapRotation:0,Outline:0,ShadowDirection:null,DepthOffset:0,Flip:0,_initialized:!1},ctors:{init:function(){this.Color=new JuiceboxEngine.Math.Color;this.AddativeColor=new JuiceboxEngine.Math.Color;this.Size=new JuiceboxEngine.Math.Vector2;this.Offset=new JuiceboxEngine.Math.Vector2;this.Dimensions=new JuiceboxEngine.Math.Point;this.ShadowDirection=new JuiceboxEngine.Math.Vector2},ctor:function(){this.$initialize();JuiceboxEngine.GraphicsComponent.ctor.call(this);this.PixelPerfect=JuiceboxEngine.Util.Config.ConfigValues.PixelPerfect;this.Size=new JuiceboxEngine.Math.Vector2.$ctor3(1,1);this.Color=JuiceboxEngine.Math.Color.White.$clone();this._initialized=!1}},methods:{Initialize:function(resourceManager){},SetSlicedSprite:function(texture,width,height,layers,layerHeight,row){row===void 0&&(row=0);this.Texture=texture;this.Dimensions=new JuiceboxEngine.Math.Point.$ctor1(width,height);this.LayerHeight=layerHeight;this.Layers=layers;this.Row=row;this._initialized=!0},Update:function(){},Render:function(){var x,y,pos,source,dest,i,stepSize,steps,outlineDest;if(this._initialized&&this.Texture!=null&&this.Texture.Loaded){pos=this.Parent.Transform.Position.$clone();this.PixelPerfect?(x=Bridge.Int.clip32(JuiceboxEngine.Math.JMath.Round(pos.X)),y=Bridge.Int.clip32(JuiceboxEngine.Math.JMath.Round(pos.Y))):(x=pos.X,y=pos.Y);var outline=!1,outlineDimensions=JuiceboxEngine.Math.Vector2.Zero.$clone(),outlineOffset=JuiceboxEngine.Math.Vector2.Zero.$clone();for(this.Outline>0&&(outline=!0,outlineDimensions=JuiceboxEngine.Math.Vector2.op_Division(JuiceboxEngine.Math.Vector2.op_Addition(JuiceboxEngine.Math.Vector2.op_Multiply(this.Dimensions.ToVector2(),this.Size.$clone()),JuiceboxEngine.Math.Vector2.op_Multiply$1(new JuiceboxEngine.Math.Vector2.$ctor3(2,2),this.Outline)),this.Dimensions.ToVector2()),outlineOffset=JuiceboxEngine.Math.Vector2.op_Multiply(this.Offset.$clone(),outlineDimensions.$clone()),outlineDimensions=JuiceboxEngine.Math.Vector2.op_Multiply(outlineDimensions.$clone(),this.Dimensions.ToVector2())),source=new JuiceboxEngine.Math.Rectangle.$ctor2(0,Bridge.Int.mul(this.Row,this.Dimensions.Y),this.Dimensions.X,this.Dimensions.Y),dest=new JuiceboxEngine.Math.RectangleF.$ctor2(x,0,this.Dimensions.X*this.Size.X,this.Dimensions.Y*this.Size.Y),i=0;i<this.Layers;i=i+1|0){source.X=Bridge.Int.mul(this.Dimensions.X,i);dest.Y=y+this.Size.Y*this.LayerHeight*(i+this.LayerOffset);var colorStep=(this.Layers-i|0)*this.ColorStep,col=new JuiceboxEngine.Math.Color.$ctor3(this.Color.R-colorStep,this.Color.G-colorStep,this.Color.B-colorStep,255),rotation=this.Rotation;this.SnapRotation>0&&(stepSize=JuiceboxEngine.Math.JMath.TWO_PI/this.SnapRotation,steps=JuiceboxEngine.Math.JMath.Round(rotation/stepSize),rotation=steps*stepSize);JuiceboxEngine.Sprite.spriteBatch.Draw$1(this.Texture,dest.$clone(),source.$clone(),col.$clone(),rotation,JuiceboxEngine.Math.Vector2.op_Multiply(this.Offset.$clone(),this.Size.$clone()),this.Priority===0?i*-.1-this.DepthOffset:this.Priority,this.Flip);outline&&(outlineDest=new JuiceboxEngine.Math.RectangleF.$ctor2(x,y+this.Size.Y*this.LayerHeight*(i+this.LayerOffset),outlineDimensions.X,outlineDimensions.Y),JuiceboxEngine.Sprite.spriteBatch.Draw$1(this.Texture,outlineDest.$clone(),source.$clone(),JuiceboxEngine.Math.Color.Black.$clone(),rotation,outlineOffset.$clone(),.01,this.Flip))}}},Unique:function(){return!1},Destroy:function(){}}});Bridge.define("JuiceboxEngine.Mesh",{inherits:[JuiceboxEngine.GraphicsComponent],fields:{Command:null},ctors:{ctor:function(){this.$initialize();JuiceboxEngine.GraphicsComponent.ctor.call(this);this.Command=new JuiceboxEngine.Graphics.GraphicsCommand;this.Command.VertexBuffer=new JuiceboxEngine.Graphics.VertexBuffer.ctor;this.Command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_pos",3,!1,36,0));this.Command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_tex",2,!1,36,12));this.Command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_col",4,!1,36,20))}},methods:{Initialize:function(resourceManager){this.Command.Program=resourceManager.Load(JuiceboxEngine.Graphics.ShaderProgram,"Shaders/Mesh.vert");this.Command.SetShaderValue("texture",resourceManager.Load(JuiceboxEngine.Graphics.Texture2D,"Textures/JuiceboxIcon.png"))},Render:function(){JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.WORLD,this.Parent.Transform.GetWorldMatrix());JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.Command(this.Command)},Unique:function(){return!1},Update:function(){},Destroy:function(){}}});Bridge.define("JuiceboxEngine.Networking.WorldState$1",function(T){return{fields:{bufferTime:0,_states:null,_firstServerTimestamp:0,_gameStart:0},ctors:{ctor:function(bufferTime){bufferTime===void 0&&(bufferTime=100);this.$initialize();this.bufferTime=bufferTime;this._states=new(System.Collections.Generic.List$1(T).ctor);this._firstServerTimestamp=0;this._gameStart=0}},methods:{PushNewState:function(state){this._firstServerTimestamp===0&&(this._firstServerTimestamp=state.timeStamp,this._gameStart=JuiceboxEngine.Util.Browser.DateNow());this._states.add(state);var baseState=this.GetBaseUpdate();baseState>0&&this._states.RemoveRange(0,baseState)},GetBaseUpdate:function(){for(var serverTime=this.CurrentServerTime(),i=this._states.Count-1|0;i>=0;i=i-1|0)if(this._states.getItem(i).timeStamp<=serverTime)return i;return-1},CurrentServerTime:function(){return this._firstServerTimestamp+(JuiceboxEngine.Util.Browser.DateNow()-this._gameStart)-this.bufferTime},GetCurrentState:function(){return null}}}});Bridge.define("JuiceboxEngine.Sprite",{inherits:[JuiceboxEngine.GraphicsComponent],statics:{fields:{spriteBatch:null}},fields:{_texture:null,PixelPerfect:!1,SourceRectangle:null,Offset:null,Size:null,Color:null,AddativeColor:null,Rotation:0,Animator:null,Priority:0,Flip:0},props:{Texture:{get:function(){return this._texture},set:function(value){this._texture=value;this._texture.addonLoad(Bridge.fn.bind(this,function(x,y){this.OnTextureLoad()}));this.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(0,0,this._texture.Width,this._texture.Height)}}},ctors:{init:function(){this.SourceRectangle=new JuiceboxEngine.Math.Rectangle;this.Offset=new JuiceboxEngine.Math.Vector2;this.Size=new JuiceboxEngine.Math.Vector2;this.Color=new JuiceboxEngine.Math.Color;this.AddativeColor=new JuiceboxEngine.Math.Color},ctor:function(){this.$initialize();JuiceboxEngine.GraphicsComponent.ctor.call(this);this.PixelPerfect=JuiceboxEngine.Util.Config.ConfigValues.PixelPerfect;this.Color=JuiceboxEngine.Math.Color.White.$clone();this.Size=new JuiceboxEngine.Math.Vector2.$ctor3(1,1);this.Rotation=0}},methods:{Initialize:function(resourceManager){this._texture=new JuiceboxEngine.Graphics.Texture2D.ctor;this.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(0,0,1,1)},Render:function(){var x,y,pos,source,dest;this._texture!=null&&this._texture.Loaded&&(pos=this.Parent.Transform.Position.$clone(),this.PixelPerfect?(x=Bridge.Int.clip32(JuiceboxEngine.Math.JMath.Round(pos.X)),y=Bridge.Int.clip32(JuiceboxEngine.Math.JMath.Round(pos.Y))):(x=pos.X,y=pos.Y),source=this.Animator!=null?this.Animator.SourceRectangle:this.SourceRectangle,dest=new JuiceboxEngine.Math.RectangleF.$ctor2(x,y,Bridge.Int.clip32(source.Width*this.Size.X),Bridge.Int.clip32(source.Height*this.Size.Y)),JuiceboxEngine.Sprite.spriteBatch.Draw$1(this.Texture,dest.$clone(),source.$clone(),this.Color.$clone(),this.Rotation,JuiceboxEngine.Math.Vector2.op_Multiply(this.Offset.$clone(),this.Size.$clone()),this.Priority===0?pos.Y*.01:this.Priority,this.Flip))},Unique:function(){return!1},Update:function(){this.Animator!=null&&this.Animator.Update()},OnTextureLoad:function(){JuiceboxEngine.Math.Rectangle.op_Equality(this.SourceRectangle.$clone(),new JuiceboxEngine.Math.Rectangle.$ctor2(0,0,1,1))&&(this.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(0,0,this.Texture.Width,this.Texture.Height))},Destroy:function(){}}});Bridge.define("JuiceboxEngine.TextComponent",{inherits:[JuiceboxEngine.GraphicsComponent],fields:{_text:null,_alignment:0,_color:null,_font:null,_command:null},props:{DisplayText:{get:function(){return this._text},set:function(value){System.String.equals(this._text,value)||(this._text=value,this.UpdateText())}},Alignment:{get:function(){return this._alignment},set:function(value){this._alignment!==value&&(this._alignment=value,this.UpdateText())}},Color:{get:function(){return this._color.$clone()},set:function(value){this._color.equalsT(value.$clone())||(this._color=value.$clone(),this.UpdateText())}},Font:{get:function(){return this._font},set:function(value){this._font=value;this.UpdateText()}}},ctors:{init:function(){this._color=new JuiceboxEngine.Math.Color}},methods:{Initialize:function(resourceManager){this._alignment=JuiceboxEngine.GUI.TextAlignment.Left;this._color=new JuiceboxEngine.Math.Color.$ctor3(1,1,1,1);this.Font=resourceManager.Load(JuiceboxEngine.Graphics.Font,"Fonts/Arial.bff");this._command=new JuiceboxEngine.Graphics.GraphicsCommand;this._command.Program=Bridge.as(resourceManager.Load$1("Shaders/Sprite.vert"),JuiceboxEngine.Graphics.ShaderProgram);this._command.VertexBuffer=new JuiceboxEngine.Graphics.VertexBuffer.ctor;this._command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_pos",3,!1,36,0));this._command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_tex",2,!1,36,12));this._command.VertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_col",4,!1,36,20));this._command.SetShaderValue("texture",this.Font.Texture)},UpdateText:function(){var offset,offsetVec;if(!System.String.isNullOrEmpty(this._text)){offset=this.Font.GetWidth(this._text);switch(this._alignment){case JuiceboxEngine.GUI.TextAlignment.Left:offset=0;break;case JuiceboxEngine.GUI.TextAlignment.Right:offset=-offset;break;case JuiceboxEngine.GUI.TextAlignment.Center:offset/=-2;break}offsetVec=new JuiceboxEngine.Math.Vector3.$ctor2(offset,0,0);this._command.SetShaderValue("texture",this.Font.Texture);this._command.VertexBuffer.UpdateData(new Float32Array(this.Font.GenerateBuffer(this._text,this._color.$clone(),offsetVec.$clone())))}},Render:function(){JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.SetGlobalShaderValue(JuiceboxEngine.Graphics.DefaultShaderValues.WORLD,this.Parent.Transform.GetWorldMatrixPixelPerfect2D());JuiceboxEngine.Graphics.GraphicsManager.Instance.Context.Command(this._command)},Unique:function(){return!1},Update:function(){},Destroy:function(){this._command.VertexBuffer.Destroy()}}});Bridge.define("JuiceboxEngine.TileMap",{inherits:[JuiceboxEngine.GraphicsComponent],fields:{Sprites:null,MapData:null,Parallax:0,TileSize:0,_context:null,_vertexBuffer:null,_program:null,_command:null},methods:{Initialize:function(resourceManager){var data=System.Array.init([-1,-1,this.Parent.Transform.Position.Z,0,0,1,-1,this.Parent.Transform.Position.Z,1,0,1,1,this.Parent.Transform.Position.Z,1,1,-1,-1,this.Parent.Transform.Position.Z,0,0,-1,1,this.Parent.Transform.Position.Z,0,1,1,1,this.Parent.Transform.Position.Z,1,1],System.Single);this._context=JuiceboxEngine.Graphics.GraphicsManager.Instance.Context;this._vertexBuffer=new JuiceboxEngine.Graphics.VertexBuffer.$ctor1(new Float32Array(data));this._vertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_pos",3,!1,20,0));this._vertexBuffer.SetAttribute(new JuiceboxEngine.Graphics.VertexAttribute.$ctor1("a_tex",2,!1,20,12));this._program=Bridge.cast(resourceManager.Load$1("Shaders/TileMap.vert"),JuiceboxEngine.Graphics.ShaderProgram);this._command=new JuiceboxEngine.Graphics.GraphicsCommand;this._command.SetShaderValue("sprites",null,JuiceboxEngine.Graphics.Uniform.UniformType.TEXTURE2D);this._command.SetShaderValue("map",null,JuiceboxEngine.Graphics.Uniform.UniformType.TEXTURE2D);this._command.VertexBuffer=this._vertexBuffer;this._command.Program=this._program;this.TileSize=16;this.Parallax=1},Render:function(){this.Sprites!=null&&this.MapData!=null&&(this._command.SetShaderValue("sprites",this.Sprites),this._command.SetShaderValue("spritesSize",new JuiceboxEngine.Math.Vector2.$ctor3(this.Sprites.Width,this.Sprites.Height)),this._command.SetShaderValue("mapSize",new JuiceboxEngine.Math.Vector2.$ctor3(this.MapData.Width,this.MapData.Height)),this._command.SetShaderValue("tileSize",this.TileSize),this._command.SetShaderValue("parallax",this.Parallax),this._command.SetShaderValue("offset",this.Parent.Transform.Position2D.$clone()),this._command.SetShaderValue("map",this.MapData),this._context.UseDepth(!1),this._context.Command(this._command),this._context.UseDepth(!0))},Unique:function(){return!1},Update:function(){},Destroy:function(){this._vertexBuffer.Destroy()}}})});