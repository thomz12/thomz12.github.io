H5.assemblyVersion("LD50","1.0.0.0");H5.assembly("LD50",function($asm,globals){"use strict";H5.define("LD50.Circle",{$kind:"struct",statics:{methods:{getDefaultValue:function(){return new LD50.Circle}}},fields:{Center:null,Radius:0},ctors:{init:function(){this.Center=new JuiceboxEngine.Math.Vector2},$ctor1:function(center,radius){this.$initialize();this.Center=center.$clone();this.Radius=radius},ctor:function(){this.$initialize()}},methods:{getHashCode:function(){return H5.addHash([1668468399,this.Center,this.Radius])},equals:function(o){return H5.is(o,LD50.Circle)?H5.equals(this.Center,o.Center)&&H5.equals(this.Radius,o.Radius):!1},$clone:function(to){var s=to||new LD50.Circle;return s.Center=this.Center.$clone(),s.Radius=this.Radius,s}}});H5.define("LD50.Dish",{fields:{Name:null,Mass:0,SpriteOffset:null,SourceRectangle:null,BoundingBoxes:null,Circles:null},ctors:{init:function(){this.SpriteOffset=new JuiceboxEngine.Math.Vector2;this.SourceRectangle=new JuiceboxEngine.Math.Rectangle}}});H5.define("LD50.Dishes",{statics:{fields:{DishList:null},ctors:{init:function(){var $t;this.DishList=System.Array.init([($t=new LD50.Dish,$t.Name="Plate",$t.Mass=1,$t.SpriteOffset=new JuiceboxEngine.Math.Vector2.$ctor3(-8,-8),$t.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(0,0,16,16),$t.BoundingBoxes=System.Array.init([],JuiceboxEngine.Math.RectangleF),$t.Circles=System.Array.init([new LD50.Circle.$ctor1(new JuiceboxEngine.Math.Vector2.$ctor3(0,0),8)],LD50.Circle),$t),($t=new LD50.Dish,$t.Name="Pan",$t.Mass=1.5,$t.SpriteOffset=new JuiceboxEngine.Math.Vector2.$ctor3(-14,-8),$t.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(16,0,28,16),$t.BoundingBoxes=System.Array.init([new JuiceboxEngine.Math.RectangleF.$ctor2(6,0,12,4)],JuiceboxEngine.Math.RectangleF),$t.Circles=System.Array.init([new LD50.Circle.$ctor1(new JuiceboxEngine.Math.Vector2.$ctor3(-6,0),8)],LD50.Circle),$t),($t=new LD50.Dish,$t.Name="Fork",$t.Mass=.3,$t.SpriteOffset=new JuiceboxEngine.Math.Vector2.$ctor3(-3,-7),$t.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(48,3,6,14),$t.BoundingBoxes=System.Array.init([new JuiceboxEngine.Math.RectangleF.$ctor2(0,0,5,11)],JuiceboxEngine.Math.RectangleF),$t.Circles=System.Array.init([],LD50.Circle),$t),($t=new LD50.Dish,$t.Name="Cup",$t.Mass=.5,$t.SpriteOffset=new JuiceboxEngine.Math.Vector2.$ctor3(-6,-5),$t.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(64,6,12,10),$t.BoundingBoxes=System.Array.init([new JuiceboxEngine.Math.RectangleF.$ctor2(-1,0,10,9)],JuiceboxEngine.Math.RectangleF),$t.Circles=System.Array.init([],LD50.Circle),$t)],LD50.Dish)}}}});H5.define("LD50.MainScene",{inherits:[JuiceboxEngine.Scene],fields:{_counter:null,_dishes:null,_aiming:!1,_aimingObject:null,_dishMass:0},ctors:{ctor:function(manager){this.$initialize();JuiceboxEngine.Scene.ctor.call(this,manager);this._dishes=new(System.Collections.Generic.List$1(JuiceboxEngine.GameObject).ctor)}},methods:{InitializeScene:function(){this.DefaultCamera.ClearColor=new JuiceboxEngine.Math.Color.$ctor2(30,144,255,255);this.DefaultCamera.Zoom=4;this.LoadLevel(this.ResourceManager.Load(JuiceboxEngine.Level,"Levels/Main.json"));this.DefaultCamera.Parent.Transform.Position2D=this.GetObjectByName("CameraPosition").Transform.Position2D.$clone();this._counter=this.GetObjectByName("Counter");this._aiming=!0},PreUpdate:function(){if(this._aiming){this._aimingObject==null&&(this._aimingObject=this.CreateDish());var body=this._aimingObject.GetComponent(JuiceboxEngine.Physics.BodyP2);JuiceboxEngine.Input.InputManager.Instance.IsKeyHeld("a")&&(body.Position=JuiceboxEngine.Math.Vector2.op_Addition(body.Position.$clone(),new JuiceboxEngine.Math.Vector2.$ctor3(-64*JuiceboxEngine.Util.Time.DeltaTime,0)));JuiceboxEngine.Input.InputManager.Instance.IsKeyHeld("d")&&(body.Position=JuiceboxEngine.Math.Vector2.op_Addition(body.Position.$clone(),new JuiceboxEngine.Math.Vector2.$ctor3(64*JuiceboxEngine.Util.Time.DeltaTime,0)));JuiceboxEngine.Input.InputManager.Instance.IsKeyHeld("r")&&(body.Rotation+=6.2831855*JuiceboxEngine.Util.Time.DeltaTime);JuiceboxEngine.Input.InputManager.Instance.IsKeyUp(" ")&&(body.Mass=this._dishMass,body.Velocity=new JuiceboxEngine.Math.Vector2.$ctor3(0,-20),this._aiming=!1,this._dishMass=0)}else this._aimingObject!=null&&this._aimingObject.GetComponent(JuiceboxEngine.Physics.BodyP2).Sleeping&&(this._aiming=!0,this._aimingObject=null)},CreateDish:function(){var $t,$t1,dish=LD50.Dishes.DishList[JuiceboxEngine.Util.Random.NextRange(0,LD50.Dishes.DishList.length)],dishObj=this.AddGameObject$1(dish.Name),sprite,body,i,circle,i1,rect;for(dishObj.Transform.Position2D=JuiceboxEngine.Math.Vector2.op_Addition(this.DefaultCamera.Parent.Transform.Position2D.$clone(),new JuiceboxEngine.Math.Vector2.$ctor3(JuiceboxEngine.Util.Random.NextRange(-8,8),64)),sprite=dishObj.AddComponent(JuiceboxEngine.Sprite),sprite.Texture=this.ResourceManager.Load(JuiceboxEngine.Graphics.Texture2D,"Textures/Dishes.png"),sprite.SourceRectangle=dish.SourceRectangle.$clone(),sprite.Offset=dish.SpriteOffset.$clone(),body=dishObj.AddComponent(JuiceboxEngine.Physics.BodyP2),body.Mass=0,this._dishMass=dish.Mass,i=0;i<dish.Circles.length;i=i+1|0)circle=($t=dish.Circles)[i].$clone(),body.AddCircle(circle.Radius,circle.Center.$clone());for(i1=0;i1<dish.BoundingBoxes.length;i1=i1+1|0)rect=($t1=dish.BoundingBoxes)[i1].$clone(),body.AddRectangle(rect.$clone());return this._dishes.add(dishObj),dishObj},DebugBodyShape:function(body){var rect=body.GetAABB();JuiceboxEngine.Debugging.DebugRenderer.Instance.DrawRect(rect.$clone(),JuiceboxEngine.Math.Color.Red.$clone(),1);JuiceboxEngine.Debugging.DebugRenderer.Instance.DrawRectFilled(new JuiceboxEngine.Math.RectangleF.$ctor1(JuiceboxEngine.Math.Vector2.op_Subtraction(body.Parent.Transform.Position2D.$clone(),new JuiceboxEngine.Math.Vector2.$ctor3(1,1)),2,2),JuiceboxEngine.Math.Color.Blue.$clone())},LateUpdate:function(){var $t,dish;if(JuiceboxEngine.Input.InputManager.Instance.IsKeyHeld("h")){this.DebugBodyShape(this._counter.GetComponent(JuiceboxEngine.Physics.BodyP2));$t=H5.getEnumerator(this._dishes);try{while($t.moveNext())dish=$t.Current,this.DebugBodyShape(dish.GetComponent(JuiceboxEngine.Physics.BodyP2))}finally{H5.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}}},FinalizeScene:function(){}}});H5.define("LD50.PlayfabSignin",{fields:{_loginID:null,_currentState:0},events:{OnStateChange:null,OnUsernameChanged:null},props:{CurrentState:{get:function(){return this._currentState},set:function(value){this._currentState=value;H5.staticEquals(this.OnStateChange,null)?null:this.OnStateChange(this._currentState)}}},ctors:{ctor:function(){this.$initialize();this._currentState=LD50.PlayfabSignin.LoginState.NONE}},methods:{AutoLogin:function(){this._loginID=JuiceboxEngine.Util.LocalStorage.GetValue("login_id");this._loginID==null?(this._loginID=System.Guid.NewGuid().toString(),System.Console.WriteLine("Registering with Playfab..."),this.CurrentState=LD50.PlayfabSignin.LoginState.REGISTERING,JuiceboxEngine.Playfab.PlayfabManager.Identity.LoginWithCustomID(this._loginID,!0)):(System.Console.WriteLine("Logging in with Playfab..."),this.CurrentState=LD50.PlayfabSignin.LoginState.REGISTERING,JuiceboxEngine.Playfab.PlayfabManager.Identity.LoginWithCustomID(this._loginID,!1));JuiceboxEngine.Playfab.PlayfabManager.Identity.LoginTask.addOnTaskCompleted(H5.fn.cacheBind(this,this.LoginFinished))},ChangeName:function(username){this.CurrentState!==LD50.PlayfabSignin.LoginState.SIGNED_IN&&System.Console.WriteLine("Can't change name, user is not signed in.");System.Console.WriteLine(System.String.format("Attempting to update username to {0}",[username]));var task=JuiceboxEngine.Playfab.PlayfabManager.Identity.UpdateDisplayName(username);task.addOnTaskCompleted(H5.fn.cacheBind(this,this.UpdateUsername))},LoginFinished:function(task){task.Success?(JuiceboxEngine.Util.LocalStorage.StoreValue("login_id",this._loginID),System.Console.WriteLine(System.String.format("Logged in with Playfab! {0}",[JuiceboxEngine.Playfab.PlayfabManager.Identity.Username])),this.CurrentState=LD50.PlayfabSignin.LoginState.SIGNED_IN):(this.CurrentState=LD50.PlayfabSignin.LoginState.ERROR,System.Console.WriteLine("Failed to log in with Playfab."))},UpdateUsername:function(task){H5.staticEquals(this.OnUsernameChanged,null)?null:this.OnUsernameChanged(task.Success,task.ErrorMessage)}}});H5.define("LD50.PlayfabSignin.LoginState",{$kind:"nested enum",statics:{fields:{NONE:0,SIGNED_OUT:1,SIGNED_IN:2,REGISTERING:3,SIGNING_IN:4,ERROR:5}}});H5.define("LD50.Program",{main:function(){var game=new JuiceboxEngine.JuiceboxGame;game.Run(new LD50.MainScene(game.ResourceManager))}})});