H5.assemblyVersion("LD50","1.0.0.0");H5.assembly("LD50",function($asm,globals){"use strict";H5.define("LD50.MainScene",{inherits:[JuiceboxEngine.Scene],ctors:{ctor:function(manager){this.$initialize();JuiceboxEngine.Scene.ctor.call(this,manager);var signin=new LD50.PlayfabSignin;signin.AutoLogin()}},methods:{InitializeScene:function(){this.DefaultCamera.ClearColor=new JuiceboxEngine.Math.Color.$ctor2(30,144,255,255);this.DefaultCamera.Parent.Transform.Position2D=new JuiceboxEngine.Math.Vector2.$ctor3(400,200);this.LoadLevel(this.ResourceManager.Load(JuiceboxEngine.Level,"Levels/Main.json"))},PreUpdate:function(){this.DefaultCamera.Parent.Transform.Position2D=JuiceboxEngine.Math.Vector2.op_Addition(new JuiceboxEngine.Math.Vector2.$ctor3(JuiceboxEngine.Math.JMath.Sin(JuiceboxEngine.Util.Time.TotalSeconds)*50,JuiceboxEngine.Math.JMath.Cos(JuiceboxEngine.Util.Time.TotalSeconds)*50),new JuiceboxEngine.Math.Vector2.$ctor3(400,200))},LateUpdate:function(){},FinalizeScene:function(){}}});H5.define("LD50.PlayfabSignin",{fields:{_loginID:null,_currentState:0},events:{OnStateChange:null,OnUsernameChanged:null},props:{CurrentState:{get:function(){return this._currentState},set:function(value){this._currentState=value;H5.staticEquals(this.OnStateChange,null)?null:this.OnStateChange(this._currentState)}}},ctors:{ctor:function(){this.$initialize();this._currentState=LD50.PlayfabSignin.LoginState.NONE}},methods:{AutoLogin:function(){this._loginID=JuiceboxEngine.Util.LocalStorage.GetValue("login_id");this._loginID==null?(this._loginID=System.Guid.NewGuid().toString(),System.Console.WriteLine("Registering with Playfab..."),this.CurrentState=LD50.PlayfabSignin.LoginState.REGISTERING,JuiceboxEngine.Playfab.PlayfabManager.Identity.LoginWithCustomID(this._loginID,!0)):(System.Console.WriteLine("Logging in with Playfab..."),this.CurrentState=LD50.PlayfabSignin.LoginState.REGISTERING,JuiceboxEngine.Playfab.PlayfabManager.Identity.LoginWithCustomID(this._loginID,!1));JuiceboxEngine.Playfab.PlayfabManager.Identity.LoginTask.addOnTaskCompleted(H5.fn.cacheBind(this,this.LoginFinished))},ChangeName:function(username){this.CurrentState!==LD50.PlayfabSignin.LoginState.SIGNED_IN&&System.Console.WriteLine("Can't change name, user is not signed in.");System.Console.WriteLine(System.String.format("Attempting to update username to {0}",[username]));var task=JuiceboxEngine.Playfab.PlayfabManager.Identity.UpdateDisplayName(username);task.addOnTaskCompleted(H5.fn.cacheBind(this,this.UpdateUsername))},LoginFinished:function(task){task.Success?(JuiceboxEngine.Util.LocalStorage.StoreValue("login_id",this._loginID),System.Console.WriteLine(System.String.format("Logged in with Playfab! {0}",[JuiceboxEngine.Playfab.PlayfabManager.Identity.Username])),this.CurrentState=LD50.PlayfabSignin.LoginState.SIGNED_IN):(this.CurrentState=LD50.PlayfabSignin.LoginState.ERROR,System.Console.WriteLine("Failed to log in with Playfab."))},UpdateUsername:function(task){H5.staticEquals(this.OnUsernameChanged,null)?null:this.OnUsernameChanged(task.Success,task.ErrorMessage)}}});H5.define("LD50.PlayfabSignin.LoginState",{$kind:"nested enum",statics:{fields:{NONE:0,SIGNED_OUT:1,SIGNED_IN:2,REGISTERING:3,SIGNING_IN:4,ERROR:5}}});H5.define("LD50.Program",{main:function(){var game=new JuiceboxEngine.JuiceboxGame;game.Run(new LD50.MainScene(game.ResourceManager))}})});