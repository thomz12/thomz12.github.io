H5.assemblyVersion("LD50","1.0.0.0");H5.assembly("LD50",function($asm,globals){"use strict";H5.define("LD50.Circle",{$kind:"struct",statics:{methods:{getDefaultValue:function(){return new LD50.Circle}}},fields:{Center:null,Radius:0},ctors:{init:function(){this.Center=new JuiceboxEngine.Math.Vector2},$ctor1:function(center,radius){this.$initialize();this.Center=center.$clone();this.Radius=radius},ctor:function(){this.$initialize()}},methods:{getHashCode:function(){return H5.addHash([1668468399,this.Center,this.Radius])},equals:function(o){return H5.is(o,LD50.Circle)?H5.equals(this.Center,o.Center)&&H5.equals(this.Radius,o.Radius):!1},$clone:function(to){var s=to||new LD50.Circle;return s.Center=this.Center.$clone(),s.Radius=this.Radius,s}}});H5.define("LD50.Dish",{fields:{Name:null,Mass:0,SpriteOffset:null,SourceRectangle:null,BoundingBoxes:null,Circles:null},ctors:{init:function(){this.SpriteOffset=new JuiceboxEngine.Math.Vector2;this.SourceRectangle=new JuiceboxEngine.Math.Rectangle}}});H5.define("LD50.Dishes",{statics:{fields:{DishList:null},ctors:{init:function(){var $t;this.DishList=System.Array.init([($t=new LD50.Dish,$t.Name="Plate",$t.Mass=1,$t.SpriteOffset=new JuiceboxEngine.Math.Vector2.$ctor3(-8,-8),$t.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(0,0,16,16),$t.BoundingBoxes=System.Array.init([],JuiceboxEngine.Math.RectangleF),$t.Circles=System.Array.init([new LD50.Circle.$ctor1(new JuiceboxEngine.Math.Vector2.$ctor3(0,0),8)],LD50.Circle),$t),($t=new LD50.Dish,$t.Name="Pan",$t.Mass=1.5,$t.SpriteOffset=new JuiceboxEngine.Math.Vector2.$ctor3(-14,-8),$t.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(16,0,28,16),$t.BoundingBoxes=System.Array.init([new JuiceboxEngine.Math.RectangleF.$ctor2(6,0,12,4)],JuiceboxEngine.Math.RectangleF),$t.Circles=System.Array.init([new LD50.Circle.$ctor1(new JuiceboxEngine.Math.Vector2.$ctor3(-6,0),8)],LD50.Circle),$t),($t=new LD50.Dish,$t.Name="Fork",$t.Mass=.3,$t.SpriteOffset=new JuiceboxEngine.Math.Vector2.$ctor3(-3,-7),$t.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(96,3,6,14),$t.BoundingBoxes=System.Array.init([new JuiceboxEngine.Math.RectangleF.$ctor2(0,0,5,11)],JuiceboxEngine.Math.RectangleF),$t.Circles=System.Array.init([],LD50.Circle),$t),($t=new LD50.Dish,$t.Name="Cup",$t.Mass=.5,$t.SpriteOffset=new JuiceboxEngine.Math.Vector2.$ctor3(-6,-5),$t.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(192,6,12,10),$t.BoundingBoxes=System.Array.init([new JuiceboxEngine.Math.RectangleF.$ctor2(-1,0,10,9)],JuiceboxEngine.Math.RectangleF),$t.Circles=System.Array.init([],LD50.Circle),$t),($t=new LD50.Dish,$t.Name="Ladle",$t.Mass=.5,$t.SpriteOffset=new JuiceboxEngine.Math.Vector2.$ctor3(-2,-8),$t.SourceRectangle=new JuiceboxEngine.Math.Rectangle.$ctor2(112,0,6,16),$t.BoundingBoxes=System.Array.init([new JuiceboxEngine.Math.RectangleF.$ctor2(0,0,4,16)],JuiceboxEngine.Math.RectangleF),$t.Circles=System.Array.init([],LD50.Circle),$t)],LD50.Dish)}}}});H5.define("LD50.JuiceUI.JuiceUIPanel",{inherits:[JuiceboxEngine.GUI.EmptyUIElement],fields:{_front:null,_back:null,_height:0},props:{Height:{get:function(){return this._height},set:function(value){this._height=value;this.ForceUpdate()}}},ctors:{ctor:function(parent){this.$initialize();JuiceboxEngine.GUI.EmptyUIElement.ctor.call(this,parent);this._back=new JuiceboxEngine.GUI.SlicedImage(this);this._front=new JuiceboxEngine.GUI.SlicedImage(this);this._back.DisplayImage=this.ResourceManager.Load(JuiceboxEngine.Graphics.Texture2D,LD50.JuiceUI.JuiceUIConsts.PANEL_TEXTURE_PATH);this._front.DisplayImage=this.ResourceManager.Load(JuiceboxEngine.Graphics.Texture2D,LD50.JuiceUI.JuiceUIConsts.PANEL_TEXTURE_PATH);this._back.Border=LD50.JuiceUI.JuiceUIConsts.PANEL_BORDER_WIDTH;this._front.Border=LD50.JuiceUI.JuiceUIConsts.PANEL_BORDER_WIDTH;this._height=LD50.JuiceUI.JuiceUIConsts.PANEL_OFFSET;this._back.Color=LD50.JuiceUI.JuiceUIConsts.PANEL_BACK.$clone();this._front.Color=LD50.JuiceUI.JuiceUIConsts.PANEL_FRONT.$clone()}},methods:{UpdateElement:function(){JuiceboxEngine.GUI.EmptyUIElement.prototype.UpdateElement.call(this);this._back.Position=new JuiceboxEngine.Math.Vector2.$ctor3(this.Height,-this.Height);this._front.Position=new JuiceboxEngine.Math.Vector2.$ctor3(-this.Height,this.Height);this._back.Dimensions=this.Dimensions.$clone();this._front.Dimensions=this.Dimensions.$clone()}}});H5.define("LD50.JuiceUI.JuiceUIConsts",{statics:{fields:{FONT_32_PATH:null,FONT_48_PATH:null,FONT_SHADOW_OFFSET:null,PANEL_TEXTURE_PATH:null,PANEL_BORDER_WIDTH:0,PANEL_OFFSET:0,PANEL_FRONT:null,PANEL_BACK:null},ctors:{init:function(){this.FONT_SHADOW_OFFSET=new JuiceboxEngine.Math.Point;this.PANEL_FRONT=new JuiceboxEngine.Math.Color;this.PANEL_BACK=new JuiceboxEngine.Math.Color;this.FONT_32_PATH="JuiceUI/AldotheApache32.bff";this.FONT_48_PATH="JuiceUI/AldotheApache48.bff";this.FONT_SHADOW_OFFSET=new JuiceboxEngine.Math.Point.$ctor1(2,-2);this.PANEL_TEXTURE_PATH="JuiceUI/Panel.png";this.PANEL_BORDER_WIDTH=5;this.PANEL_OFFSET=2;this.PANEL_FRONT=new JuiceboxEngine.Math.Color.$ctor2(252,163,17,255);this.PANEL_BACK=new JuiceboxEngine.Math.Color.$ctor2(43,44,40,255)}}}});H5.define("LD50.MainScene",{inherits:[JuiceboxEngine.Scene],fields:{_counter:null,_dishes:null,_highestPoint:0,_curHeight:0,_aiming:!1,_aimingObject:null,_dishMass:0,_scoreText:null},ctors:{ctor:function(manager){this.$initialize();JuiceboxEngine.Scene.ctor.call(this,manager);this._dishes=new(System.Collections.Generic.List$1(JuiceboxEngine.Physics.BodyP2).ctor)}},methods:{InitializeScene:function(){this.DefaultCamera.ClearColor=new JuiceboxEngine.Math.Color.$ctor2(30,144,255,255);this.DefaultCamera.Zoom=4;this.LoadLevel(this.ResourceManager.Load(JuiceboxEngine.Level,"Levels/Main.json"));this.DefaultCamera.Parent.Transform.Position2D=this.GetObjectByName("CameraPosition").Transform.Position2D.$clone();this._counter=this.GetObjectByName("Counter");this._aiming=!0;this._scoreText=new JuiceboxEngine.GUI.Text(this.GUI.Root);this._scoreText.Font=this.ResourceManager.Load(JuiceboxEngine.Graphics.Font,LD50.JuiceUI.JuiceUIConsts.FONT_48_PATH);this._scoreText.DisplayText="";this._scoreText.Dimensions=new JuiceboxEngine.Math.Vector2.$ctor3(2e3,48);this._scoreText.Pivot=new JuiceboxEngine.Math.Vector2.$ctor3(0,0)},PreUpdate:function(){if(this._aiming){this._aimingObject==null&&(this._aimingObject=this.CreateDish());var body=this._aimingObject.GetComponent(JuiceboxEngine.Physics.BodyP2);body.Position=new JuiceboxEngine.Math.Vector2.$ctor3(body.Position.X,this.DefaultCamera.Parent.Transform.Position2D.Y+48);JuiceboxEngine.Input.InputManager.Instance.IsKeyHeld("a")&&(body.Position=JuiceboxEngine.Math.Vector2.op_Addition(body.Position.$clone(),new JuiceboxEngine.Math.Vector2.$ctor3(-64*JuiceboxEngine.Util.Time.DeltaTime,0)));JuiceboxEngine.Input.InputManager.Instance.IsKeyHeld("d")&&(body.Position=JuiceboxEngine.Math.Vector2.op_Addition(body.Position.$clone(),new JuiceboxEngine.Math.Vector2.$ctor3(64*JuiceboxEngine.Util.Time.DeltaTime,0)));JuiceboxEngine.Input.InputManager.Instance.IsKeyHeld("r")&&(body.Rotation+=6.2831855*JuiceboxEngine.Util.Time.DeltaTime);JuiceboxEngine.Input.InputManager.Instance.IsKeyUp(" ")&&(body.Mass=this._dishMass,body.Velocity=new JuiceboxEngine.Math.Vector2.$ctor3(0,-20),this._aiming=!1,this._dishMass=0)}else this._aimingObject!=null&&this._aimingObject.GetComponent(JuiceboxEngine.Physics.BodyP2).Sleeping&&(this._aiming=!0,this._aimingObject.GetComponent(JuiceboxEngine.Physics.BodyP2).Type=2,this._aimingObject=null)},CreateDish:function(){var $t,$t1,dish=LD50.Dishes.DishList[JuiceboxEngine.Util.Random.NextRange(0,LD50.Dishes.DishList.length)],dishObj=this.AddGameObject$1(dish.Name),sprite,body,i,circle,i1,rect;for(dishObj.Transform.Position2D=JuiceboxEngine.Math.Vector2.op_Addition(this.DefaultCamera.Parent.Transform.Position2D.$clone(),new JuiceboxEngine.Math.Vector2.$ctor3(JuiceboxEngine.Util.Random.NextRange(-8,8),64)),sprite=dishObj.AddComponent(JuiceboxEngine.Sprite),sprite.Texture=this.ResourceManager.Load(JuiceboxEngine.Graphics.Texture2D,"Textures/Dishes.png"),sprite.SourceRectangle=dish.SourceRectangle.$clone(),sprite.Offset=dish.SpriteOffset.$clone(),body=dishObj.AddComponent(JuiceboxEngine.Physics.BodyP2),body.Mass=0,this._dishMass=dish.Mass,i=0;i<dish.Circles.length;i=i+1|0)circle=($t=dish.Circles)[i].$clone(),body.AddCircle(circle.Radius,circle.Center.$clone());for(i1=0;i1<dish.BoundingBoxes.length;i1=i1+1|0)rect=($t1=dish.BoundingBoxes)[i1].$clone(),body.AddRectangle(rect.$clone());return this._dishes.add(body),dishObj},DebugBodyShape:function(body){var rect=body.GetAABB();JuiceboxEngine.Debugging.DebugRenderer.Instance.DrawRect(rect.$clone(),JuiceboxEngine.Math.Color.Red.$clone(),1);JuiceboxEngine.Debugging.DebugRenderer.Instance.DrawRectFilled(new JuiceboxEngine.Math.RectangleF.$ctor1(JuiceboxEngine.Math.Vector2.op_Subtraction(body.Parent.Transform.Position2D.$clone(),new JuiceboxEngine.Math.Vector2.$ctor3(1,1)),2,2),JuiceboxEngine.Math.Color.Blue.$clone())},LateUpdate:function(){var $t,camPos,interpolatedHeight,dish;if(this._highestPoint=this.GetHighestPoint(),camPos=this.DefaultCamera.Parent.Transform.Position2D.$clone(),this._curHeight<48&&(this._curHeight=48),interpolatedHeight=JuiceboxEngine.Math.JMath.Interpolate(this._curHeight,this._highestPoint,3*JuiceboxEngine.Util.Time.DeltaTime),this._curHeight=interpolatedHeight,JuiceboxEngine.Debugging.DebugRenderer.Instance.DrawLine(new JuiceboxEngine.Math.Vector2.$ctor3(camPos.X-100,interpolatedHeight),new JuiceboxEngine.Math.Vector2.$ctor3(camPos.X+100,interpolatedHeight),new JuiceboxEngine.Math.Color.$ctor2(128,128,128,128),1),this._scoreText.DisplayText=System.Single.format(JuiceboxEngine.Math.JMath.Round(interpolatedHeight*10)/10),this._scoreText.Anchor=new JuiceboxEngine.Math.Vector2.$ctor3(.75,this.DefaultCamera.WorldToScreenPoint(new JuiceboxEngine.Math.Vector2.$ctor3(0,interpolatedHeight)).Y),this._highestPoint-this._curHeight<1&&(this.DefaultCamera.Parent.Transform.Position2D=new JuiceboxEngine.Math.Vector2.$ctor3(camPos.X,JuiceboxEngine.Math.JMath.Interpolate(camPos.Y,this._highestPoint,2*JuiceboxEngine.Util.Time.DeltaTime))),JuiceboxEngine.Input.InputManager.Instance.IsKeyHeld("h")){this.DebugBodyShape(this._counter.GetComponent(JuiceboxEngine.Physics.BodyP2));$t=H5.getEnumerator(this._dishes);try{while($t.moveNext())dish=$t.Current,this.DebugBodyShape(dish)}finally{H5.is($t,System.IDisposable)&&$t.System$IDisposable$Dispose()}}},GetHighestPoint:function(){for(var body,height,highest=48,i=0;i<this._dishes.Count;i=i+1|0)(body=this._dishes.getItem(i),H5.referenceEquals(body.Parent,this._aimingObject))||(height=body.GetAABB().Top,height>highest&&(highest=height));return highest},FinalizeScene:function(){}}});H5.define("LD50.PlayfabSignin",{fields:{_loginID:null,_currentState:0},events:{OnStateChange:null,OnUsernameChanged:null},props:{CurrentState:{get:function(){return this._currentState},set:function(value){this._currentState=value;H5.staticEquals(this.OnStateChange,null)?null:this.OnStateChange(this._currentState)}}},ctors:{ctor:function(){this.$initialize();this._currentState=LD50.PlayfabSignin.LoginState.NONE}},methods:{AutoLogin:function(){this._loginID=JuiceboxEngine.Util.LocalStorage.GetValue("login_id");this._loginID==null?(this._loginID=System.Guid.NewGuid().toString(),System.Console.WriteLine("Registering with Playfab..."),this.CurrentState=LD50.PlayfabSignin.LoginState.REGISTERING,JuiceboxEngine.Playfab.PlayfabManager.Identity.LoginWithCustomID(this._loginID,!0)):(System.Console.WriteLine("Logging in with Playfab..."),this.CurrentState=LD50.PlayfabSignin.LoginState.REGISTERING,JuiceboxEngine.Playfab.PlayfabManager.Identity.LoginWithCustomID(this._loginID,!1));JuiceboxEngine.Playfab.PlayfabManager.Identity.LoginTask.addOnTaskCompleted(H5.fn.cacheBind(this,this.LoginFinished))},ChangeName:function(username){this.CurrentState!==LD50.PlayfabSignin.LoginState.SIGNED_IN&&System.Console.WriteLine("Can't change name, user is not signed in.");System.Console.WriteLine(System.String.format("Attempting to update username to {0}",[username]));var task=JuiceboxEngine.Playfab.PlayfabManager.Identity.UpdateDisplayName(username);task.addOnTaskCompleted(H5.fn.cacheBind(this,this.UpdateUsername))},LoginFinished:function(task){task.Success?(JuiceboxEngine.Util.LocalStorage.StoreValue("login_id",this._loginID),System.Console.WriteLine(System.String.format("Logged in with Playfab! {0}",[JuiceboxEngine.Playfab.PlayfabManager.Identity.Username])),this.CurrentState=LD50.PlayfabSignin.LoginState.SIGNED_IN):(this.CurrentState=LD50.PlayfabSignin.LoginState.ERROR,System.Console.WriteLine("Failed to log in with Playfab."))},UpdateUsername:function(task){H5.staticEquals(this.OnUsernameChanged,null)?null:this.OnUsernameChanged(task.Success,task.ErrorMessage)}}});H5.define("LD50.PlayfabSignin.LoginState",{$kind:"nested enum",statics:{fields:{NONE:0,SIGNED_OUT:1,SIGNED_IN:2,REGISTERING:3,SIGNING_IN:4,ERROR:5}}});H5.define("LD50.Program",{main:function(){var game=new JuiceboxEngine.JuiceboxGame;game.Run(new LD50.MainScene(game.ResourceManager))}});H5.define("LD50.JuiceUI.JuiceUIButton",{inherits:[LD50.JuiceUI.JuiceUIPanel],fields:{_routine:null},events:{OnPress:null},ctors:{ctor:function(parent){this.$initialize();LD50.JuiceUI.JuiceUIPanel.ctor.call(this,parent);this.InputType=JuiceboxEngine.GUI.UIInput.SELF;this.addOnMouseEnter(H5.fn.cacheBind(this,this.MouseEnter));this.addOnMouseExit(H5.fn.cacheBind(this,this.MouseExit));this.addOnMouseUp(H5.fn.cacheBind(this,this.MouseUp))}},methods:{SetText:function(displayText,big){big===void 0&&(big=!1);var text=new JuiceboxEngine.GUI.Text(this._front);text.ShadowOffset=LD50.JuiceUI.JuiceUIConsts.FONT_SHADOW_OFFSET.$clone();text.DisplayText=displayText;text.Pivot=JuiceboxEngine.GUI.UIDefaults.Centered.$clone();text.Anchor=JuiceboxEngine.GUI.UIDefaults.Centered.$clone();big?(text.Font=this.ResourceManager.Load(JuiceboxEngine.Graphics.Font,LD50.JuiceUI.JuiceUIConsts.FONT_48_PATH),text.Dimensions=new JuiceboxEngine.Math.Vector2.$ctor3(text.Font.GetWidth(displayText),48)):(text.Font=this.ResourceManager.Load(JuiceboxEngine.Graphics.Font,LD50.JuiceUI.JuiceUIConsts.FONT_32_PATH),text.Dimensions=new JuiceboxEngine.Math.Vector2.$ctor3(text.Font.GetWidth(displayText),32))},MouseUp:function(ev){H5.staticEquals(this.OnPress,null)?null:this.OnPress();this._routine=JuiceboxEngine.Coroutines.CoroutineManager.StartCoroutine(JuiceboxEngine.Coroutines.DefaultRoutines.Linear(.2,H5.fn.bind(this,function(x){this.Height=JuiceboxEngine.Math.JMath.Interpolate(LD50.JuiceUI.JuiceUIConsts.PANEL_OFFSET,0,JuiceboxEngine.Math.Easings.ExponentialEaseOut(x))})));JuiceboxEngine.Coroutines.CoroutineManager.StartCoroutine(this.ClickAnim())},ClickAnim:function(){var $s=0,$jff,$rv,backColor,frontColor,$ae,$en=new H5.GeneratorEnumerator(H5.fn.bind(this,function(){try{for(;;)switch($s){case 0:return backColor=this._back.Color.$clone(),frontColor=this._front.Color.$clone(),this._back.Color=JuiceboxEngine.Math.Color.White.$clone(),this._front.Color=JuiceboxEngine.Math.Color.White.$clone(),$en.current=null,$s=1,!0;case 1:this._back.Color=backColor.$clone();this._front.Color=frontColor.$clone();default:return!1}}catch($ae1){$ae=System.Exception.create($ae1);throw $ae;}}));return $en},MouseEnter:function(ev){this._routine!=null&&JuiceboxEngine.Coroutines.CoroutineManager.StopCoroutine(this._routine);this._routine=JuiceboxEngine.Coroutines.CoroutineManager.StartCoroutine(JuiceboxEngine.Coroutines.DefaultRoutines.Linear(.2,H5.fn.bind(this,function(x){this.Height=JuiceboxEngine.Math.JMath.Interpolate(LD50.JuiceUI.JuiceUIConsts.PANEL_OFFSET,0,JuiceboxEngine.Math.Easings.ExponentialEaseOut(x))})))},MouseExit:function(ev){this._routine!=null&&JuiceboxEngine.Coroutines.CoroutineManager.StopCoroutine(this._routine);this._routine=JuiceboxEngine.Coroutines.CoroutineManager.StartCoroutine(JuiceboxEngine.Coroutines.DefaultRoutines.Linear(.2,H5.fn.bind(this,function(x){this.Height=JuiceboxEngine.Math.JMath.Interpolate(0,LD50.JuiceUI.JuiceUIConsts.PANEL_OFFSET,JuiceboxEngine.Math.Easings.ExponentialEaseOut(x))})))}}})});